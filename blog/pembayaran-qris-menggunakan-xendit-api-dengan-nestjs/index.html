<!DOCTYPE html><html  data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>One-time Payment QRIS Menggunakan Xendit API dengan Nest js | Falestio personal website</title>
<style>*,::backdrop,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.13 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:Menlo,Monaco,Courier New,monospace,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:initial}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:initial;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:initial}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}.static{position:static}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:0}.z-40{z-index:40}.z-50{z-index:50}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem}.mb-4,.my-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-12{margin-left:3rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.mr-2{margin-right:.5rem}.mt-2{margin-top:.5rem}.block{display:block}.flex{display:flex}.table{display:table}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-20{height:5rem}.h-6{height:1.5rem}.h-8{height:2rem}.h-auto{height:auto}.max-h-\[90vh\]{max-height:90vh}.min-h-full{min-height:100%}.min-h-screen{min-height:100vh}.w-1\/3{width:33.333333%}.w-2\/12{width:16.666667%}.w-20{width:5rem}.w-24{width:6rem}.w-3\/12{width:25%}.w-36{width:9rem}.w-4{width:1rem}.w-44{width:11rem}.w-6{width:1.5rem}.w-auto{width:auto}.w-full{width:100%}.max-w-\[80vw\]{max-width:80vw}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.5rem*var(--tw-space-y-reverse));margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-l{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem}.rounded-br-md{border-bottom-right-radius:.375rem}.rounded-tl-md{border-top-left-radius:.375rem}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-gray-500{--tw-border-opacity:1;border-color:rgb(107 114 128/var(--tw-border-opacity))}.border-gray-600{--tw-border-opacity:1;border-color:rgb(75 85 99/var(--tw-border-opacity))}.border-yellow-400{--tw-border-opacity:1;border-color:rgb(250 204 21/var(--tw-border-opacity))}.border-l-gray-600{--tw-border-opacity:1;border-left-color:rgb(75 85 99/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-blue-200{--tw-bg-opacity:1;background-color:rgb(191 219 254/var(--tw-bg-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.bg-green-200{--tw-bg-opacity:1;background-color:rgb(187 247 208/var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-yellow-200{--tw-bg-opacity:1;background-color:rgb(254 240 138/var(--tw-bg-opacity))}.bg-opacity-75{--tw-bg-opacity:0.75}.object-cover{object-fit:cover}.object-top{object-position:top}.p-10{padding:2.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-bottom:.125rem;padding-top:.125rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.pr-8{padding-right:2rem}.font-mono{font-family:Menlo,Monaco,Courier New,monospace,monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.italic{font-style:italic}.text-blue-200{--tw-text-opacity:1;color:rgb(191 219 254/var(--tw-text-opacity))}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250/var(--tw-text-opacity))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246/var(--tw-text-opacity))}.text-fruit-salad-100{--tw-text-opacity:1;color:rgb(233 241 231/var(--tw-text-opacity))}.text-fruit-salad-500{--tw-text-opacity:1;color:rgb(104 154 96/var(--tw-text-opacity))}.text-fruit-salad-600{--tw-text-opacity:1;color:rgb(76 116 69/var(--tw-text-opacity))}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-green-200{--tw-text-opacity:1;color:rgb(187 247 208/var(--tw-text-opacity))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94/var(--tw-text-opacity))}.text-primary{color:689a60}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-yellow-200{--tw-text-opacity:1;color:rgb(254 240 138/var(--tw-text-opacity))}.text-yellow-400{--tw-text-opacity:1;color:rgb(250 204 21/var(--tw-text-opacity))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.shadow{--tw-shadow:0 1px 3px 0 #0000001a,0 1px 2px -1px #0000001a;--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-md{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px #0000001a,0 2px 4px -2px #0000001a;--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.hover\:border-fruit-salad-600:hover{--tw-border-opacity:1;border-color:rgb(76 116 69/var(--tw-border-opacity))}.hover\:bg-\[\#0A66C2\]:hover{--tw-bg-opacity:1;background-color:rgb(10 102 194/var(--tw-bg-opacity))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.hover\:bg-fruit-salad-400:hover{--tw-bg-opacity:1;background-color:rgb(131 172 124/var(--tw-bg-opacity))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38/var(--tw-bg-opacity))}.hover\:underline:hover{text-decoration-line:underline}.focus\:outline-none:focus{outline:2px solid #0000;outline-offset:2px}@media (min-width:1024px){.lg\:sticky{position:sticky}.lg\:top-0{top:0}.lg\:block{display:block}.lg\:hidden{display:none}.lg\:max-h-screen{max-height:100vh}.lg\:w-7\/12{width:58.333333%}.lg\:flex-row{flex-direction:row}.lg\:overflow-y-auto{overflow-y:auto}}.dark\:border-gray-200:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity))}.dark\:border-gray-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(55 65 81/var(--tw-border-opacity))}.dark\:bg-black:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.dark\:bg-gray-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.dark\:bg-gray-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.dark\:bg-slate-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(51 65 85/var(--tw-bg-opacity))}.dark\:bg-slate-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity))}.dark\:bg-slate-900:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(15 23 42/var(--tw-bg-opacity))}.dark\:text-fruit-salad-400:where([class~=dark-mode],[class~=dark-mode] *){--tw-text-opacity:1;color:rgb(131 172 124/var(--tw-text-opacity))}.dark\:text-slate-50:where([class~=dark-mode],[class~=dark-mode] *){--tw-text-opacity:1;color:rgb(248 250 252/var(--tw-text-opacity))}</style>
<style>*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.13 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:Menlo,Monaco,Courier New,monospace,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}.static{position:static}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:0}.z-40{z-index:40}.z-50{z-index:50}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem}.mb-4,.my-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-12{margin-left:3rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.mr-2{margin-right:.5rem}.mt-2{margin-top:.5rem}.block{display:block}.flex{display:flex}.table{display:table}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-20{height:5rem}.h-6{height:1.5rem}.h-8{height:2rem}.h-auto{height:auto}.max-h-\[90vh\]{max-height:90vh}.min-h-full{min-height:100%}.min-h-screen{min-height:100vh}.w-1\/3{width:33.333333%}.w-2\/12{width:16.666667%}.w-20{width:5rem}.w-24{width:6rem}.w-3\/12{width:25%}.w-36{width:9rem}.w-4{width:1rem}.w-44{width:11rem}.w-6{width:1.5rem}.w-auto{width:auto}.w-full{width:100%}.max-w-\[80vw\]{max-width:80vw}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.5rem*var(--tw-space-y-reverse));margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-l{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem}.rounded-br-md{border-bottom-right-radius:.375rem}.rounded-tl-md{border-top-left-radius:.375rem}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-gray-500{--tw-border-opacity:1;border-color:rgb(107 114 128/var(--tw-border-opacity))}.border-gray-600{--tw-border-opacity:1;border-color:rgb(75 85 99/var(--tw-border-opacity))}.border-yellow-400{--tw-border-opacity:1;border-color:rgb(250 204 21/var(--tw-border-opacity))}.border-l-gray-600{--tw-border-opacity:1;border-left-color:rgb(75 85 99/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-blue-200{--tw-bg-opacity:1;background-color:rgb(191 219 254/var(--tw-bg-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.bg-green-200{--tw-bg-opacity:1;background-color:rgb(187 247 208/var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-yellow-200{--tw-bg-opacity:1;background-color:rgb(254 240 138/var(--tw-bg-opacity))}.bg-opacity-75{--tw-bg-opacity:0.75}.object-cover{-o-object-fit:cover;object-fit:cover}.object-top{-o-object-position:top;object-position:top}.p-10{padding:2.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-bottom:.125rem;padding-top:.125rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.pr-8{padding-right:2rem}.font-mono{font-family:Menlo,Monaco,Courier New,monospace,monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.italic{font-style:italic}.text-blue-200{--tw-text-opacity:1;color:rgb(191 219 254/var(--tw-text-opacity))}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250/var(--tw-text-opacity))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246/var(--tw-text-opacity))}.text-fruit-salad-100{--tw-text-opacity:1;color:rgb(233 241 231/var(--tw-text-opacity))}.text-fruit-salad-500{--tw-text-opacity:1;color:rgb(104 154 96/var(--tw-text-opacity))}.text-fruit-salad-600{--tw-text-opacity:1;color:rgb(76 116 69/var(--tw-text-opacity))}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-green-200{--tw-text-opacity:1;color:rgb(187 247 208/var(--tw-text-opacity))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94/var(--tw-text-opacity))}.text-primary{color:689a60}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-yellow-200{--tw-text-opacity:1;color:rgb(254 240 138/var(--tw-text-opacity))}.text-yellow-400{--tw-text-opacity:1;color:rgb(250 204 21/var(--tw-text-opacity))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-md{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-track{background:#374151}::-webkit-scrollbar-thumb{background:#64748b}.article h1,.article h2,.article h3,.article h4,.article h5,.article h6{font-family:Menlo,Monaco,Courier New,monospace,monospace;font-weight:700}.article h1{font-size:3rem;line-height:1;margin-bottom:1rem;margin-top:2rem}.article h2{font-size:2.25rem;line-height:2.5rem;margin-bottom:.75rem;margin-top:1.5rem}.article h3{font-size:1.875rem;line-height:2.25rem}.article h3,.article h4{margin-bottom:.5rem;margin-top:1rem}.article h4{font-size:1.5rem;line-height:2rem}.article h5{font-size:1.25rem;margin-top:.75rem}.article h5,.article h6{line-height:1.75rem;margin-bottom:.25rem}.article h6{font-size:1.125rem;margin-top:.5rem}.article p{font-size:1.125rem;line-height:1.75rem;line-height:1.625;margin-bottom:1rem;margin-top:1rem}.article a{color:689a60;--tw-text-opacity:1;color:rgb(104 154 96/var(--tw-text-opacity));text-decoration-line:underline}.article h1 a,.article h2 a,.article h3 a,.article h4 a,.article h5 a,.article h6 a{color:inherit;text-decoration-line:none}.article img{border-radius:.5rem;height:auto;margin-bottom:1rem;margin-top:1rem;width:100%;--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.custom-list-style ul{list-style-type:disc;margin-bottom:1rem;margin-left:1.5rem}.custom-list-style ol{list-style-type:decimal;margin-bottom:1rem;margin-left:1.5rem}.custom-list-style ul ul{list-style-type:square;margin-left:1.5rem}.custom-list-style ul ul ul{list-style-type:disc;margin-left:1.5rem}.custom-list-style ul ul ul ul{list-style-type:square;margin-left:1.5rem}.custom-list-style li{font-size:1.125rem;line-height:1.75rem;margin-bottom:.5rem}.article blockquote,.custom-list-style li>*{margin-bottom:1rem;margin-top:1rem}.article blockquote{border-left-width:4px;--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity));font-style:italic;padding-left:1rem}.custom-table-style table{border-collapse:collapse;margin-bottom:1rem;margin-top:1rem;width:100%}.custom-table-style td,.custom-table-style th{border-width:1px;--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity));padding:.5rem 1rem}.custom-table-style th{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity));font-weight:600}.custom-table-style th:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.custom-table-style tr:nth-child(2n){--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.custom-table-style tr:nth-child(2n):where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.hover\:border-fruit-salad-600:hover{--tw-border-opacity:1;border-color:rgb(76 116 69/var(--tw-border-opacity))}.hover\:bg-\[\#0A66C2\]:hover{--tw-bg-opacity:1;background-color:rgb(10 102 194/var(--tw-bg-opacity))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.hover\:bg-fruit-salad-400:hover{--tw-bg-opacity:1;background-color:rgb(131 172 124/var(--tw-bg-opacity))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38/var(--tw-bg-opacity))}.hover\:underline:hover{text-decoration-line:underline}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}@media (min-width:1024px){.lg\:sticky{position:sticky}.lg\:top-0{top:0}.lg\:block{display:block}.lg\:hidden{display:none}.lg\:max-h-screen{max-height:100vh}.lg\:w-7\/12{width:58.333333%}.lg\:flex-row{flex-direction:row}.lg\:overflow-y-auto{overflow-y:auto}}.dark\:border-gray-200:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity))}.dark\:border-gray-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(55 65 81/var(--tw-border-opacity))}.dark\:bg-black:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.dark\:bg-gray-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.dark\:bg-gray-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.dark\:bg-slate-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(51 65 85/var(--tw-bg-opacity))}.dark\:bg-slate-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity))}.dark\:bg-slate-900:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(15 23 42/var(--tw-bg-opacity))}.dark\:text-fruit-salad-400:where([class~=dark-mode],[class~=dark-mode] *){--tw-text-opacity:1;color:rgb(131 172 124/var(--tw-text-opacity))}.dark\:text-slate-50:where([class~=dark-mode],[class~=dark-mode] *){--tw-text-opacity:1;color:rgb(248 250 252/var(--tw-text-opacity))}</style>
<style>.no-scrollbar{scrollbar-width:none}.no-scrollbar::-webkit-scrollbar{display:none}</style>
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs/_payload.json?2c780c87-328d-4503-b82e-5dc2cfd1531b">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D1tJxcFV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D3K0uUXE.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BSyoA4UV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CVE1VDgB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DlAUqK2U.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BVXIYfL7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BCtTrZL7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dak5ZNb4.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cy28i8SW.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CdLmB6NN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dnd51l0P.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CG09qkfu.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/G2BKUIf3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CQbuVsrq.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CmtxdY7R.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BWFNSCzp.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DckI_vk7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cl_JTJJ8.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DxHsv1_d.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CqOY5XnQ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/7-xn_Ea0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CEr1AL4v.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CsYFEnal.js">
<link rel="prefetch" as="style" href="/_nuxt/useStudio.CjCom-nn.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DDh3jcBD.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BODpX5tG.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/ReRrpr2X.js">
<meta property="og:type" content="website">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta property="og:image" content="https://falestio.my.id/blog-img/pembayaran-qris-xendit-nest/thumbnail.png">
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="One-time Payment QRIS Menggunakan Xendit API dengan Nest js">
<meta name="description" content="Implementasi Pembayaran QRIS dengan menggunakan Xendit QR Payment API ">
<meta property="og:description" content="Implementasi Pembayaran QRIS dengan menggunakan Xendit QR Payment API ">
<script type="module" src="/_nuxt/D1tJxcFV.js" crossorigin></script>
<link rel="canonical" href="https://falestio.my.id/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs">
<meta property="og:url" content="https://falestio.my.id/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs">
<meta property="og:site_name" content="Falestio personal website"><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"-mode",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"-mode",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt"><div class="dark:bg-slate-900 dark:text-slate-50"><div class="nuxt-loading-indicator" style="position:fixed;top:0;right:0;left:0;pointer-events:none;width:auto;height:3px;opacity:0;background:repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%);background-size:Infinity% auto;transform:scaleX(0%);transform-origin:left;transition:transform 0.1s, height 0.4s, opacity 0.4s;z-index:999999;"></div><div><div class="bg-gray-800 text-white p-4 lg:hidden flex justify-between items-center"><a href="/" class=""><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" data-nuxt-img srcset="/_ipx/_/img/logo-personal.png 1x, /_ipx/_/img/logo-personal.png 2x" class="w-36 h-auto" src="/_ipx/_/img/logo-personal.png"></a><button class="focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor"><!--[--><!--]--><g><path d="M224,128a8,8,0,0,1-8,8H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,128ZM40,72H216a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16ZM216,184H40a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16Z"></path></g></svg></button></div><div class="flex flex-col lg:flex-row min-h-screen"><div class="hidden lg:block w-2/12 bg-gray-200 dark:bg-slate-800 p-4 lg:sticky lg:top-0 lg:max-h-screen lg:overflow-y-auto"><div class="p-4"><ul class="space-y-2 font-mono text-2xl"><li><a href="/" class="hover:underline">Home</a></li><li><a href="/about" class="hover:underline">About</a></li><nav aria-label="breadcrumb"><ol class="flex flex-col space-x-2"><!----><!--[--><li class="block"><a href="/blog" class="hover:underline text-primary">Blog</a><span class="mx-2 text-gray-400">/</span></li><li class="block"><span class="text-primary">Pembayaran Qris Menggunakan Xendit Api Dengan Nestjs</span><!----></li><!--]--></ol></nav></ul></div></div><div class="w-full lg:w-7/12 p-4"><!--[--><div><div class="p-4"><h1 class="text-5xl font-mono font-semibold mb-8">One-time Payment QRIS Menggunakan Xendit API dengan Nest js</h1><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="thumbnail - Implementasi Pembayaran QRIS dengan menggunakan Xendit QR Payment API " data-nuxt-img srcset="/_ipx/_/blog-img/pembayaran-qris-xendit-nest/thumbnail.png 1x, /_ipx/_/blog-img/pembayaran-qris-xendit-nest/thumbnail.png 2x" class="w-full h-auto" src="/_ipx/_/blog-img/pembayaran-qris-xendit-nest/thumbnail.png"></div><div class="flex justify-center"><!--[--><div class="article custom-list-style custom-table-style custom-inline-code w-full p-4"><p><!--[-->Dengan kasus studi membeli ebook pada website penjualan buku
website ini hanya melayani pembayaran dengan qr<!--]--></p><h2 id="user-story"><a href="#user-story"><!--[-->User Story<!--]--></a></h2><p><!--[-->User ingin membeli sebuah produk digital berupa ebook, user pergi ke halaman ebook tersebuyt, user klik tombol bayar dengan qr, lalu qr muncul user membayar melalui qr lalu klik cek pembayaran, pembayaran berhasil lalu user secara otomatis diarahkan ke halaman sukses. ebook sudah ditambahkan ke katalog user.<!--]--></p><h2 id="alur-pembayaran-dari-generate-qr-hingga-redirect-user-ke-success-page"><a href="#alur-pembayaran-dari-generate-qr-hingga-redirect-user-ke-success-page"><!--[-->Alur Pembayaran dari Generate QR Hingga Redirect User ke Success Page<!--]--></a></h2><div><img src="/blog-img/pembayaran-qris-xendit-nest/sequence-diagram-umum.svg" class="cursor-pointer bg-white"><!----></div><p><!--[-->get qr akan melayani kedua buah user story diatas karena akan dicek dahulu apakah ada qr yang dimiliki user pada produk tersebut jika ada tampilkan qr lama jika tidak ada request qr baru ke xendit api<!--]--></p><h2 id="flow-chart-endpoint-post-get-qr"><a href="#flow-chart-endpoint-post-get-qr"><!--[-->Flow Chart endpoint POST /get-qr<!--]--></a></h2><div><img src="/blog-img/pembayaran-qris-xendit-nest/flowchart-get-qr.svg" class="cursor-pointer bg-white"><!----></div><h2 id="flow-chart-endpoint-get-check-qr-payment"><a href="#flow-chart-endpoint-get-check-qr-payment"><!--[-->Flow Chart Endpoint GET /check-qr-payment<!--]--></a></h2><div><img src="/blog-img/pembayaran-qris-xendit-nest/flowchart-check-qr-payment.svg" class="cursor-pointer bg-white"><!----></div><h2 id="perisapan-sebelum-implementasi"><a href="#perisapan-sebelum-implementasi"><!--[-->Perisapan sebelum implementasi<!--]--></a></h2><p><!--[-->Berikut adalah beberapa persiapan yang harus dilakukan seperti setup Nest js dan menghubungkan backend dengan database serta.<!--]--></p><h3 id="langkah-1-api-key-xendit"><a href="#langkah-1-api-key-xendit"><!--[-->Langkah 1: API Key Xendit<!--]--></a></h3><p><!--[-->Kita memerlukan API Xendit dengan permission Money-In Write dan Money-In Read agar bisa menggunakan API yang seperti Create QR dan Get QR.<!--]--></p><p><!--[-->Untuk mendapatkan API key pergi ke halaman Dashbaord -&gt; Settings -&gt; Developer -&gt; API Keys.<!--]--></p><p><!--[-->Klik tombol &quot;Generate secret key&quot; dan berikan permission Money-In Write dan Money-In Read.<!--]--></p><h3 id="langkah-2-setup-nest-js"><a href="#langkah-2-setup-nest-js"><!--[-->Langkah 2: Setup Nest js<!--]--></a></h3><p><!--[-->Ikuti langkah-langkah berikut untuk setup nest js dan menghubungkannya ke database<!--]--></p><ol><!--[--><li><!--[-->Inisialisasi proyek Nest js<!--]--></li><!--]--></ol><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><!----></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-bash shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">npm</span><span style="--shiki-default:#9ECE6A"> i</span><span style="--shiki-default:#E0AF68"> -g</span><span style="--shiki-default:#9ECE6A"> @nestjs/cli
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">nest</span><span style="--shiki-default:#9ECE6A"> new</span><span style="--shiki-default:#9ECE6A"> xendit-qr-nest
</span></span></code><!--]--></pre></div><ol start="2"><!--[--><li><!--[-->Inisialisasi modul QR
Selanjutnya jalankan perintah berikut untuk menginisialisasi modul, controller, dan service qr.<!--]--></li><!--]--></ol><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><!----></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-bash shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">nest</span><span style="--shiki-default:#9ECE6A"> g</span><span style="--shiki-default:#9ECE6A"> module</span><span style="--shiki-default:#9ECE6A"> qr
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">nest</span><span style="--shiki-default:#9ECE6A"> g</span><span style="--shiki-default:#9ECE6A"> controller</span><span style="--shiki-default:#9ECE6A"> qr
</span></span><span class="line" line="3"><span style="--shiki-default:#C0CAF5">nest</span><span style="--shiki-default:#9ECE6A"> g</span><span style="--shiki-default:#9ECE6A"> service</span><span style="--shiki-default:#9ECE6A"> qr
</span></span></code><!--]--></pre></div><h3 id="langkah-3-hubungkan-ke-database"><a href="#langkah-3-hubungkan-ke-database"><!--[-->Langkah 3: Hubungkan ke Database<!--]--></a></h3><ol><!--[--><li><!--[-->Install Dependensi:
Pertama, instal TypeORM dan driver PostgreSQL:<!--]--></li><!--]--></ol><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><!----></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-bash shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">npm</span><span style="--shiki-default:#9ECE6A"> install</span><span style="--shiki-default:#E0AF68"> --save</span><span style="--shiki-default:#9ECE6A"> @nestjs/typeorm</span><span style="--shiki-default:#9ECE6A"> typeorm</span><span style="--shiki-default:#9ECE6A"> pg
</span></span></code><!--]--></pre></div><ol start="2"><!--[--><li><!--[-->Konfigurasi TypeORM:
Buka file app.module.ts dan tambahkan konfigurasi TypeORM. Anda perlu mengimpor TypeOrmModule dan mengonfigurasinya dengan detail koneksi database PostgreSQL Anda.<!--]--></li><!--]--></ol><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><!----></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-typescript shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">Module</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">@nestjs/common</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="2"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">TypeOrmModule</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">@nestjs/typeorm</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">QrModule</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./qr/qr.module</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#89DDFF">@</span><span style="--shiki-default:#7AA2F7">Module</span><span style="--shiki-default:#9ABDF5">({
</span></span><span class="line" line="6"><span style="--shiki-default:#73DACA">  imports</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> [
</span></span><span class="line" line="7"><span style="--shiki-default:#C0CAF5">    TypeOrmModule</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">forRoot</span><span style="--shiki-default:#9ABDF5">({
</span></span><span class="line" line="8"><span style="--shiki-default:#73DACA">      type</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">postgres</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="9"><span style="--shiki-default:#73DACA">      host</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">localhost</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="10"><span style="--shiki-default:#73DACA">      port</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 5432</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="11"><span style="--shiki-default:#73DACA">      username</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">your_username</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="12"><span style="--shiki-default:#73DACA">      password</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">your_password</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="13"><span style="--shiki-default:#73DACA">      database</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">your_database</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="14"><span style="--shiki-default:#73DACA">      entities</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> [</span><span style="--shiki-default:#7DCFFF">__dirname</span><span style="--shiki-default:#89DDFF"> +</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">/**/*.entity{.ts,.js}</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">]</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="15"><span style="--shiki-default:#73DACA">      synchronize</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> true</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"> // true hanya di development
</span></span><span class="line" line="16"><span style="--shiki-default:#9ABDF5">    })</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="17"><span style="--shiki-default:#7DCFFF">    QrModule</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="18"><span style="--shiki-default:#9ABDF5">  ]</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="19"><span style="--shiki-default:#9ABDF5">})
</span></span><span class="line" line="20"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#BB9AF7"> class</span><span style="--shiki-default:#C0CAF5"> AppModule</span><span style="--shiki-default:#9ABDF5"> {}
</span></span></code><!--]--></pre></div><h2 id="implementasi-qr-entity"><a href="#implementasi-qr-entity"><!--[-->Implementasi QR entity<!--]--></a></h2><p><!--[-->Kita akan mendefinisikan Entity karena akan menyimpan data QR yang dimiliki oleh user di dalam database.<!--]--></p><p><!--[-->Menyimpan data didatabase ini juga penting agar kita dapat menyimpan riwayat pembelian dari user.<!--]--></p><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><!----></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-ts shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">Entity</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#0DB9D7"> Column</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#0DB9D7"> PrimaryGeneratedColumn</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">typeorm</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#89DDFF">@</span><span style="--shiki-default:#7AA2F7">Entity</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">qr_codes</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"> // Specify the table name in the database
</span></span><span class="line" line="4"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#BB9AF7"> class</span><span style="--shiki-default:#C0CAF5"> QRCode</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="5"><span style="--shiki-default:#89DDFF">  @</span><span style="--shiki-default:#7AA2F7">PrimaryGeneratedColumn</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">uuid</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"> // Automatically generate a unique ID
</span></span><span class="line" line="6"><span style="--shiki-default:#73DACA">  id</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#89DDFF">  @</span><span style="--shiki-default:#7AA2F7">Column</span><span style="--shiki-default:#9ABDF5">()
</span></span><span class="line" line="9"><span style="--shiki-default:#73DACA">  userId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span style="--shiki-default:#89DDFF">  @</span><span style="--shiki-default:#7AA2F7">Column</span><span style="--shiki-default:#9ABDF5">()
</span></span><span class="line" line="12"><span style="--shiki-default:#73DACA">  productId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#89DDFF">  @</span><span style="--shiki-default:#7AA2F7">Column</span><span style="--shiki-default:#9ABDF5">()
</span></span><span class="line" line="15"><span style="--shiki-default:#73DACA">  qrCodeId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span style="--shiki-default:#89DDFF">  @</span><span style="--shiki-default:#7AA2F7">Column</span><span style="--shiki-default:#9ABDF5">()
</span></span><span class="line" line="18"><span style="--shiki-default:#73DACA">  expirationDate</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Date</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="19"><span style="--shiki-default:#9ABDF5">}
</span></span></code><!--]--></pre></div><h2 id="implementasi-qr-dto-data-transfer-object"><a href="#implementasi-qr-dto-data-transfer-object"><!--[-->Implementasi QR DTO (Data Transfer Object)<!--]--></a></h2><p><!--[-->DTO digunakan untuk mendefinisikan struktur data yang akan diterima atau dikirim oleh aplikasi. Struktur data ini kemudian akan digunakan untuk validasi dan sebagai interface untuk autocomplete (Typescript).<!--]--></p><p><!--[-->Ada dua DTO yang akan dibuat yaitu Create QR dan Xendir QR DTO<!--]--></p><ol><!--[--><li><!--[-->Create QR DTO<!--]--></li><!--]--></ol><p><!--[-->Digunakan untuk validasi data yang akan digunakan untuk create QR Code<!--]--></p><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><span>qr/dto/create-qr.dto.ts</span></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-ts shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#BB9AF7"> class</span><span style="--shiki-default:#C0CAF5"> CreateQRCodeDto</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="2"><span style="--shiki-default:#73DACA">  userId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span style="--shiki-default:#73DACA">  productId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="4"><span style="--shiki-default:#73DACA">  amount</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> number</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="5"><span style="--shiki-default:#73DACA">  basket</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="6"><span style="--shiki-default:#73DACA">    reference_id</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="7"><span style="--shiki-default:#73DACA">    name</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="8"><span style="--shiki-default:#73DACA">    category</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="9"><span style="--shiki-default:#73DACA">    currency</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="10"><span style="--shiki-default:#73DACA">    price</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> number</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="11"><span style="--shiki-default:#73DACA">    quantity</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> number</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="12"><span style="--shiki-default:#73DACA">    type</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">PRODUCT</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> |</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">SERVICE</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="13"><span style="--shiki-default:#73DACA">    url</span><span style="--shiki-default:#89DDFF">?:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="14"><span style="--shiki-default:#73DACA">    description</span><span style="--shiki-default:#89DDFF">?:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="15"><span style="--shiki-default:#73DACA">    sub_category</span><span style="--shiki-default:#89DDFF">?:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="16"><span style="--shiki-default:#9ABDF5">  }[]</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="17"><span style="--shiki-default:#73DACA">  metadata</span><span style="--shiki-default:#89DDFF">?:</span><span style="--shiki-default:#0DB9D7"> object</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="18"><span style="--shiki-default:#9ABDF5">}
</span></span></code><!--]--></pre></div><ol start="2"><!--[--><li><!--[-->Xendit QR DTO<!--]--></li><!--]--></ol><p><!--[-->Digunakan untuk validasi data QR yang datang dari Xendit<!--]--></p><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><span>qr/dto/create-qr.dto.ts</span></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-ts shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#BB9AF7"> class</span><span style="--shiki-default:#C0CAF5"> XenditQRCodeDto</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="2"><span style="--shiki-default:#73DACA">  id</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span style="--shiki-default:#73DACA">  reference_id</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="4"><span style="--shiki-default:#73DACA">  business_id</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="5"><span style="--shiki-default:#73DACA">  type</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="6"><span style="--shiki-default:#73DACA">  currency</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="7"><span style="--shiki-default:#73DACA">  amount</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> number</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="8"><span style="--shiki-default:#73DACA">  channel_code</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="9"><span style="--shiki-default:#73DACA">  status</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="10"><span style="--shiki-default:#73DACA">  qr_string</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="11"><span style="--shiki-default:#73DACA">  expires_at</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="12"><span style="--shiki-default:#73DACA">  created</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="13"><span style="--shiki-default:#73DACA">  updated</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="14"><span style="--shiki-default:#73DACA">  basket</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> object</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="15"><span style="--shiki-default:#73DACA">  metadata</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> object</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="16"><span style="--shiki-default:#9ABDF5">}
</span></span></code><!--]--></pre></div><h2 id="implementasi-controller"><a href="#implementasi-controller"><!--[-->Implementasi Controller<!--]--></a></h2><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><span>qr/qr.controller.ts</span></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-ts shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">Controller</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#0DB9D7"> Post</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#0DB9D7"> Body</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#0DB9D7"> Get</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#0DB9D7"> Param</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">@nestjs/common</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="2"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">QrService</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./qr.service</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">CreateQRCodeDto</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./dto/create-qr.dto</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="4"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">XenditQRCodeDto</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./dto/xendit-qr-code.dto</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#89DDFF">@</span><span style="--shiki-default:#7AA2F7">Controller</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">qr</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="7"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#BB9AF7"> class</span><span style="--shiki-default:#C0CAF5"> QrController</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="8"><span style="--shiki-default:#BB9AF7">  constructor</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">private</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> readonly</span><span style="--shiki-default:#E0AF68"> qrService</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> QrService</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#9ABDF5"> {}
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#89DDFF">  @</span><span style="--shiki-default:#7AA2F7">Post</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">get-qr</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="11"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> createQRCode</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">@</span><span style="--shiki-default:#7AA2F7">Body</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#E0AF68"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> CreateQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="12"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Incoming get-qr request:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="13"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // Memeriksa apakah QR code sudah ada di database
</span></span><span class="line" line="14"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> existingQRCode</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrService</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">getQRCode</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="15"><span style="--shiki-default:#C0CAF5">      createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">userId</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="16"><span style="--shiki-default:#C0CAF5">      createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">productId
</span></span><span class="line" line="17"><span style="--shiki-default:#9ABDF5">    )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    let</span><span style="--shiki-default:#BB9AF7"> isPaid</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#FF9E64"> false</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span style="--shiki-default:#BB9AF7">    if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">existingQRCode</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="22"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">      // Check if the existing QR code is expired
</span></span><span class="line" line="23"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">      const</span><span style="--shiki-default:#BB9AF7"> isExpired</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrService</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">isExpired</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">existingQRCode</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="24"><span style="--shiki-default:#BB9AF7">      if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">isExpired</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="25"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">        // If expired, delete the existing QR code
</span></span><span class="line" line="26"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">        await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrService</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">deleteQRCode</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">existingQRCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">id</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="27"><span style="--shiki-default:#C0CAF5">        console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Expired QR code deleted: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">existingQRCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">id</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="28"><span style="--shiki-default:#9ABDF5">      } </span><span style="--shiki-default:#BB9AF7">else</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="29"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">        // If QR code is not expired, return the existing QR code
</span></span><span class="line" line="30"><span style="--shiki-default:#C0CAF5">        isPaid</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrService</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">isQRCodePaid</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">existingQRCode</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="31"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">        return</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">qrCode</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> existingQRCode</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> isPaid</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="32"><span style="--shiki-default:#9ABDF5">      }
</span></span><span class="line" line="33"><span style="--shiki-default:#9ABDF5">    }
</span></span><span class="line" line="34"><span emptylineplaceholder="true">
</span></span><span class="line" line="35"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // If no QR code exists or the existing one was deleted, create a new QR code
</span></span><span class="line" line="36"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> newQRCode</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrService</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">createQRCode</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">createQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="37"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">qrCode</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> newQRCode</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> isPaid</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="38"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="39"><span emptylineplaceholder="true">
</span></span><span class="line" line="40"><span style="--shiki-default:#89DDFF">  @</span><span style="--shiki-default:#7AA2F7">Get</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">check-qr-payment/:id</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="41"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> checkPayment</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">@</span><span style="--shiki-default:#7AA2F7">Param</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">id</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#E0AF68"> qrId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="42"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // Fetch the QR code using the service
</span></span><span class="line" line="43"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> qrCode</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrService</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">getQRCodeFromXendit</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">qrId</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="44"><span emptylineplaceholder="true">
</span></span><span class="line" line="45"><span style="--shiki-default:#BB9AF7">    if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">qrCode</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="46"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">      // If the QR code is found, return its status
</span></span><span class="line" line="47"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">      const</span><span style="--shiki-default:#BB9AF7"> isPaid</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrService</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">isQRCodePaid</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">qrCode</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="48"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      return</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="49"><span style="--shiki-default:#C0CAF5">        qrCode</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="50"><span style="--shiki-default:#C0CAF5">        isPaid</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="51"><span style="--shiki-default:#9ABDF5">      }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="52"><span style="--shiki-default:#9ABDF5">    } </span><span style="--shiki-default:#BB9AF7">else</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="53"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">      // If the QR code is not found, return a not found status
</span></span><span class="line" line="54"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      return</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="55"><span style="--shiki-default:#73DACA">        message</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">NOT_FOUND</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="56"><span style="--shiki-default:#9ABDF5">      }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="57"><span style="--shiki-default:#9ABDF5">    }
</span></span><span class="line" line="58"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="59"><span style="--shiki-default:#9ABDF5">}
</span></span></code><!--]--></pre></div><h2 id="implementasi-service"><a href="#implementasi-service"><!--[-->Implementasi Service<!--]--></a></h2><div class="relative bg-gray-800 text-gray-100 rounded-md shadow-md" style=""><div class="px-3 py-1 flex justify-between border-b border-gray-600"><div class="text-gray-300 text-sm rounded-tl-md rounded-br-md"><span>qr/qr.service.ts</span></div><button class="flex items-center justify-center bg-gray-800 border border-gray-600 w-6 h-6 text-sm text-white rounded-md hover:bg-fruit-salad-400 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="mx-auto"><!--[--><!--]--><g><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path></g></svg><!----></button></div><pre class="language-ts shiki shiki-themes tokyo-night overflow-auto p-3"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#0DB9D7"> axios</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">axios</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="2"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">Injectable</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">@nestjs/common</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">CreateQRCodeDto</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./dto/create-qr.dto</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="4"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">QRCode</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./entities/qr.entity</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="5"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">InjectRepository</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">@nestjs/typeorm</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="6"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">Repository</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">typeorm</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="7"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">PaymentConfig</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">src/config</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="8"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">XenditQRCodeDto</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./dto/xendit-qr-code.dto</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#89DDFF">@</span><span style="--shiki-default:#7AA2F7">Injectable</span><span style="--shiki-default:#9ABDF5">()
</span></span><span class="line" line="11"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#BB9AF7"> class</span><span style="--shiki-default:#C0CAF5"> QrService</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="12"><span style="--shiki-default:#BB9AF7">  constructor</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="13"><span style="--shiki-default:#89DDFF">    @</span><span style="--shiki-default:#7AA2F7">InjectRepository</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">QRCode</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="14"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    private</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> readonly</span><span style="--shiki-default:#E0AF68"> qrCodeRepository</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Repository</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#C0CAF5">QRCode</span><span style="--shiki-default:#89DDFF">&gt;
</span></span><span class="line" line="15"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#9ABDF5"> {}
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> getQRCode</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="18"><span style="--shiki-default:#E0AF68">    userId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="19"><span style="--shiki-default:#E0AF68">    productId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string
</span></span><span class="line" line="20"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#C0CAF5">XenditQRCodeDto</span><span style="--shiki-default:#89DDFF"> |</span><span style="--shiki-default:#0DB9D7"> null</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="21"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="22"><span style="--shiki-default:#89DDFF">      `</span><span style="--shiki-default:#9ECE6A">Fetching QR code for userId: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">userId</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A">, productId: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">productId</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`
</span></span><span class="line" line="23"><span style="--shiki-default:#9ABDF5">    )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="24"><span emptylineplaceholder="true">
</span></span><span class="line" line="25"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // Fetch the existing QR code from the database
</span></span><span class="line" line="26"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> existingQrCode</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrCodeRepository</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">findOne</span><span style="--shiki-default:#9ABDF5">({
</span></span><span class="line" line="27"><span style="--shiki-default:#73DACA">      where</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#C0CAF5">userId</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> productId</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="28"><span style="--shiki-default:#9ABDF5">    })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="29"><span emptylineplaceholder="true">
</span></span><span class="line" line="30"><span style="--shiki-default:#BB9AF7">    if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">existingQrCode</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="31"><span style="--shiki-default:#C0CAF5">      console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Found existing QR code: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">existingQrCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrCodeId</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="32"><span emptylineplaceholder="true">
</span></span><span class="line" line="33"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">      // Use the qrCodeId from the database to fetch the QR code data from Xendit
</span></span><span class="line" line="34"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">      const</span><span style="--shiki-default:#BB9AF7"> qrCodeDataFromXendit</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">getQRCodeFromXendit</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="35"><span style="--shiki-default:#C0CAF5">        existingQrCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrCodeId
</span></span><span class="line" line="36"><span style="--shiki-default:#9ABDF5">      )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="37"><span emptylineplaceholder="true">
</span></span><span class="line" line="38"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">      // Return the QR code data fetched from Xendit
</span></span><span class="line" line="39"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      return</span><span style="--shiki-default:#C0CAF5"> qrCodeDataFromXendit</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="40"><span style="--shiki-default:#9ABDF5">    }
</span></span><span class="line" line="41"><span emptylineplaceholder="true">
</span></span><span class="line" line="42"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">No existing QR code found.</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="43"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#FF9E64"> null</span><span style="--shiki-default:#89DDFF">;</span><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"> // Return null if no QR code is found
</span></span><span class="line" line="44"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="45"><span emptylineplaceholder="true">
</span></span><span class="line" line="46"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> getQRCodeFromXendit</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#E0AF68">qrCodeId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#C0CAF5">XenditQRCodeDto</span><span style="--shiki-default:#89DDFF"> |</span><span style="--shiki-default:#0DB9D7"> null</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="47"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Fetching QR code from Xendit with ID: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">qrCodeId</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="48"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> xenditApiUrl</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#89DDFF"> `</span><span style="--shiki-default:#9ECE6A">https://api.xendit.co/qr_codes/</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">qrCodeId</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="49"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> apiKey</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> PaymentConfig</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">XENDIT_API_KEY</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="50"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> headers</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="51"><span style="--shiki-default:#89DDFF">      &quot;</span><span style="--shiki-default:#9ECE6A">Content-Type</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">application/json</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="52"><span style="--shiki-default:#89DDFF">      &quot;</span><span style="--shiki-default:#9ECE6A">api-version</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">2022-07-31</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="53"><span style="--shiki-default:#73DACA">      Authorization</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> `</span><span style="--shiki-default:#9ECE6A">Basic </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">Buffer</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">from</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">apiKey</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">toString</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">base64</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="54"><span style="--shiki-default:#9ABDF5">    }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="55"><span emptylineplaceholder="true">
</span></span><span class="line" line="56"><span style="--shiki-default:#BB9AF7">    try</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="57"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">      const</span><span style="--shiki-default:#BB9AF7"> response</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">get</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">xenditApiUrl</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#C0CAF5">headers</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="58"><span style="--shiki-default:#C0CAF5">      console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Successfully fetched QR code from Xendit:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> response</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">data</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="59"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      return</span><span style="--shiki-default:#C0CAF5"> response</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">data</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="60"><span style="--shiki-default:#9ABDF5">    } </span><span style="--shiki-default:#BB9AF7">catch</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">error</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="61"><span style="--shiki-default:#C0CAF5">      console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">error</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Error fetching QR code from Xendit:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> error</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="62"><span style="--shiki-default:#BB9AF7">      throw</span><span style="--shiki-default:#89DDFF"> new</span><span style="--shiki-default:#7AA2F7"> Error</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Failed to fetch QR code from Xendit</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="63"><span style="--shiki-default:#9ABDF5">    }
</span></span><span class="line" line="64"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="65"><span emptylineplaceholder="true">
</span></span><span class="line" line="66"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> isExpired</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#E0AF68">qrCode</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> XenditQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#0DB9D7">boolean</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="67"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> expired</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#89DDFF"> new</span><span style="--shiki-default:#7AA2F7"> Date</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">qrCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">expires_at</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">&lt;</span><span style="--shiki-default:#89DDFF"> new</span><span style="--shiki-default:#7AA2F7"> Date</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="68"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">QR code with ID </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">qrCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">id</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A"> is expired: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">expired</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="69"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#C0CAF5"> expired</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="70"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="71"><span emptylineplaceholder="true">
</span></span><span class="line" line="72"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> isQRCodePaid</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#E0AF68">qrCode</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> XenditQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#0DB9D7">boolean</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="73"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // Check if the QR code status is &quot;INACTIVE&quot; and not expired
</span></span><span class="line" line="74"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> isExpired</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">isExpired</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">qrCode</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="75"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> isPaid</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> qrCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">status</span><span style="--shiki-default:#BB9AF7"> ===</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">INACTIVE</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#BB9AF7"> &amp;&amp;</span><span style="--shiki-default:#BB9AF7"> !</span><span style="--shiki-default:#C0CAF5">isExpired</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="76"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">QR code with ID </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">qrCode</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">id</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A"> is paid: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">isPaid</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="77"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#C0CAF5"> isPaid</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="78"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="79"><span emptylineplaceholder="true">
</span></span><span class="line" line="80"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> createQRCode</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="81"><span style="--shiki-default:#E0AF68">    createQRCodeDto</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> CreateQRCodeDto
</span></span><span class="line" line="82"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#C0CAF5">XenditQRCodeDto</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="83"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Creating QR code with data:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="84"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> qrData</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">prepareQRData</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">createQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="85"><span emptylineplaceholder="true">
</span></span><span class="line" line="86"><span style="--shiki-default:#BB9AF7">    try</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="87"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">      const</span><span style="--shiki-default:#BB9AF7"> qrCodeData</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">requestQRCodeFromXendit</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">qrData</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="88"><span style="--shiki-default:#C0CAF5">      console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">QR code created successfully:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> qrCodeData</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="89"><span emptylineplaceholder="true">
</span></span><span class="line" line="90"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">      // Save the QR code to the database
</span></span><span class="line" line="91"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">saveQRCodeToDatabase</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">createQRCodeDto</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> qrCodeData</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="92"><span emptylineplaceholder="true">
</span></span><span class="line" line="93"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">      // Return the QR code data fetched from Xendit
</span></span><span class="line" line="94"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      return</span><span style="--shiki-default:#C0CAF5"> qrCodeData</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="95"><span style="--shiki-default:#9ABDF5">    } </span><span style="--shiki-default:#BB9AF7">catch</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">error</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="96"><span style="--shiki-default:#C0CAF5">      console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">error</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Error creating QR code:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> error</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="97"><span style="--shiki-default:#BB9AF7">      throw</span><span style="--shiki-default:#89DDFF"> new</span><span style="--shiki-default:#7AA2F7"> Error</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Failed to create QR code</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="98"><span style="--shiki-default:#9ABDF5">    }
</span></span><span class="line" line="99"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="100"><span emptylineplaceholder="true">
</span></span><span class="line" line="101"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  async</span><span style="--shiki-default:#7AA2F7"> deleteQRCode</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#E0AF68">qrCodeId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> string</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#0DB9D7">void</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="102"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Deleting QR code with ID: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">qrCodeId</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="103"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    await</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrCodeRepository</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">delete</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#C0CAF5">qrCodeId</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="104"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">QR code with ID </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">qrCodeId</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A"> has been deleted.</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="105"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="106"><span emptylineplaceholder="true">
</span></span><span class="line" line="107"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  private</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#7AA2F7"> requestQRCodeFromXendit</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#E0AF68">qrData</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> any</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#0DB9D7">any</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="108"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Requesting QR code from Xendit with data:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> qrData</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="109"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> xenditApiUrl</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">https://api.xendit.co/qr_codes</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="110"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> apiKey</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> PaymentConfig</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">XENDIT_API_KEY</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="111"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> headers</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="112"><span style="--shiki-default:#89DDFF">      &quot;</span><span style="--shiki-default:#9ECE6A">Content-Type</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">application/json</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="113"><span style="--shiki-default:#89DDFF">      &quot;</span><span style="--shiki-default:#9ECE6A">api-version</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">2022-07-31</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="114"><span style="--shiki-default:#73DACA">      Authorization</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> `</span><span style="--shiki-default:#9ECE6A">Basic </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">Buffer</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">from</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">apiKey</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">toString</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">base64</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="115"><span style="--shiki-default:#9ABDF5">    }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="116"><span emptylineplaceholder="true">
</span></span><span class="line" line="117"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> response</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">post</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">xenditApiUrl</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> qrData</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#C0CAF5">headers</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="118"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Received response from Xendit:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> response</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">data</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="119"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#C0CAF5"> response</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">data</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="120"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="121"><span emptylineplaceholder="true">
</span></span><span class="line" line="122"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  private</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#7AA2F7"> saveQRCodeToDatabase</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="123"><span style="--shiki-default:#E0AF68">    createQRCodeDto</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> CreateQRCodeDto</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="124"><span style="--shiki-default:#E0AF68">    qrCodeData</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#0DB9D7"> any
</span></span><span class="line" line="125"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#C0CAF5">QRCode</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="126"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Saving QR code to database:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="127"><span style="--shiki-default:#73DACA">      userId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">userId</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="128"><span style="--shiki-default:#73DACA">      productId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">productId</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="129"><span style="--shiki-default:#73DACA">      qrCodeId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> qrCodeData</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">id</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="130"><span style="--shiki-default:#73DACA">      expirationDate</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> qrCodeData</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">expires_at</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="131"><span style="--shiki-default:#9ABDF5">    })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="132"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> newQRCode</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrCodeRepository</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">create</span><span style="--shiki-default:#9ABDF5">({
</span></span><span class="line" line="133"><span style="--shiki-default:#73DACA">      userId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">userId</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="134"><span style="--shiki-default:#73DACA">      productId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">productId</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="135"><span style="--shiki-default:#73DACA">      qrCodeId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> qrCodeData</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">id</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="136"><span style="--shiki-default:#73DACA">      expirationDate</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> qrCodeData</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">expires_at</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="137"><span style="--shiki-default:#9ABDF5">    })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="138"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#F7768E"> this</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">qrCodeRepository</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">save</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">newQRCode</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="139"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="140"><span emptylineplaceholder="true">
</span></span><span class="line" line="141"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  private</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#7AA2F7"> prepareQRData</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#E0AF68">createQRCodeDto</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> CreateQRCodeDto</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> Promise</span><span style="--shiki-default:#89DDFF">&lt;</span><span style="--shiki-default:#0DB9D7">any</span><span style="--shiki-default:#89DDFF">&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="142"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> qrData</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="143"><span style="--shiki-default:#73DACA">      reference_id</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> `</span><span style="--shiki-default:#9ECE6A">order-id-</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">Date</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">now</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="144"><span style="--shiki-default:#73DACA">      type</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">DYNAMIC</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="145"><span style="--shiki-default:#73DACA">      currency</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">IDR</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="146"><span style="--shiki-default:#73DACA">      amount</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">amount</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="147"><span style="--shiki-default:#73DACA">      expires_at</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> new</span><span style="--shiki-default:#7AA2F7"> Date</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="148"><span style="--shiki-default:#C0CAF5">        Date</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">now</span><span style="--shiki-default:#9ABDF5">() </span><span style="--shiki-default:#89DDFF">+</span><span style="--shiki-default:#C0CAF5"> PaymentConfig</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">QR_EXPIRES_AT
</span></span><span class="line" line="149"><span style="--shiki-default:#9ABDF5">      )</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">toISOString</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="150"><span style="--shiki-default:#73DACA">      metadata</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="151"><span style="--shiki-default:#73DACA">        userId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">userId</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"> // Include userId in metadata
</span></span><span class="line" line="152"><span style="--shiki-default:#73DACA">        productId</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">productId</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"> // Include productId in metadata
</span></span><span class="line" line="153"><span style="--shiki-default:#F7768E;--shiki-default-font-weight:bold">        ...</span><span style="--shiki-default:#C0CAF5">createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">metadata</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"> // Spread any additional metadata if provided
</span></span><span class="line" line="154"><span style="--shiki-default:#9ABDF5">      }</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="155"><span style="--shiki-default:#73DACA">      basket</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> createQRCodeDto</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">basket</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="156"><span style="--shiki-default:#9ABDF5">    }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="157"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">Prepared QR data:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> qrData</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="158"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#C0CAF5"> qrData</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="159"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="160"><span style="--shiki-default:#9ABDF5">}
</span></span></code><!--]--></pre></div><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!--]--></div></div><!--]--></div><div class="hidden lg:block w-3/12 p-4 lg:sticky lg:top-0 lg:max-h-screen lg:overflow-y-auto no-scrollbar"><div><div class="flex items-center justify-end gap-3 pr-8"><div><!----></div><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" data-nuxt-img srcset="/_ipx/_/img/logo-personal.png 1x, /_ipx/_/img/logo-personal.png 2x" class="w-36 h-auto" src="/_ipx/_/img/logo-personal.png"></div><!----></div></div></div></div></div></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs/_payload.json?2c780c87-328d-4503-b82e-5dc2cfd1531b">[{"state":1,"once":11,"_errors":12,"serverRendered":5,"path":15,"pinia":16,"prerenderedAt":21},["Reactive",2],{"$scolor-mode":3,"$ssite-config":7},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,{"env":8,"name":9,"url":10},"production","Falestio personal website","https://falestio.my.id",["Set"],["ShallowReactive",13],{"article":14,"content-query-wmfxln0ShE":14},null,"/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs",["Reactive",17],{"blog":18},{"currentArticle":19},["Ref",20],"CEK",1734155064617]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{useNuxtImage:true,components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1734155039985,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:"tokyo-night",highlighter:"shiki",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml"]},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}},gtag:{enabled:true,initMode:"auto",id:"G-3QHM1F5N2M",initCommands:[],config:{},tags:[],loadingStrategy:"defer",url:"https://www.googletagmanager.com/gtag/js"},"nuxt-seo":{canonicalQueryWhitelist:["page","sort","filter","search","q","category","tag"]},studio:{apiURL:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""}},app:{baseURL:"/",buildId:"2c780c87-328d-4503-b82e-5dc2cfd1531b",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script>
<script type="application/ld+json" id="schema-org-graph">{"@context":"https://schema.org","@graph":[{"@id":"https://falestio.my.id/#website","@type":"WebSite","name":"Falestio personal website","url":"https://falestio.my.id"},{"@id":"https://falestio.my.id/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs/#webpage","@type":"WebPage","description":"Implementasi Pembayaran QRIS dengan menggunakan Xendit QR Payment API ","name":"One-time Payment QRIS Menggunakan Xendit API dengan Nest js","url":"https://falestio.my.id/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs","isPartOf":{"@id":"https://falestio.my.id/#website"},"potentialAction":[{"@type":"ReadAction","target":["https://falestio.my.id/blog/pembayaran-qris-menggunakan-xendit-api-dengan-nestjs"]}]}]}</script></body></html>