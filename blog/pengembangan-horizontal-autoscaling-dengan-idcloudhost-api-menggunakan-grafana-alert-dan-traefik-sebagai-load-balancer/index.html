<!DOCTYPE html><html  data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pengembangan Horizontal Autoscaling dengan IDCloudHost API Menggunakan Grafana Alert dan Traefik sebagai Load Balancer</title>
<style>*,::backdrop,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.13 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:Menlo,Monaco,Courier New,monospace,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:initial}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:initial;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:initial}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}.fixed{position:fixed}.inset-0{inset:0}.z-40{z-index:40}.z-50{z-index:50}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem}.mb-4,.my-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.ml-12{margin-left:3rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.block{display:block}.flex{display:flex}.grid{display:grid}.h-10{height:2.5rem}.h-20{height:5rem}.h-8{height:2rem}.h-auto{height:auto}.max-h-\[90vh\]{max-height:90vh}.min-h-full{min-height:100%}.min-h-screen{min-height:100vh}.w-1\/3{width:33.333333%}.w-20{width:5rem}.w-24{width:6rem}.w-36{width:9rem}.w-4{width:1rem}.w-44{width:11rem}.w-\[900px\]{width:900px}.w-auto{width:auto}.w-full{width:100%}.max-w-\[80vw\]{max-width:80vw}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.5rem*var(--tw-space-y-reverse));margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)))}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-l{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem}.border{border-width:1px}.border-2{border-width:2px}.border-l-gray-600{--tw-border-opacity:1;border-left-color:rgb(75 85 99/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254/var(--tw-bg-opacity))}.bg-blue-200{--tw-bg-opacity:1;background-color:rgb(191 219 254/var(--tw-bg-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity))}.bg-green-200{--tw-bg-opacity:1;background-color:rgb(187 247 208/var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-yellow-200{--tw-bg-opacity:1;background-color:rgb(254 240 138/var(--tw-bg-opacity))}.bg-opacity-75{--tw-bg-opacity:0.75}.object-cover{object-fit:cover}.object-top{object-position:top}.p-10{padding:2.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.pr-8{padding-right:2rem}.font-mono{font-family:Menlo,Monaco,Courier New,monospace,monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250/var(--tw-text-opacity))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246/var(--tw-text-opacity))}.text-blue-900{--tw-text-opacity:1;color:rgb(30 58 138/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94/var(--tw-text-opacity))}.text-green-900{--tw-text-opacity:1;color:rgb(20 83 45/var(--tw-text-opacity))}.text-primary{--tw-text-opacity:1;color:rgb(125 188 124/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8/var(--tw-text-opacity))}.text-yellow-900{--tw-text-opacity:1;color:rgb(113 63 18/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.shadow{--tw-shadow:0 1px 3px 0 #0000001a,0 1px 2px -1px #0000001a;--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-md{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px #0000001a,0 2px 4px -2px #0000001a;--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-transform{transition-duration:.15s;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-300{transition-duration:.3s}.\[http\:\/\/\]{http://}.hover\:scale-105:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38/var(--tw-bg-opacity))}.hover\:underline:hover{text-decoration-line:underline}@media (min-width:1024px){.lg\:sticky{position:sticky}.lg\:top-0{top:0}.lg\:max-h-screen{max-height:100vh}.lg\:w-2\/12{width:16.666667%}.lg\:w-3\/12{width:25%}.lg\:w-7\/12{width:58.333333%}.lg\:flex-row{flex-direction:row}.lg\:overflow-y-auto{overflow-y:auto}}.dark\:border-gray-200:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity))}.dark\:border-gray-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(55 65 81/var(--tw-border-opacity))}.dark\:bg-black:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.dark\:bg-gray-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.dark\:bg-slate-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(51 65 85/var(--tw-bg-opacity))}.dark\:bg-slate-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity))}.dark\:bg-slate-900:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(15 23 42/var(--tw-bg-opacity))}.dark\:text-slate-50:where([class~=dark-mode],[class~=dark-mode] *){--tw-text-opacity:1;color:rgb(248 250 252/var(--tw-text-opacity))}</style>
<style>*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.13 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:Menlo,Monaco,Courier New,monospace,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}.fixed{position:fixed}.inset-0{inset:0}.z-40{z-index:40}.z-50{z-index:50}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem}.mb-4,.my-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.ml-12{margin-left:3rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.block{display:block}.flex{display:flex}.grid{display:grid}.h-10{height:2.5rem}.h-20{height:5rem}.h-8{height:2rem}.h-auto{height:auto}.max-h-\[90vh\]{max-height:90vh}.min-h-full{min-height:100%}.min-h-screen{min-height:100vh}.w-1\/3{width:33.333333%}.w-20{width:5rem}.w-24{width:6rem}.w-36{width:9rem}.w-4{width:1rem}.w-44{width:11rem}.w-\[900px\]{width:900px}.w-auto{width:auto}.w-full{width:100%}.max-w-\[80vw\]{max-width:80vw}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.5rem*var(--tw-space-y-reverse));margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)))}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-l{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem}.border{border-width:1px}.border-2{border-width:2px}.border-l-gray-600{--tw-border-opacity:1;border-left-color:rgb(75 85 99/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254/var(--tw-bg-opacity))}.bg-blue-200{--tw-bg-opacity:1;background-color:rgb(191 219 254/var(--tw-bg-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity))}.bg-green-200{--tw-bg-opacity:1;background-color:rgb(187 247 208/var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-yellow-200{--tw-bg-opacity:1;background-color:rgb(254 240 138/var(--tw-bg-opacity))}.bg-opacity-75{--tw-bg-opacity:0.75}.object-cover{-o-object-fit:cover;object-fit:cover}.object-top{-o-object-position:top;object-position:top}.p-10{padding:2.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.pr-8{padding-right:2rem}.font-mono{font-family:Menlo,Monaco,Courier New,monospace,monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250/var(--tw-text-opacity))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246/var(--tw-text-opacity))}.text-blue-900{--tw-text-opacity:1;color:rgb(30 58 138/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94/var(--tw-text-opacity))}.text-green-900{--tw-text-opacity:1;color:rgb(20 83 45/var(--tw-text-opacity))}.text-primary{--tw-text-opacity:1;color:rgb(125 188 124/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8/var(--tw-text-opacity))}.text-yellow-900{--tw-text-opacity:1;color:rgb(113 63 18/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-md{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-transform{transition-duration:.15s;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-300{transition-duration:.3s}.\[http\:\/\/\]{http://}.article h1{font-size:3rem;font-weight:700;line-height:1;margin-bottom:1rem;margin-top:2rem}.article h1,.article h2{font-family:Menlo,Monaco,Courier New,monospace,monospace}.article h2{font-size:2.25rem;font-weight:600;line-height:2.5rem;margin-bottom:.75rem;margin-top:1.5rem}.article h3{font-size:1.875rem;line-height:2.25rem}.article h3,.article h4{font-family:Menlo,Monaco,Courier New,monospace,monospace;font-weight:500;margin-bottom:.5rem;margin-top:1rem}.article h4{font-size:1.5rem;line-height:2rem}.article h5{font-size:1.25rem;margin-top:.75rem}.article h5,.article h6{font-family:Menlo,Monaco,Courier New,monospace,monospace;font-weight:500;line-height:1.75rem;margin-bottom:.25rem}.article h6{font-size:1.125rem;margin-top:.5rem}.article p{font-size:1.125rem;line-height:1.75rem;line-height:1.625;margin-bottom:1rem;margin-top:1rem}.article a{--tw-text-opacity:1;color:rgb(125 188 124/var(--tw-text-opacity));text-decoration-line:underline}.article h1 a,.article h2 a,.article h3 a,.article h4 a,.article h5 a,.article h6 a{color:inherit;text-decoration-line:none}.article img{border-radius:.5rem;height:auto;margin-bottom:1rem;margin-top:1rem;width:100%;--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.custom-list-style ul{list-style-type:disc;margin-left:1.5rem}.custom-list-style ol{list-style-type:decimal;margin-left:1.5rem}.custom-list-style ul ul{list-style-type:square;margin-left:1.5rem}.custom-list-style ul ul ul{list-style-type:disc;margin-left:1.5rem}.custom-list-style ul ul ul ul{list-style-type:square;margin-left:1.5rem}.custom-list-style li{font-size:1.125rem;line-height:1.75rem;margin-bottom:.5rem}.article blockquote{border-left-width:4px;margin-bottom:1rem;margin-top:1rem;--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity));font-style:italic;padding-left:1rem}.article pre{border-radius:.25rem;margin-bottom:.5rem;margin-top:.5rem;overflow-x:auto;--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity));padding:1rem}.article pre,.article pre code{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.article pre code{background-color:transparent}.custom-inline-code code{border-radius:.25rem;--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity));padding-left:.25rem;padding-right:.25rem;--tw-text-opacity:1;color:rgb(220 38 38/var(--tw-text-opacity))}.custom-inline-code code:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity));--tw-text-opacity:1;color:rgb(248 113 113/var(--tw-text-opacity))}.custom-table-style table{border-collapse:collapse;margin-bottom:1rem;margin-top:1rem;width:100%}.custom-table-style td,.custom-table-style th{border-width:1px;--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity));padding:.5rem 1rem}.custom-table-style th{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity));font-weight:600}.custom-table-style th:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.custom-table-style tr:nth-child(2n){--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.custom-table-style tr:nth-child(2n):where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.hover\:scale-105:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38/var(--tw-bg-opacity))}.hover\:underline:hover{text-decoration-line:underline}@media (min-width:1024px){.lg\:sticky{position:sticky}.lg\:top-0{top:0}.lg\:max-h-screen{max-height:100vh}.lg\:w-2\/12{width:16.666667%}.lg\:w-3\/12{width:25%}.lg\:w-7\/12{width:58.333333%}.lg\:flex-row{flex-direction:row}.lg\:overflow-y-auto{overflow-y:auto}}.dark\:border-gray-200:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity))}.dark\:border-gray-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-border-opacity:1;border-color:rgb(55 65 81/var(--tw-border-opacity))}.dark\:bg-black:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.dark\:bg-gray-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.dark\:bg-slate-700:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(51 65 85/var(--tw-bg-opacity))}.dark\:bg-slate-800:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity))}.dark\:bg-slate-900:where([class~=dark-mode],[class~=dark-mode] *){--tw-bg-opacity:1;background-color:rgb(15 23 42/var(--tw-bg-opacity))}.dark\:text-slate-50:where([class~=dark-mode],[class~=dark-mode] *){--tw-text-opacity:1;color:rgb(248 250 252/var(--tw-text-opacity))}</style>
<style>ul[data-v-a356f31a]{list-style-type:none;padding-left:0}li[data-v-a356f31a]:before{color:#1d4ed8;content:"â€¢";display:inline-block;margin-left:-1em;width:1em}a[data-v-a356f31a]{text-decoration:none}a[data-v-a356f31a]:hover{text-decoration:underline}</style>
<style>pre code .line{display:block;min-height:1rem}</style>
<link rel="stylesheet" href="/_nuxt/default.4old1uKr.css">
<link rel="stylesheet" href="/_nuxt/ProsePre.CchFRBtv.css">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/pengembangan-horizontal-autoscaling-dengan-idcloudhost-api-menggunakan-grafana-alert-dan-traefik-sebagai-load-balancer/_payload.json?3d9e6010-51ed-4486-b44b-cffed3a55717">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CgstbXb7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ch6hccHk.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/msfQu-bH.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/4xkQeClo.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/VLwSfUAB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/UaunR1db.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/R_02U3oL.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Se7WhNRC.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DxRIqpi3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CWjLqmRN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dnd51l0P.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/nDpk000Q.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CzT3M5xo.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/MXfdy9T5.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CGSz_aYh.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BdcBlyf0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cth7Ljkv.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/54XUwNK_.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D9W1utxp.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BppwuWha.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B0M9rQ6P.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DTxYwOyD.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Co9iAuXT.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CQScr2Zp.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DL_7lXMb.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CwRspNTS.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cm_f7u5h.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cl7GZMtC.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BNlNiTsp.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CJpq78es.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CkbM9E8P.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BOtsZbXD.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/YmK0zAG7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C6cS6B5a.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/jOHDbAvo.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C6Exw5c0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/rLkhsf_i.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CxuVxRjT.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BwBentMV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/sQDIZTIj.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D5Tp46eN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/li425Ctp.js">
<link rel="prefetch" as="style" href="/_nuxt/useStudio.CjCom-nn.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/pTuPUQh6.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DeKaHCPD.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Ct43dFFM.js">
<meta property="og:title" content="Pengembangan Horizontal Autoscaling dengan IDCloudHost API Menggunakan Grafana Alert dan Traefik sebagai Load Balancer">
<meta name="description" content="An overview of Traefik and its role as an API Gateway in modern web applications.">
<meta property="og:description" content="An overview of Traefik and its role as an API Gateway in modern web applications.">
<script type="module" src="/_nuxt/CgstbXb7.js" crossorigin></script><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"-mode",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"-mode",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt"><div class="dark:bg-slate-900 dark:text-slate-50"><div class="flex flex-col lg:flex-row min-h-screen"><div class="w-full lg:w-2/12 bg-gray-200 dark:bg-slate-800 p-4 lg:sticky lg:top-0 lg:max-h-screen lg:overflow-y-auto"><div class="p-4"><ul class="space-y-2 font-mono text-xl"><li><a href="/" class="hover:underline">Home</a></li><li><a href="/about" class="hover:underline">About</a></li><nav aria-label="breadcrumb"><ol class="flex flex-col space-x-2"><!----><!--[--><li class="block"><a href="/blog" class="hover:underline text-primary">Blog</a><span class="mx-2 text-gray-400">/</span></li><li class="block"><span class="text-primary">Pengembangan Horizontal Autoscaling Dengan Idcloudhost Api Menggunakan Grafana Alert Dan Traefik Sebagai Load Balancer</span><!----></li><!--]--></ol></nav></ul></div></div><div class="w-full lg:w-7/12 p-4"><!--[--><div><div class="flex justify-center"><!--[--><div class="article custom-list-style custom-table-style custom-inline-code w-[900px] p-4"><h1 id="pengembangan-horizontal-autoscaling-dengan-idcloudhost-api-menggunakan-grafana-alert-dan-traefik-sebagai-load-balancer"><!--[-->Pengembangan Horizontal Autoscaling dengan IDCloudHost API Menggunakan Grafana Alert dan Traefik sebagai Load Balancer<!--]--></h1><p><!--[-->IDCloudhost juga menyediakan virtual machine (VM) dengan harga yang relatif terjangkau dibandingkan dengan penyedia layanan cloud lainnya, seperti AWS atau Google Cloud. Penjelasan lebih rinci dapat dilihat pada tabel di bawah ini.<!--]--></p><table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->Provider<!--]--></th><th><!--[-->Harga dalam USD<!--]--></th><th><!--[-->Harga dalam IDR<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->AWS (On-Demand, T3 Small, 2 CPU, 2 GiB RAM, 60 GB EBS Storage)<!--]--></td><td><!--[-->$25.03<!--]--></td><td><!--[-->Rp 391.939<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->DigitalOcean Droplet (2 CPU, 2 GiB RAM, 60 GB Storage)<!--]--></td><td><!--[-->$18.00<!--]--></td><td><!--[-->Rp 281.826<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->IDCloudHost (2 CPU, 2 GiB RAM, 60 GB Storage)<!--]--></td><td><!--[-->$7.19<!--]--></td><td><!--[-->Rp 112.500<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><p><!--[-->*Data diambil pada 8 October 2024<!--]--></p><ul><!--[--><li><!--[-->Harga AWS didapat dari AWS Pricing calculator<!--]--></li><li><!--[-->Harga DigitalOcean didapat dari halaman pricing Droplets<!--]--></li><li><!--[-->Harga IDCloudHost didapat dari halaman console saat akan emmbuat VM baru<!--]--></li><li><!--[-->1 Dollar = Rp 15.657 (8 Oktober 2024)<!--]--></li><!--]--></ul><p><!--[-->Meskipun harganya lebih terjangkau, IDCloudHost tidak memiliki fitur selengkap penyedia layanan lain, seperti autoscaling.<!--]--></p><p><!--[-->Fitur autoscaling sangat penting untuk menangani peningkatan trafik secara otomatis tanpa memerlukan intervensi manual. Saat ini, IDCloudhost menyediakan fitur self-upgrade dan self-downgrade pada layanannya, tetapi belum mendukung autoscaling otomatis. Meskipun IDCloudhost memungkinkan scaling secara manual, fitur ini tidak seotomatis autoscaling pada layanan cloud besar lainnya.<!--]--></p><p><!--[-->Namun, IDCloudhost menyediakan API yang dapat digunakan untuk mengelola setiap sumber daya yang dimiliki, termasuk membuat dan menghapus VM. API ini memungkinkan pengguna untuk melakukan scale up dan scale down sesuai kebutuhan. Artikel ini akan memberikan panduan cara melakukannya.<!--]--></p><h2 id="sistem-yang-akan-dibuat"><a href="#sistem-yang-akan-dibuat"><!--[-->Sistem yang Akan Dibuat<!--]--></a></h2><p><!--[-->Gambar dibawah adalah gambaran umum dari sistem autoscaling yang akan dibuat<!--]--></p><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/general-archi.svg" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><ul><!--[--><li><!--[--><code class=""><!--[-->Service Clones<!--]--></code><br>
Service clones adalah kumpulan virtual machine yang menjalankan layanan tertentu dan akan di-autoscale sesuai kebutuhan. Kelompok virtual machine ini dibuat dari sebuah &quot;service seed,&quot; yaitu virtual machine utama yang berfungsi sebagai template. Service seed berisi aplikasi dan konfigurasi yang diperlukan, dan setiap service clone yang dibuat merupakan salinan dari service seed, dengan aplikasi dan konfigurasi yang sama. Dengan demikian, service clones dapat dengan cepat disiapkan berdasarkan konfigurasi standar dari service seed, memastikan konsistensi di seluruh lingkungan autoscaling.<!--]--></li><li><!--[--><code class=""><!--[-->Traefik API Gateway &amp; Load Balancer<!--]--></code><br>
Traefik adalah API gateway yang berfungsi sebagai lapisan keamanan sebelum akses ke layanan. Dengan Traefik, kita dapat mengimplementasikan autentikasi, rate limiting, CORS, dan fitur keamanan lainnya. Selain itu, Traefik juga bertindak sebagai load balancer yang mendistribusikan request ke layanan. Saat ini, <a href="https://doc.traefik.io/traefik/routing/services/#load-balancing" rel="nofollow"><!--[-->Traefik hanya mendukung metode round robin<!--]--></a>, di mana lalu lintas dibagi secara bergiliran. Misalnya, jika terdapat dua server, permintaan pertama akan diarahkan ke server satu, permintaan kedua ke server dua, dan permintaan ketiga kembali ke server satu dan seterusnya.<!--]--></li><li><!--[--><code class=""><!--[-->Grafana &amp; Prometheus Monitoring Server<!--]--></code>
Grafana dan Prometheus digunakan untuk monitoring dan pengiriman notifikasi. Prometheus berperan sebagai sumber data, sementara Grafana digunakan untuk visualisasi data dan penerapan fungsi alert yang dapat memicu scale up atau scale down layanan.<!--]--></li><li><!--[--><code class=""><!--[-->IDCloudHost API<!--]--></code><br>
IDCloudHost menyediakan API untuk berinteraksi dengan sumber daya yang dimiliki, termasuk mengelola jaringan VM dan melakukan operasi seperti membaca, membuat, memperbarui, atau menghapus sumber daya.<!--]--></li><li><!--[--><code class=""><!--[-->IDCloudHost VPC Network<!--]--></code><br>
VPC memungkinkan server berkomunikasi melalui jaringan privat, yang mengurangi area potensi serangan oleh hacker karena hanya IP publik dari Traefik yang akan diekspos.<!--]--></li><!--]--></ul><div class="rounded-lg shadow-md overflow-hidden flex" data-v-185d3847><div class="bg-green-200 w-4 min-h-full" data-v-185d3847></div><div class="bg-white dark:bg-gray-800" data-v-185d3847><div class="bg-green-100 text-green-900 flex items-center gap-2 px-2" data-v-185d3847><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="text-green-500" data-v-185d3847><!--[--><!--]--><g><path d="M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"></path></g></svg><p class="text-xl font-bold rounded" data-v-185d3847>Kenapa tidak menggunakan load balancer dari IdCloudHost?</p></div><div class="px-2" data-v-185d3847><!--[--><p><!--[-->Kendala utama dalam menggunakan load balancer bawaan IDCloudhost adalah keterbatasan pengendalian. Load balancer ini hanya mendukung metode session persistence yang tidak dapat diubah. Selain itu, biaya penggunaannya relatif tinggi, terutama jika hanya digunakan untuk metode round robin.<!--]--></p><!--]--></div></div></div><h2 id="overview-alur-kerja-sistem"><a href="#overview-alur-kerja-sistem"><!--[-->Overview Alur Kerja Sistem<!--]--></a></h2><p><!--[-->Gambar dibawah menunjukan bagaimana cara sistem bekerja secara umum<!--]--></p><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/cara-kerja-umum.svg" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><ol><!--[--><li><!--[-->Pengguna mengirim permintaan ke endpoint yang diekspos oleh Traefik melalui HTTPS.<!--]--></li><li><!--[-->Traefik berfungsi sebagai load balancer dan meneruskan permintaan ke layanan sesuai giliran, menggunakan metode round robin.<!--]--></li><li><!--[-->Data dari virtual machine setiap layanan dikirim ke server monitoring yang menjalankan Grafana dan Prometheus.<!--]--></li><li><!--[-->Ketika beban CPU melebihi atau kurang dari ambang batas yang ditentukan, server monitoring akan mengirim perintah ke API IDCloudhost untuk melakukan scale up atau scale down, menggunakan Grafana alert.<!--]--></li><li><!--[-->API IDCloudhost kemudian akan melakukan scale up dengan menggandakan service seed untuk membuat service clone baru, atau melakukan scale down dengan menghapus service clone dengan nomor urut tertinggi.<!--]--></li><li><!--[-->Jika service clone berhasil dibuat (scale up), maka akan terhubung dengan Traefik dan server monitoring. Jika berhasil dihapus (scale down), koneksi antara Traefik dan server monitoring akan diputus.<!--]--></li><!--]--></ol><h2 id="penjelasan-detail-cara-kerja-scale-up"><a href="#penjelasan-detail-cara-kerja-scale-up"><!--[-->Penjelasan Detail Cara Kerja Scale Up<!--]--></a></h2><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/cara-kerja-detail-1.png" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><p><!--[-->Gambar diatas menunjukkan sebuah keadaan dimana event scale up akan dijalankan, yaitu ketika server menerima permintaan yang tinggi, mengakibatkan penggunaan CPU melebihi batas yang diinginkan. Hal ini akan terdeteksi oleh Prometheus dan Grafana, yang kemudian memicu sebuah event. Event tersebut juga bisa menangani kondisi di mana permintaan terlalu sedikit, sehingga menyebabkan sumber daya tidak terpakai.<!--]--></p><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/cara-kerja-detail-2.png" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><p><!--[-->Tahapan untuk event scale-up dijelaskan pada gambar kedua:<!--]--></p><ol><!--[--><li><!--[-->Banyak lalu lintas yang datang menyebabkan layanan mengalami penggunaan CPU yang tinggi, yang pada akhirnya menghasilkan kesalahan respons kepada pengguna.<!--]--></li><li><!--[-->Prometheus mengumpulkan data penggunaan CPU dan memicu Grafana alert untuk memulai proses scale-up.<!--]--></li><li><!--[-->Grafana alert akan merespons dengan memanggil webhook ke server Express yang bertugas menangani event scale-up.<!--]--></li><li><!--[-->Webhook handler pertama akan berinteraksi dengan API IDCloudhost untuk melakukan cloning terhadap service seed.<!--]--></li><li><!--[-->Setelah virtual machine layanan berhasil di-clone, webhook handler akan memperbarui daftar target di server Prometheus untuk menyertakan server yang baru dibuat.<!--]--></li><li><!--[-->Webhook handler kemudian akan mengirim permintaan ke target updater pada server Traefik untuk memperbarui daftar target load balancer, memasukkan server baru ke dalam daftar target.<!--]--></li><li><!--[-->Target updater pada server Traefik akan memperbarui daftar IP dan menambahkan alamat IP privat dari service clone yang baru.<!--]--></li><!--]--></ol><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/cara-kerja-detail-3.png" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><p><!--[-->Gambar ketiga menunjukkan hasil dari operasi di atas:<!--]--></p><ol><!--[--><li><!--[-->Service yang baru di-clone dari service seed pada langkah ke-4 dari gambar sebelumnya. Semua konfigurasi dan aplikasi dari service seed akan digandakan, termasuk integrasi dengan Prometheus, sehingga service siap digunakan tanpa konfigurasi manual tambahan.<!--]--></li><li><!--[-->Koneksi antara service yang baru di-clone dan Prometheus pada server monitoring. Prometheus akan memonitor data dari service ini, yang akan digunakan Grafana untuk menampilkan dashboard dan mengirimkan alert jika diperlukan.<!--]--></li><li><!--[-->Koneksi antara Traefik dan service yang baru di-clone, terbentuk pada langkah keenam dari operasi sebelumnya. Traefik akan menangani operasi API gateway seperti CORS, pembatasan kecepatan (rate limiting), dan load balancing di antara semua service yang terhubung.<!--]--></li><!--]--></ol><p><!--[-->Dengan penjelasan ini, proses scaling menjadi lebih jelas, dan koreksi teknis sudah diterapkan agar sesuai dengan cara kerja Prometheus dan Grafana.<!--]--></p><h2 id="penjelasan-detail-cara-kerja-scale-down"><a href="#penjelasan-detail-cara-kerja-scale-down"><!--[-->Penjelasan Detail Cara Kerja Scale Down<!--]--></a></h2><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/cara-kerja-scale-down-1.png" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><p><!--[-->Event scale down dimuali ketika server menerima permintaan yang lebih randah dari biasanya. Ini menyebabkan CPU Usage yang rendah dan tidak ideal secara cost jika kita menghidupkan dua server dengan beban pekerjaan yamg bisa dilakukan satu server<!--]--></p><p><!--[-->Berikut adalah tahapan yang akan dilakukan untuk melakukan scale down<!--]--></p><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/cara-kerja-scale-down-2.png" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><p><!--[-->Proses yang terhadi sama dengan event scale up. Hanya saja kita akan melakukan penghapusan terhadap hasil server clone dan menghapus koneksi yang ada di Traefik dan server monitoring<!--]--></p><p><!--[-->Gambar dibawah ini adalah hasil dari event scale down<!--]--></p><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/cara-kerja-scale-down-3.png" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><ol><!--[--><li><!--[-->Daftar server menyisakan service-seed<!--]--></li><li><!--[-->Koneksi server clone yang lama ke monitoring server telah dihapus<!--]--></li><li><!--[-->Koneksi server cloen yang lama ke Traefik telah dihapus<!--]--></li><!--]--></ol><h2 id="menghindari-trashing-karena-konfigurasi-threshold-yang-tidak-optimal"><a href="#menghindari-trashing-karena-konfigurasi-threshold-yang-tidak-optimal"><!--[-->Menghindari Trashing Karena Konfigurasi Threshold yang Tidak Optimal<!--]--></a></h2><p><!--[-->Dalam menentukan ambang batas (threshold) kapan sistem harus melakukan scale-up dan scale-down, kita harus menentukannya dengan cermat. Jika tidak, dapat beresiko terjadi <em><!--[-->thrashing<!--]--></em>. <em><!--[-->Thrashing<!--]--></em> adalah kondisi di mana server terus-menerus melakukan <strong><!--[-->scale-down<!--]--></strong> dan <strong><!--[-->scale-up<!--]--></strong> secara berulang tanpa henti. Kondisi ini dapat menyebabkan penggunaan sumber daya yang tidak efisien dan membebani sistem, seperti yang dijelaskan pada gambar di bawah.<!--]--></p><div data-v-49ad29a5><img src="/blog/idcloudhost-autoscaling/thrashing.svg" class="cursor-pointer bg-white" data-v-49ad29a5><!----></div><ol><!--[--><li><!--[-->Service clone dengan satu VM mengalami beban CPU 70%, yang melebihi ambang batas (threshold) untuk scale-up.<!--]--></li><li><!--[-->Sistem melakukan scale-up.<!--]--></li><li><!--[-->VM baru berhasil di-clone dan terhubung ke load balancer serta server monitoring.<!--]--></li><li><!--[-->Beban terbagi secara merata antara dua VM, sehingga rata-rata penggunaan CPU turun menjadi 35%, yang berada di bawah ambang batas untuk scale-down.<!--]--></li><li><!--[-->Sistem kemudian melakukan scale-down.<!--]--></li><li><!--[-->Beban CPU kembali naik ke 70%, menyebabkan sistem melakukan scale-up lagi. Kejadian ini terus berulang, menciptakan siklus yang disebut thrashing.<!--]--></li><!--]--></ol><p><!--[-->(kurang solusi untuk masalah)<!--]--></p><h2 id="menghindari-thrashing-karena-volume-request-yang-fluktuatif"><a href="#menghindari-thrashing-karena-volume-request-yang-fluktuatif"><!--[-->Menghindari Thrashing Karena Volume Request yang Fluktuatif<!--]--></a></h2><p><!--[-->(kurang penjelasan bagaimana thrashing bisa terjaid karena volume request yang terjadi)<!--]--></p><p><!--[-->Penambahan Grace Period atau Stabilization Window
Tambahkan <strong><!--[-->grace period<!--]--></strong> atau <strong><!--[-->stabilization window<!--]--></strong>, di mana sistem hanya akan scale down jika load di bawah threshold selama periode waktu tertentu (misalnya, selama 5 menit berturut-turut). Ini mencegah scale down terlalu cepat karena perubahan beban yang bersifat sementara.<!--]--></p><h2 id="implementasi-service"><a href="#implementasi-service"><!--[-->Implementasi Service<!--]--></a></h2><p><!--[-->Server service akan diimplementasikan pada Virtual machine adalah Judge0 dengan operating system Ubuntu, Judge0 akan diinstal dan dijalankan menggunakan Docker pada port 2358. Pada sistem yang sama akan dipasang node exporter untuk mengirimkan data VM ke server monitoring.<!--]--></p><h3 id="service"><a href="#service"><!--[-->Service<!--]--></a></h3><p><!--[-->Instalasi judge0 mengikuti panduan dari dokumentasi resmi <a href="https://github.com/judge0/judge0/releases" rel="nofollow"><!--[-->https://github.com/judge0/judge0/releases<!--]--></a><!--]--></p><p><!--[-->Pastikan service Anda berjalan pada port yang diinginkan dan dapat diakses dengan http request<!--]--></p><h3 id="prometheus-client"><a href="#prometheus-client"><!--[-->Prometheus Client<!--]--></a></h3><p><!--[-->Sumber: <a href="https://www.linode.com/docs/guides/how-to-install-prometheus-and-grafana-on-ubuntu/#how-to-install-and-configure-node-exporter-on-the-client" rel="nofollow"><!--[-->https://www.linode.com/docs/guides/how-to-install-prometheus-and-grafana-on-ubuntu/#how-to-install-and-configure-node-exporter-on-the-client<!--]--></a><!--]--></p><p><!--[-->Agar sebuah sistem dapat di monitor oleh prometheus diperlukan semacam client untuk mengekspor data sistem. Kita menginstall Node Exporter sebagai client untuk mengirim data ke server monitoring.<!--]--></p><p><!--[-->Ikut instruksi dibawah untuk menginstall Node Exporter.<!--]--></p><blockquote><!--[--><p><!--[-->When Node Exporter is running, its collection of statistics is available on portÂ <code class=""><!--[-->9100<!--]--></code>. This port is accessible on the internet and anyone running Prometheus elsewhere can potentially collect them. If you are using a firewall, you must open portÂ <code class=""><!--[-->9100<!--]--></code>Â using the commandÂ <code class=""><!--[-->sudo ufw allow 9100<!--]--></code>.<!--]--></p><!--]--></blockquote><ol><!--[--><li><!--[-->Lihat halaman ini <a href="https://prometheus.io/download/#node_exporter" rel="nofollow"><!--[-->https://prometheus.io/download/#node_exporter<!--]--></a> untuk mengetahui versi terbaru dari Node Exporter<!--]--></li><li><!--[-->Instal versi terbaru Node Exporter menggunakan <code class=""><!--[-->wget<!--]--></code><!--[--><pre class="" style=""><!--[--><code>wget https://github.com/prometheus/node_exporter/releases/download/v1.8.2/node_exporter-1.8.2.linux-amd64.tar.gz
</code><!--]--></pre><!--]--><br>Cukup ganti <code class=""><!--[-->1.8.2<!--]--></code> dengan versi terbaru<!--]--></li><li><!--[-->Ekstrak aplikasi.<!--[--><pre class="" style=""><!--[--><code>tar xvfz node_exporter-*.tar.gz
</code><!--]--></pre><!--]--><!--]--></li><li><!--[-->Pindahkan executable <code class=""><!--[-->node_exporter<!--]--></code> kedalam folderÂ <code class=""><!--[-->usr/local/bin<!--]--></code>Â sehingga bisa diakses seluruh sistem<!--[--><pre class="" style=""><!--[--><code>sudo mv node_exporter-1.5.0.linux-amd64/node_exporter /usr/local/bin
</code><!--]--></pre><!--]--><!--]--></li><li><!--[-->(<strong><!--[-->Optional<!--]--></strong>) Hapus sisa file<!--[--><pre class="" style=""><!--[--><code>rm -r node_exporter-1.5.0.linux-amd64*
</code><!--]--></pre><!--]--><!--]--></li><li><!--[-->Jalankan command berikut untuk melihat status instalasi node_exporter<!--[--><pre class="" style=""><!--[--><code>node_exporter
</code><!--]--></pre><!--]--><br>Node Exporter berhasil diinstall, kita sudah dapat menjalankan Node Exporter. Namun kita harus menjalankan Node Exporter sebagai system service agar dapat dijalankan ketika server mulai. Ini memungkinkan ketika kita melakukan clone server, Node Exporter akan langsung berjalan harus memulai nya secara manual.<!--]--></li><li><!--[-->Pertama buatlah user untuk node exporter<!--[--><pre class="" style=""><!--[--><code>sudo useradd -rs /bin/false node_exporter
</code><!--]--></pre><!--]--><!--]--></li><li><!--[-->Buatlah service file yang akan digunakan oleh <code class=""><!--[-->systemctl<!--]--></code>. File harus bernama<code class=""><!--[-->node_exporter.service<!--]--></code><!--[--><pre class="" style=""><!--[--><code>sudo nano /etc/systemd/system/node_exporter.service
</code><!--]--></pre><!--]--><br><strong><!--[-->File: /etc/systemd/system/node_exporter.service<!--]--></strong><!--[--><pre class="" style=""><!--[--><code>**[**Unit**]**Description**=**Node Exporter
Wants**=**network-online.target
After**=**network-online.target

**[**Service**]**User**=**node_exporter
Group**=**node_exporter
Type**=**simple
Restart**=**on-failure
RestartSec**=**5s
ExecStart**=**/usr/local/bin/node_exporter

**[**Install**]**WantedBy**=**multi-user.target
</code><!--]--></pre><!--]--><!--]--></li><li><!--[-->Untuk menjalankan Node Exporter secara otomatis ketika server dimulai (boot time), jalankan command <code class=""><!--[-->systemctl endable<!--]--></code><!--[--><pre class="" style=""><!--[--><code>sudo systemctl enable node_exporter
</code><!--]--></pre><!--]--><!--]--></li><li><!--[-->Reload <code class=""><!--[-->systemctl<!--]--></code>Â daemon, Mulai node_exporter dan cek statusnya<!--[--><pre class="" style=""><!--[--><code>sudo systemctl daemon-reload
sudo systemctl start node_exporter
sudo systemctl status node_exporter
</code><!--]--></pre><!--]--><!--[--><pre class="" style=""><!--[--><code>node_exporter.service - Node Exporter
Loaded: loaded (/etc/systemd/system/node_exporter.service; enabled; vendor preset: enabled)
Active: active (running) since Tue 2023-04-11 13:48:06 UTC; 4s ago
</code><!--]--></pre><!--]--><!--]--></li><li><!--[-->Cek url <a href="http://localhost" rel="nofollow"><!--[-->http://<!--]--></a>localhost:9100/metrics untuk melihat apakah node exporter sudah berjalan<!--]--></li><!--]--></ol><!--[--><pre class="" style=""><!--[--><code>curl http://localhost:9100/
</code><!--]--></pre><!--]--><ul><!--[--><li><!--[-->something<!--]--></li><!--]--></ul><h2 id="implementasi-api-gateway-dan-load-balancer"><a href="#implementasi-api-gateway-dan-load-balancer"><!--[-->Implementasi API Gateway dan Load Balancer<!--]--></a></h2><p><!--[-->Traefik akan berfungsi sebagai API Gateway, namun dalam sistem ini, fokus utama adalah pada fitur load balancing. Sistem akan menggunakan load balancer berbasis file, di mana target load balancer akan disimpan dalam file konfigurasi. Dengan mengaktifkan fitur watch pada file tersebut, Traefik akan secara otomatis memperbarui target load balancing tanpa perlu melakukan restart aplikasi saat terjadi perubahan.<!--]--></p><h3 id="instalasi"><a href="#instalasi"><!--[-->Instalasi<!--]--></a></h3><ol><!--[--><li><!--[-->Install Traefik binary<!--]--></li><!--]--></ol><p><!--[-->cek versi traefik terbaru di <a href="https://github.com/traefik/traefik/releases" rel="nofollow"><!--[-->https://github.com/traefik/traefik/releases<!--]--></a><!--]--></p><!--[--><pre class="" style=""><!--[--><code>wget https://github.com/traefik/traefik/releases/download/v3.1.4/traefik_v3.1.4_linux_amd64.tar.gz
</code><!--]--></pre><!--]--><ol><!--[--><li><!--[-->ekstrak<!--]--></li><!--]--></ol><!--[--><pre class="" style=""><!--[--><code>tar -zxvf traefik_v3.1.4_linux_amd64.tar.gz
</code><!--]--></pre><!--]--><ol><!--[--><li><!--[-->jalankan (bisa dipindahkan ke usr/bin)<!--]--></li><!--]--></ol><!--[--><pre class="" style=""><!--[--><code>./traefik --help
</code><!--]--></pre><!--]--><h3 id="konfigurasi-provider"><a href="#konfigurasi-provider"><!--[-->Konfigurasi Provider<!--]--></a></h3><ol><!--[--><li><!--[-->Buat basic provider setup<!--]--></li><!--]--></ol><p><!--[--><a href="https://doc.traefik.io/traefik/providers/file/" rel="nofollow"><!--[-->https://doc.traefik.io/traefik/providers/file/<!--]--></a><!--]--></p><p><!--[-->jika anda ingin melakukan request https<!--]--></p><p><!--[-->Static config (/etc/traefik/static.yaml)<!--]--></p><!--[--><pre class="language-yaml shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F7768E">entryPoints</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="2"><span style="--shiki-default:#F7768E">  web</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="3"><span style="--shiki-default:#F7768E">    address</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">:80</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#F7768E">  websecure</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="6"><span style="--shiki-default:#F7768E">    address</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">:443</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#F7768E">certificatesResolvers</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="9"><span style="--shiki-default:#F7768E">  myresolver</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="10"><span style="--shiki-default:#F7768E">    acme</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="11"><span style="--shiki-default:#F7768E">      email</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ECE6A"> your-email@example.com
</span></span><span class="line" line="12"><span style="--shiki-default:#F7768E">      storage</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ECE6A"> acme.json
</span></span><span class="line" line="13"><span style="--shiki-default:#F7768E">      httpChallenge</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="14"><span style="--shiki-default:#F7768E">        entryPoint</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ECE6A"> web
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#F7768E">providers</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="17"><span style="--shiki-default:#F7768E">  file</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="18"><span style="--shiki-default:#F7768E">    directory</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ECE6A"> /etc/traefik/configs
</span></span><span class="line" line="19"><span style="--shiki-default:#F7768E">    watch</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> true
</span></span></code><!--]--></pre><!--]--><p><!--[-->Dynamic config (/etc/traefik/config/dynamic.yaml)<!--]--></p><!--[--><pre class="language-yaml shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F7768E">http</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="2"><span style="--shiki-default:#F7768E">  routers</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="3"><span style="--shiki-default:#F7768E">    submissions</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="4"><span style="--shiki-default:#F7768E">        entrypoints</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="5"><span style="--shiki-default:#9ABDF5">            -</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">websecure</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="6"><span style="--shiki-default:#F7768E">      rule</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">Host(`submissions.pojokoding.my.id`) &amp;&amp; Path(`/submissions`)</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="7"><span style="--shiki-default:#F7768E">      service</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">submissions</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="8"><span style="--shiki-default:#F7768E">      tls</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="9"><span style="--shiki-default:#F7768E">        certResolver</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ECE6A"> myresolver
</span></span></code><!--]--></pre><!--]--><p><!--[-->Services config (/etc/traefik/config/services.yaml)<!--]--></p><!--[--><pre class="language-yaml shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F7768E">http</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="2"><span style="--shiki-default:#F7768E">    services</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="3"><span style="--shiki-default:#F7768E">        submissions</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="4"><span style="--shiki-default:#F7768E">            loadBalancer</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="5"><span style="--shiki-default:#F7768E">                servers</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="6"><span style="--shiki-default:#9ABDF5">                -</span><span style="--shiki-default:#F7768E"> url</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">http://&lt;private-ip-services&gt;:2358/</span><span style="--shiki-default:#89DDFF">&quot;
</span></span></code><!--]--></pre><!--]--><ul><!--[--><li><!--[-->Konfigurasi izin read and write file<!--]--></li><!--]--></ul><p><!--[-->Kita perlu mengizinkan agar file <code class=""><!--[-->/etc/traefik/config/services.yaml<!--]--></code> dapat diupdate oleh file bash.<!--]--></p><!--[--><pre class="language-yaml shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"></span></code><!--]--></pre><!--]--><h3 id="konfigurasi-sistem-update-target-load-balancer"><a href="#konfigurasi-sistem-update-target-load-balancer"><!--[-->Konfigurasi Sistem Update Target Load Balancer<!--]--></a></h3><p><!--[-->Kita akan membuat sebuah server express untuk mengangi event scale down dan event scale up<!--]--></p><p><!--[-->Tugas dari sistem ini adalah untuk melakukan udpate daftar url pada <code class=""><!--[-->loadbalancer.servers<!--]--></code><!--]--></p><p><!--[-->Sistem ini akan menjalankan file bash untuk melakukan update file konfigurasi dinamis traefik<!--]--></p><h3 id="pembuatan-file-bash"><a href="#pembuatan-file-bash"><!--[-->Pembuatan File Bash<!--]--></a></h3><p><!--[-->file bash ini akan melakukan update terhadap daftar servers di load balancer<!--]--></p><p><!--[-->(update-services.bash)<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">#!/bin/bash
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"># Path ke file services.yaml
</span></span><span class="line" line="4"><span style="--shiki-default:#C0CAF5">SERVICES_FILE</span><span style="--shiki-default:#89DDFF">=</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">/etc/traefik/config/services.yaml</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"># Cek apakah ada parameter yang diberikan
</span></span><span class="line" line="7"><span style="--shiki-default:#BB9AF7">if</span><span style="--shiki-default:#89DDFF"> [</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#F7768E">$#</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#BB9AF7"> -lt</span><span style="--shiki-default:#FF9E64"> 1</span><span style="--shiki-default:#89DDFF"> ];</span><span style="--shiki-default:#BB9AF7"> then
</span></span><span class="line" line="8"><span style="--shiki-default:#0DB9D7">  echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">Usage: </span><span style="--shiki-default:#E0AF68">$0</span><span style="--shiki-default:#9ECE6A"> &lt;url1&gt; &lt;url2&gt; ... &lt;urlN&gt;</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="9"><span style="--shiki-default:#0DB9D7">  exit</span><span style="--shiki-default:#FF9E64"> 1
</span></span><span class="line" line="10"><span style="--shiki-default:#BB9AF7">fi
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line" line="12"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"># Tulis ulang services.yaml dengan daftar server baru
</span></span><span class="line" line="13"><span style="--shiki-default:#0DB9D7">echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">http:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> &gt;</span><span style="--shiki-default:#C0CAF5"> $SERVICES_FILE
</span></span><span class="line" line="14"><span style="--shiki-default:#0DB9D7">echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">  services:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> &gt;&gt;</span><span style="--shiki-default:#C0CAF5"> $SERVICES_FILE
</span></span><span class="line" line="15"><span style="--shiki-default:#0DB9D7">echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">    submissions:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> &gt;&gt;</span><span style="--shiki-default:#C0CAF5"> $SERVICES_FILE
</span></span><span class="line" line="16"><span style="--shiki-default:#0DB9D7">echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">      loadBalancer:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> &gt;&gt;</span><span style="--shiki-default:#C0CAF5"> $SERVICES_FILE
</span></span><span class="line" line="17"><span style="--shiki-default:#0DB9D7">echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">        servers:</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> &gt;&gt;</span><span style="--shiki-default:#C0CAF5"> $SERVICES_FILE
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic"># Loop melalui semua parameter yang diberikan (URL list)
</span></span><span class="line" line="20"><span style="--shiki-default:#BB9AF7">for</span><span style="--shiki-default:#C0CAF5"> SERVICE_URL</span><span style="--shiki-default:#BB9AF7"> in</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#E0AF68">$@</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;</span><span style="--shiki-default:#BB9AF7"> do
</span></span><span class="line" line="21"><span style="--shiki-default:#0DB9D7">  echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">          - url: </span><span style="--shiki-default:#89DDFF">\&quot;</span><span style="--shiki-default:#C0CAF5">$SERVICE_URL</span><span style="--shiki-default:#89DDFF">\&quot;&quot;</span><span style="--shiki-default:#89DDFF"> &gt;&gt;</span><span style="--shiki-default:#C0CAF5"> $SERVICES_FILE
</span></span><span class="line" line="22"><span style="--shiki-default:#BB9AF7">done
</span></span><span class="line" line="23"><span emptylineplaceholder="true">
</span></span><span class="line" line="24"><span style="--shiki-default:#0DB9D7">echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">Update completed.</span><span style="--shiki-default:#89DDFF">&quot;
</span></span></code><!--]--></pre><!--]--><p><!--[-->agar file ini dapat dijalankan kita harus mengkonfigurasi file ini sebagai executable<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">chmod</span><span style="--shiki-default:#9ECE6A"> +x</span><span style="--shiki-default:#9ECE6A"> update-services.sh
</span></span></code><!--]--></pre><!--]--><p><!--[-->Berikut contoh menjalankan file ini<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">./update-services.sh</span><span style="--shiki-default:#9ECE6A"> http://10.10.10.10</span><span style="--shiki-default:#9ECE6A"> http://11.11.11.11</span><span style="--shiki-default:#9ECE6A"> http://12.12.12.12
</span></span></code><!--]--></pre><!--]--><p><!--[-->hasilnya<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">$</span><span style="--shiki-default:#9ECE6A"> cat</span><span style="--shiki-default:#9ECE6A"> services.yaml
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">http:
</span></span><span class="line" line="3"><span style="--shiki-default:#C0CAF5">  services:
</span></span><span class="line" line="4"><span style="--shiki-default:#C0CAF5">    submissions:
</span></span><span class="line" line="5"><span style="--shiki-default:#C0CAF5">      loadBalancer:
</span></span><span class="line" line="6"><span style="--shiki-default:#C0CAF5">        servers:
</span></span><span class="line" line="7"><span style="--shiki-default:#C0CAF5">          -</span><span style="--shiki-default:#9ECE6A"> url:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">http://10.10.10.10:2358</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="8"><span style="--shiki-default:#C0CAF5">          -</span><span style="--shiki-default:#9ECE6A"> url:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">http://11.11.11.11</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="9"><span style="--shiki-default:#C0CAF5">          -</span><span style="--shiki-default:#9ECE6A"> url:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">http://12.12.12.12</span><span style="--shiki-default:#89DDFF">&quot;
</span></span></code><!--]--></pre><!--]--><h3 id="pembuatan-service-express-untuk-menerima-daftar-server-terbaru"><a href="#pembuatan-service-express-untuk-menerima-daftar-server-terbaru"><!--[-->Pembuatan service express untuk menerima daftar server terbaru<!--]--></a></h3><!--[--><pre class="language-jsx shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">touch</span><span style="--shiki-default:#C0CAF5"> index</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">js
</span></span></code><!--]--></pre><!--]--><p><!--[-->Lakukan inisiasi aplikasi express terbaru lalu masukan kode berikut pada index.js<!--]--></p><!--[--><pre class="language-jsx shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> express</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> require</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">express</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="2"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> exec</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> require</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">child_process</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> path</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> require</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">path</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> app</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> express</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="6"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> PORT</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#FF9E64"> 3000</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#C0CAF5">app</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">use</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">express</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">json</span><span style="--shiki-default:#9ABDF5">())</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#C0CAF5">app</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">post</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">/update-servers</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">req</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> res</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="11"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> servers</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> req</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">body</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#BB9AF7">  if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#BB9AF7">!</span><span style="--shiki-default:#C0CAF5">servers</span><span style="--shiki-default:#BB9AF7"> ||</span><span style="--shiki-default:#BB9AF7"> !</span><span style="--shiki-default:#C0CAF5">Array</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">isArray</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">servers</span><span style="--shiki-default:#9ABDF5">)) {
</span></span><span class="line" line="14"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#C0CAF5"> res
</span></span><span class="line" line="15"><span style="--shiki-default:#89DDFF">      .</span><span style="--shiki-default:#7AA2F7">status</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#FF9E64">400</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="16"><span style="--shiki-default:#89DDFF">      .</span><span style="--shiki-default:#7AA2F7">json</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#73DACA">message</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">Invalid request body. Expected an array of servers.</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="17"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#BB9AF7"> serverArgs</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> servers</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">map</span><span style="--shiki-default:#9ABDF5">((</span><span style="--shiki-default:#E0AF68">url</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#89DDFF"> `</span><span style="--shiki-default:#9ECE6A">&quot;</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">url</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A">&quot;</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">join</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#BB9AF7"> scriptPath</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">./update-services.sh</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="22"><span emptylineplaceholder="true">
</span></span><span class="line" line="23"><span style="--shiki-default:#7AA2F7">  exec</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">scriptPath</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#7DCFFF"> ${</span><span style="--shiki-default:#C0CAF5">serverArgs</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">error</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> stdout</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> stderr</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="24"><span style="--shiki-default:#BB9AF7">    if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">error</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="25"><span style="--shiki-default:#C0CAF5">      console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">error</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Error executing script: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">stderr</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="26"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      return</span><span style="--shiki-default:#C0CAF5"> res
</span></span><span class="line" line="27"><span style="--shiki-default:#89DDFF">        .</span><span style="--shiki-default:#7AA2F7">status</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#FF9E64">500</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="28"><span style="--shiki-default:#89DDFF">        .</span><span style="--shiki-default:#7AA2F7">json</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#73DACA">message</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">Failed to update services.yaml</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#73DACA"> error</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> stderr</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="29"><span style="--shiki-default:#9ABDF5">    }
</span></span><span class="line" line="30"><span emptylineplaceholder="true">
</span></span><span class="line" line="31"><span style="--shiki-default:#C0CAF5">    console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Script output: </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">stdout</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="32"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    return</span><span style="--shiki-default:#C0CAF5"> res
</span></span><span class="line" line="33"><span style="--shiki-default:#89DDFF">      .</span><span style="--shiki-default:#7AA2F7">status</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#FF9E64">200</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="34"><span style="--shiki-default:#89DDFF">      .</span><span style="--shiki-default:#7AA2F7">json</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#73DACA">message</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">services.yaml updated successfully</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#73DACA"> output</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> stdout</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="35"><span style="--shiki-default:#9ABDF5">  })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="36"><span style="--shiki-default:#9ABDF5">})</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="37"><span emptylineplaceholder="true">
</span></span><span class="line" line="38"><span style="--shiki-default:#C0CAF5">app</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">listen</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#FF9E64">PORT</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> ()</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="39"><span style="--shiki-default:#C0CAF5">  console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Server is running on port </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#FF9E64">PORT</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="40"><span style="--shiki-default:#9ABDF5">})</span><span style="--shiki-default:#89DDFF">;
</span></span></code><!--]--></pre><!--]--><p><!--[-->Gunakan PM2 untuk menjalankan service<!--]--></p><ol><!--[--><li><!--[--><strong><!--[-->Install PM2<!--]--></strong> jika belum terpasang:<!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">npm</span><span style="--shiki-default:#9ECE6A"> install</span><span style="--shiki-default:#9ECE6A"> pm2</span><span style="--shiki-default:#E0AF68"> -g
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">pm2</span><span style="--shiki-default:#9ECE6A"> start</span><span style="--shiki-default:#9ECE6A"> index.js
</span></span></code><!--]--></pre><!--]--><!--]--></li><!--]--></ol><ul><!--[--><li><!--[-->Melihat daftar aplikasi yang sedang berjalan:
<!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">pm2</span><span style="--shiki-default:#9ECE6A"> list
</span></span></code><!--]--></pre><!--]--><!--]--></li><li><!--[-->Menyimpan konfigurasi agar server Express tetap berjalan setelah reboot:
<!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">pm2</span><span style="--shiki-default:#9ECE6A"> save
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">pm2</span><span style="--shiki-default:#9ECE6A"> startup
</span></span></code><!--]--></pre><!--]--><!--]--></li><!--]--></ul><p><!--[-->PM2 akan menjalankan Express server dalam mode daemon, sehingga akan tetap berjalan meskipun terminal ditutup.<!--]--></p><p><!--[-->jalankan perintah dibawah untuk melihat hasilnya<!--]--></p><!--[--><pre class="" style=""><!--[--><code>curl -X POST http://localhost:3000/update-servers \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;servers&quot;: [&quot;http://server1.example.com&quot;, &quot;http://server2.example.com&quot;]}&#39;
</code><!--]--></pre><!--]--><h2 id="implementasi-monitoring"><a href="#implementasi-monitoring"><!--[-->Implementasi Monitoring<!--]--></a></h2><p><!--[-->Pada bagian artikel sebelumnya kita telah melakukan setup prometheus pada server service. Pada bagian ini kita akan membuat prometheus pada sisi server monitoring untuk menerima data dari kumpulan service<!--]--></p><p><!--[-->Lalu kita akan melakukan setup grafana untuk menvisualisasikan data yang didapat dari prometheus dan setup Alerting untuk melakukan event scale up dan scale down<!--]--></p><h3 id="download-dan-install-prometheus"><a href="#download-dan-install-prometheus"><!--[-->Download dan install prometheus<!--]--></a></h3><p><!--[--><a href="https://www.linode.com/docs/guides/how-to-install-prometheus-and-grafana-on-ubuntu/#how-to-configure-prometheus-as-a-service" rel="nofollow"><!--[-->https://www.linode.com/docs/guides/how-to-install-prometheus-and-grafana-on-ubuntu/#how-to-configure-prometheus-as-a-service<!--]--></a><!--]--></p><p><!--[-->Prometheus dapat diunduh sebagai binary yang sudah dikompilasi dari repositori GitHub. Repositori unduhan Prometheus mencantumkan rilis terbaru dari Prometheus. Halaman GitHub Prometheus juga menyediakan instruksi tentang cara membangun Prometheus dari kode sumber atau menjalankannya sebagai kontainer Docker. Untuk mengunduh Prometheus, ikuti langkah-langkah berikut.<!--]--></p><p><!--[-->Kunjungi halaman unduhan Prometheus dan catat rilis terbaru. Rilis LTS terbaru ditandai dengan jelas di situs tersebut.<!--]--></p><p><!--[-->Gunakan <code class=""><!--[-->wget<!--]--></code> untuk mengunduh Prometheus ke server pemantauan. Tautan target memiliki format seperti ini: <code class=""><!--[-->https://github.com/prometheus/prometheus/releases/download/v[release]/prometheus-[release].linux-amd64.tar.gz<!--]--></code>. Gantilah string <code class=""><!--[-->[release]<!--]--></code> dengan rilis aktual yang akan diunduh. Sebagai contoh, perintah berikut mengunduh rilis 2.37.6.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">wget</span><span style="--shiki-default:#89DDFF"> &lt;</span><span style="--shiki-default:#9ECE6A">https://github.com/prometheus/prometheus/releases/download/v2.37.6/prometheus-2.37.6.linux-amd64.tar.g</span><span style="--shiki-default:#A9B1D6">z</span><span style="--shiki-default:#89DDFF">&gt;
</span></span></code><!--]--></pre><!--]--><p><!--[-->Ekstrak file Prometheus yang diarsipkan.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">tar</span><span style="--shiki-default:#9ECE6A"> xvfz</span><span style="--shiki-default:#9ECE6A"> prometheus-</span><span style="--shiki-default:#F7768E">*</span><span style="--shiki-default:#9ECE6A">.tar.gz
</span></span></code><!--]--></pre><!--]--><p><!--[-->(Opsional) Setelah file diekstrak, hapus arsip atau pindahkan ke lokasi lain untuk penyimpanan.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">rm</span><span style="--shiki-default:#9ECE6A"> prometheus-</span><span style="--shiki-default:#F7768E">*</span><span style="--shiki-default:#9ECE6A">.tar.gz
</span></span></code><!--]--></pre><!--]--><p><!--[-->Buat dua direktori baru yang akan digunakan oleh Prometheus. Direktori <code class=""><!--[-->/etc/prometheus<!--]--></code> menyimpan file konfigurasi Prometheus. Direktori <code class=""><!--[-->/var/lib/prometheus<!--]--></code> menyimpan data aplikasi.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> mkdir</span><span style="--shiki-default:#9ECE6A"> /etc/prometheus</span><span style="--shiki-default:#9ECE6A"> /var/lib/prometheus
</span></span></code><!--]--></pre><!--]--><p><!--[-->Masuk ke direktori utama dari folder prometheus yang diekstrak. Gantilah nama direktori sesuai dengan rilis sebenarnya, misalnya <code class=""><!--[-->prometheus-2.37.6.linux-amd64<!--]--></code>.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#0DB9D7">cd</span><span style="--shiki-default:#9ECE6A"> prometheus-2.37.6.linux-amd64
</span></span></code><!--]--></pre><!--]--><p><!--[-->Pindahkan direktori <code class=""><!--[-->prometheus<!--]--></code> dan <code class=""><!--[-->promtool<!--]--></code> ke direktori <code class=""><!--[-->/usr/local/bin/<!--]--></code>. Ini membuat Prometheus dapat diakses oleh semua pengguna.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> mv</span><span style="--shiki-default:#9ECE6A"> prometheus</span><span style="--shiki-default:#9ECE6A"> promtool</span><span style="--shiki-default:#9ECE6A"> /usr/local/bin/
</span></span></code><!--]--></pre><!--]--><p><!--[-->Pindahkan file konfigurasi YAML <code class=""><!--[-->prometheus.yml<!--]--></code> ke direktori <code class=""><!--[-->/etc/prometheus<!--]--></code>.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> mv</span><span style="--shiki-default:#9ECE6A"> prometheus.yml</span><span style="--shiki-default:#9ECE6A"> /etc/prometheus/prometheus.yml
</span></span></code><!--]--></pre><!--]--><p><!--[-->Direktori <code class=""><!--[-->consoles<!--]--></code> dan <code class=""><!--[-->console_libraries<!--]--></code> berisi sumber daya yang diperlukan untuk membuat konsol yang disesuaikan. Fitur ini lebih lanjut dan tidak dibahas dalam panduan ini. Namun, file-file ini juga harus dipindahkan ke direktori <code class=""><!--[-->/etc/prometheus<!--]--></code> jika suatu saat diperlukan.<!--]--></p><p><!--[-->Catatan:
Setelah direktori ini dipindahkan, hanya file <code class=""><!--[-->LICENSE<!--]--></code> dan <code class=""><!--[-->NOTICE<!--]--></code> yang tersisa di direktori asli. Cadangkan dokumen ini ke lokasi lain dan hapus direktori <code class=""><!--[-->prometheus-releasenum.linux-amd64<!--]--></code>.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> mv</span><span style="--shiki-default:#9ECE6A"> consoles/</span><span style="--shiki-default:#9ECE6A"> console_libraries/</span><span style="--shiki-default:#9ECE6A"> /etc/prometheus/
</span></span></code><!--]--></pre><!--]--><p><!--[-->Verifikasi bahwa Prometheus berhasil diinstal dengan menggunakan perintah berikut:<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">prometheus</span><span style="--shiki-default:#E0AF68"> --version
</span></span></code><!--]--></pre><!--]--><p><!--[-->Contoh output:<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">prometheus,</span><span style="--shiki-default:#9ECE6A"> version</span><span style="--shiki-default:#FF9E64"> 2.37.6</span><span style="--shiki-default:#A9B1D6"> (branch: </span><span style="--shiki-default:#9ECE6A">HEAD,</span><span style="--shiki-default:#9ECE6A"> revision:</span><span style="--shiki-default:#9ECE6A"> 8ade24a23af6be0f35414d6e8ce09598446c29a2</span><span style="--shiki-default:#A9B1D6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">build</span><span style="--shiki-default:#9ECE6A"> user:</span><span style="--shiki-default:#9ECE6A">       root@5f96027a7c3e
</span></span><span class="line" line="3"><span style="--shiki-default:#C0CAF5">build</span><span style="--shiki-default:#9ECE6A"> date:</span><span style="--shiki-default:#9ECE6A">       20230220-09:36:40
</span></span><span class="line" line="4"><span style="--shiki-default:#C0CAF5">go</span><span style="--shiki-default:#9ECE6A"> version:</span><span style="--shiki-default:#9ECE6A">       go1.19.6
</span></span><span class="line" line="5"><span style="--shiki-default:#C0CAF5">platform:</span><span style="--shiki-default:#9ECE6A">         linux/amd64
</span></span></code><!--]--></pre><!--]--><h3 id="konfigurasi-prometheus"><a href="#konfigurasi-prometheus"><!--[-->Konfigurasi Prometheus<!--]--></a></h3><p><!--[-->Meskipun Prometheus bisa dijalankan dan dihentikan langsung dari command line, lebih praktis kalau dijalankan sebagai service menggunakan <code class=""><!--[-->systemctl<!--]--></code>. Ini memungkinkan Prometheus berjalan di background.<!--]--></p><p><!--[-->Sebelum Prometheus bisa memonitor sistem eksternal, konfigurasi tambahan perlu ditambahkan ke file <code class=""><!--[-->prometheus.yml<!--]--></code>. Namun, Prometheus sudah dikonfigurasi untuk memonitor dirinya sendiri, jadi kita bisa melakukan tes sederhana dulu. Untuk konfigurasi Prometheus, ikuti langkah-langkah berikut.<!--]--></p><p><!--[-->Buat user untuk Prometheus. Perintah berikut akan membuat user sistem:<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> useradd</span><span style="--shiki-default:#E0AF68"> -rs</span><span style="--shiki-default:#9ECE6A"> /bin/</span><span style="--shiki-default:#FF9E64">false</span><span style="--shiki-default:#9ECE6A"> prometheus
</span></span></code><!--]--></pre><!--]--><p><!--[-->Ubah kepemilikan dua direktori yang sudah dibuat sebelumnya ke user <code class=""><!--[-->prometheus<!--]--></code> yang baru.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> chown</span><span style="--shiki-default:#E0AF68"> -R</span><span style="--shiki-default:#9ECE6A"> prometheus:</span><span style="--shiki-default:#9ECE6A"> /etc/prometheus</span><span style="--shiki-default:#9ECE6A"> /var/lib/prometheus
</span></span></code><!--]--></pre><!--]--><p><!--[-->Untuk menjalankan Prometheus sebagai service, buat file <code class=""><!--[-->prometheus.service<!--]--></code> dengan perintah ini:<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> vi</span><span style="--shiki-default:#9ECE6A"> /etc/systemd/system/prometheus.service
</span></span></code><!--]--></pre><!--]--><p><!--[-->Masukkan konten berikut ke dalam file tersebut:<!--]--></p><!--[--><pre class="" style=""><!--[--><code>[Unit]
Description=Prometheus
Wants=network-online.target
After=network-online.target

[Service]
User=prometheus
Group=prometheus
Type=simple
Restart=on-failure
RestartSec=5s
ExecStart=/usr/local/bin/prometheus \\
    --config.file /etc/prometheus/prometheus.yml \\
    --storage.tsdb.path /var/lib/prometheus/ \\
    --web.console.templates=/etc/prometheus/consoles \\
    --web.console.libraries=/etc/prometheus/console_libraries \\
    --web.listen-address=0.0.0.0:9090 \\
    --web.enable-lifecycle \\
    --log.level=info

[Install]
WantedBy=multi-user.target

</code><!--]--></pre><!--]--><p><!--[-->Beberapa poin penting dari file ini:<!--]--></p><ul><!--[--><li><!--[-->Bagian <code class=""><!--[-->Wants<!--]--></code> dan <code class=""><!--[-->After<!--]--></code> diatur ke <code class=""><!--[-->network-online.target<!--]--></code> untuk memastikan Prometheus berjalan setelah koneksi jaringan aktif.<!--]--></li><li><!--[--><code class=""><!--[-->User<!--]--></code> dan <code class=""><!--[-->Group<!--]--></code> diatur ke <code class=""><!--[-->prometheus<!--]--></code> supaya hanya user ini yang menjalankan Prometheus.<!--]--></li><li><!--[--><code class=""><!--[-->ExecStart<!--]--></code> menentukan lokasi file eksekusi Prometheus dan opsi defaultnya.<!--]--></li><li><!--[--><code class=""><!--[-->-config.file<!--]--></code> menentukan lokasi file konfigurasi sebagai <code class=""><!--[-->/etc/prometheus/prometheus.yml<!--]--></code>.<!--]--></li><li><!--[--><code class=""><!--[-->-storage.tsdb.path<!--]--></code> menentukan direktori penyimpanan data aplikasi di <code class=""><!--[-->/var/lib/prometheus/<!--]--></code>.<!--]--></li><li><!--[--><code class=""><!--[-->-web.listen-address<!--]--></code> diatur ke <code class=""><!--[-->0.0.0.0:9090<!--]--></code>, sehingga Prometheus bisa menerima koneksi di semua interface jaringan.<!--]--></li><li><!--[--><code class=""><!--[-->-web.enable-lifecycle<!--]--></code> memungkinkan pengguna untuk me-reload file konfigurasi tanpa restart Prometheus.<!--]--></li><!--]--></ul><p><!--[-->Setelah itu, reload daemon systemctl:<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> daemon-reload
</span></span></code><!--]--></pre><!--]--><p><!--[-->(Opsional) Gunakan perintah <code class=""><!--[-->systemctl enable<!--]--></code> agar Prometheus otomatis mulai saat sistem di-boot. Kalau tidak, Prometheus harus dijalankan manual.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> enable</span><span style="--shiki-default:#9ECE6A"> prometheus
</span></span></code><!--]--></pre><!--]--><p><!--[-->Jalankan service Prometheus dan cek statusnya untuk memastikan sudah aktif.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> start</span><span style="--shiki-default:#9ECE6A"> prometheus
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> status</span><span style="--shiki-default:#9ECE6A"> prometheus
</span></span></code><!--]--></pre><!--]--><p><!--[-->Contoh output status:<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">prometheus.service</span><span style="--shiki-default:#9ECE6A"> -</span><span style="--shiki-default:#9ECE6A"> Prometheus
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">Loaded:</span><span style="--shiki-default:#9ECE6A"> loaded</span><span style="--shiki-default:#A9B1D6"> (/etc/systemd/system/prometheus.service</span><span style="--shiki-default:#89DDFF">;</span><span style="--shiki-default:#C0CAF5"> enabled</span><span style="--shiki-default:#89DDFF">;</span><span style="--shiki-default:#C0CAF5"> vendor</span><span style="--shiki-default:#9ECE6A"> preset:</span><span style="--shiki-default:#9ECE6A"> enabled</span><span style="--shiki-default:#A9B1D6">)
</span></span><span class="line" line="3"><span style="--shiki-default:#C0CAF5">Active:</span><span style="--shiki-default:#9ECE6A"> active</span><span style="--shiki-default:#A9B1D6"> (running) since Mon 2023-04-10 13:06:50 UTC</span><span style="--shiki-default:#89DDFF">;</span><span style="--shiki-default:#C0CAF5"> 7s</span><span style="--shiki-default:#9ECE6A"> ago
</span></span></code><!--]--></pre><!--]--><p><!--[-->Akses interface web dan dashboard Prometheus di <code class=""><!--[-->http://local_ip_addr:9090<!--]--></code>. Ganti <code class=""><!--[-->local_ip_addr<!--]--></code> dengan alamat IP server monitoring. Karena menggunakan file konfigurasi default, informasi yang ditampilkan masih terbatas.<!--]--></p><p><!--[-->Di dashboard Prometheus, file <code class=""><!--[-->prometheus.yml<!--]--></code> default punya direktif untuk mengambil data dari localhost. Klik <code class=""><!--[-->Status<!--]--></code> dan pilih <code class=""><!--[-->Targets<!--]--></code> untuk melihat semua target. Seharusnya hanya ada target Prometheus lokal yang ditampilkan.<!--]--></p><p><!--[-->Node klien sekarang siap untuk dimonitoring. Untuk menambahkan klien ke dalam file <code class=""><!--[-->prometheus.yml<!--]--></code>, ikuti langkah-langkah berikut:<!--]--></p><p><!--[-->Pada server monitoring yang menjalankan Prometheus, buka file <code class=""><!--[-->prometheus.yml<!--]--></code> untuk diedit.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> vi</span><span style="--shiki-default:#9ECE6A"> /etc/prometheus/prometheus.yml
</span></span></code><!--]--></pre><!--]--><p><!--[-->Temukan bagian berjudul <code class=""><!--[-->scrape_configs<!--]--></code>, yang berisi daftar <code class=""><!--[-->job<!--]--></code>. Saat ini, ada satu job bernama <code class=""><!--[-->prometheus<!--]--></code>. Job ini memonitor tugas lokal Prometheus di port 9090. Di bawah job <code class=""><!--[-->prometheus<!--]--></code>, tambahkan job kedua dengan <code class=""><!--[-->job_name<!--]--></code> bernama <code class=""><!--[-->remote_collector<!--]--></code>. Masukkan informasi berikut:<!--]--></p><ul><!--[--><li><!--[-->Interval pengambilan data (<code class=""><!--[-->scrape_interval<!--]--></code>) adalah 10 detik (<code class=""><!--[-->10s<!--]--></code>).<!--]--></li><li><!--[-->Di dalam <code class=""><!--[-->static_configs<!--]--></code> pada atribut <code class=""><!--[-->targets<!--]--></code>, tambahkan daftar alamat IP yang ingin dipantau. Pisahkan setiap entri menggunakan koma.<!--]--></li><li><!--[-->Tambahkan nomor port <code class=""><!--[-->:9100<!--]--></code> ke setiap alamat IP.<!--]--></li><li><!--[-->Untuk memonitor server lokal, tambahkan entri <code class=""><!--[-->localhost:9100<!--]--></code> ke daftar tersebut.<!--]--></li><!--]--></ul><p><!--[-->Entri tersebut seharusnya terlihat seperti contoh berikut. Ganti <code class=""><!--[-->remote_addr<!--]--></code> dengan alamat IP sebenarnya dari klien.<!--]--></p><!--[--><pre class="language-yaml shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#F7768E">File</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ECE6A"> /etc/prometheus/prometheus.yml
</span></span><span class="line" line="2"><span style="--shiki-default:#A9B1D6">---
</span></span><span class="line" line="3"><span style="--shiki-default:#9ABDF5">-</span><span style="--shiki-default:#F7768E"> job_name</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">remote_collector</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="4"><span style="--shiki-default:#F7768E">  scrape_interval</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ECE6A"> 10s
</span></span><span class="line" line="5"><span style="--shiki-default:#F7768E">  static_configs</span><span style="--shiki-default:#89DDFF">:
</span></span><span class="line" line="6"><span style="--shiki-default:#9ABDF5">    -</span><span style="--shiki-default:#F7768E"> targets</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> [</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">remote_addr:9100</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">]
</span></span></code><!--]--></pre><!--]--><p><!--[-->Untuk menyegarkan Prometheus segera, restart service Prometheus.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> restart</span><span style="--shiki-default:#9ECE6A"> prometheus
</span></span></code><!--]--></pre><!--]--><p><!--[-->Menggunakan browser, kunjungi kembali portal web Prometheus di port 9090 pada server monitoring. Pilih <code class=""><!--[-->Status<!--]--></code> lalu <code class=""><!--[-->Targets<!--]--></code>. Sebuah link kedua untuk job <code class=""><!--[-->remote_collector<!--]--></code> akan muncul, yang menuju port 9100 pada klien. Klik link tersebut untuk melihat statistik.<!--]--></p><h3 id="install-grafana"><a href="#install-grafana"><!--[-->Install Grafana<!--]--></a></h3><p><!--[-->Prometheus sekarang mengumpulkan statistik dari klien yang terdaftar di bagian <code class=""><!--[-->scrape_configs<!--]--></code> pada file konfigurasinya. Namun, informasi tersebut hanya dapat dilihat dalam bentuk data mentah yang sulit dibaca dan kurang berguna.<!--]--></p><p><!--[-->Grafana menyediakan antarmuka untuk melihat statistik yang dikumpulkan oleh Prometheus. Instal Grafana pada server yang sama yang menjalankan Prometheus dan tambahkan Prometheus sebagai sumber data. Setelah itu, instal satu atau lebih panel untuk menginterpretasikan data. Untuk menginstal dan mengonfigurasi Grafana, ikuti langkah-langkah berikut:<!--]--></p><p><!--[-->Instal beberapa utilitas yang dibutuhkan menggunakan apt.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> apt-get</span><span style="--shiki-default:#9ECE6A"> install</span><span style="--shiki-default:#E0AF68"> -y</span><span style="--shiki-default:#9ECE6A"> apt-transport-https</span><span style="--shiki-default:#9ECE6A"> software-properties-common
</span></span></code><!--]--></pre><!--]--><p><!--[-->Impor kunci GPG Grafana.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> wget</span><span style="--shiki-default:#E0AF68"> -q</span><span style="--shiki-default:#E0AF68"> -O</span><span style="--shiki-default:#9ECE6A"> /usr/share/keyrings/grafana.key</span><span style="--shiki-default:#89DDFF"> &lt;</span><span style="--shiki-default:#9ECE6A">https://apt.grafana.com/gpg.ke</span><span style="--shiki-default:#A9B1D6">y</span><span style="--shiki-default:#89DDFF">&gt;
</span></span></code><!--]--></pre><!--]--><p><!--[-->Tambahkan repository &quot;stable releases&quot; Grafana.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#0DB9D7">echo</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">deb [signed-by=/usr/share/keyrings/grafana.key] &lt;https://apt.grafana.com&gt; stable main</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF"> |</span><span style="--shiki-default:#C0CAF5"> sudo</span><span style="--shiki-default:#9ECE6A"> tee</span><span style="--shiki-default:#E0AF68"> -a</span><span style="--shiki-default:#9ECE6A"> /etc/apt/sources.list.d/grafana.list
</span></span></code><!--]--></pre><!--]--><p><!--[-->Perbarui paket di repository, termasuk paket Grafana yang baru.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> apt-get</span><span style="--shiki-default:#9ECE6A"> update
</span></span></code><!--]--></pre><!--]--><p><!--[-->Instal versi open-source dari Grafana.<!--]--></p><blockquote><!--[--><p><!--[-->Catatan<!--]--></p><p><!--[-->Untuk menginstal Grafana Enterprise, gunakan perintah <code class=""><!--[-->sudo apt-get install grafana-enterprise<!--]--></code> sebagai gantinya.<!--]--></p><!--]--></blockquote><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> apt-get</span><span style="--shiki-default:#9ECE6A"> install</span><span style="--shiki-default:#9ECE6A"> grafana
</span></span></code><!--]--></pre><!--]--><p><!--[-->Muat ulang daemon systemctl.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> daemon-reload
</span></span></code><!--]--></pre><!--]--><p><!--[-->Aktifkan dan mulai server Grafana. Menggunakan <code class=""><!--[-->systemctl enable<!--]--></code> mengonfigurasi server untuk meluncurkan Grafana saat sistem booting.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> enable</span><span style="--shiki-default:#9ECE6A"> grafana-server.service
</span></span><span class="line" line="2"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> start</span><span style="--shiki-default:#9ECE6A"> grafana-server
</span></span></code><!--]--></pre><!--]--><p><!--[-->Periksa status server Grafana dan pastikan dalam kondisi aktif.<!--]--></p><!--[--><pre class="language-bash shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">sudo</span><span style="--shiki-default:#9ECE6A"> systemctl</span><span style="--shiki-default:#9ECE6A"> status</span><span style="--shiki-default:#9ECE6A"> grafana-server
</span></span></code><!--]--></pre><!--]--><!--[--><pre class="" style=""><!--[--><code>grafana-server.service - Grafana instance
Loaded: loaded (/lib/systemd/system/grafana-server.service; enabled; vendor preset: enabled)
Active: active (running) since Tue 2023-04-11 17:31:53 UTC; 9s ago

</code><!--]--></pre><!--]--><h3 id="hubungkan-grafana-dengan-prometheus-dan-install-dashboard"><a href="#hubungkan-grafana-dengan-prometheus-dan-install-dashboard"><!--[-->Hubungkan grafana dengan prometheus dan install dashboard<!--]--></a></h3><p><!--[-->Semua komponen sistem sekarang sudah terinstal, tetapi Grafana dan Prometheus belum diatur untuk berinteraksi. Langkah-langkah konfigurasi yang tersisa, termasuk menambahkan Prometheus sebagai sumber data dan mengimpor panel dashboard, dapat dilakukan menggunakan antarmuka web Grafana.<!--]--></p><p><!--[-->Untuk mengintegrasikan Grafana dan Prometheus, ikuti langkah-langkah di bawah ini:<!--]--></p><p><!--[-->Menggunakan browser web, kunjungi port 3000 pada server monitoring. Misalnya, masukkan <code class=""><!--[-->http://local_ip_addr:3000<!--]--></code>, ganti <code class=""><!--[-->local_ip_addr<!--]--></code> dengan alamat IP sebenarnya. Grafana akan menampilkan halaman login. Gunakan nama pengguna <code class=""><!--[-->admin<!--]--></code> dan kata sandi default <code class=""><!--[-->password<!--]--></code>. Ubah kata sandi ke nilai yang lebih aman saat diminta.<!--]--></p><p><!--[--><strong><!--[-->Halaman Login Grafana<!--]--></strong><!--]--></p><p><!--[-->Setelah berhasil mengubah kata sandi, Grafana akan menampilkan <strong><!--[-->Grafana Dashboard<!--]--></strong>.<!--]--></p><p><!--[-->Untuk menambahkan Prometheus sebagai sumber data, klik simbol roda gigi yang mewakili <strong><!--[-->Configuration<!--]--></strong>, lalu pilih <strong><!--[-->Data Sources<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Tombol Konfigurasi untuk Sumber Data Grafana<!--]--></strong><!--]--></p><p><!--[-->Pada layar berikutnya, klik tombol <strong><!--[-->Add data source<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Tombol Tambah Sumber Data di Grafana<!--]--></strong><!--]--></p><p><!--[-->Pilih <strong><!--[-->Prometheus<!--]--></strong> sebagai sumber data.<!--]--></p><p><!--[--><strong><!--[-->Pilih Sumber Data Prometheus<!--]--></strong><!--]--></p><p><!--[-->Untuk sumber Prometheus lokal, seperti yang dijelaskan dalam panduan ini, atur URL ke <code class=""><!--[-->http://localhost:9090<!--]--></code>. Kebanyakan pengaturan lainnya bisa dibiarkan dalam nilai default. Namun, nilai Timeout non-default bisa ditambahkan jika diperlukan.<!--]--></p><p><!--[--><strong><!--[-->Konfigurasi Sumber Data Prometheus<!--]--></strong><!--]--></p><p><!--[-->Jika pengaturan sudah sesuai, klik tombol <strong><!--[-->Save &amp; test<!--]--></strong> di bagian bawah layar.<!--]--></p><p><!--[--><strong><!--[-->Simpan Sumber Data Prometheus<!--]--></strong><!--]--></p><p><!--[-->Jika semua pengaturan benar, Grafana akan mengonfirmasi bahwa <strong><!--[-->Data source is working<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Pesan Konfirmasi tentang Sumber Data<!--]--></strong><!--]--></p><h3 id="cara-mengimpor-dashboard-grafana"><a href="#cara-mengimpor-dashboard-grafana"><!--[-->Cara Mengimpor Dashboard Grafana<!--]--></a></h3><p><!--[-->Dashboard menampilkan statistik dari node klien menggunakan tata letak yang lebih efektif dan standar. Anda bisa membuat dashboard kustom, tetapi Prometheus telah menyediakan dashboard yang mendukung statistik <strong><!--[-->Node Exporter<!--]--></strong>. Dashboard <strong><!--[-->Node Exporter Full<!--]--></strong> menggambarkan sebagian besar nilai yang dikumpulkan dari node klien. Lebih mudah mengimpor dashboard ini daripada membuat yang kustom.<!--]--></p><p><!--[-->Untuk mengimpor dashboard <strong><!--[-->Node Exporter<!--]--></strong>, ikuti langkah-langkah di bawah ini:<!--]--></p><p><!--[--><strong><!--[-->Catatan:<!--]--></strong> Untuk membuat dashboard kustom, klik tombol <strong><!--[-->Dashboard<!--]--></strong> (ikon empat kotak), lalu pilih <strong><!--[-->+ New Dashboard<!--]--></strong>. Lihat panduan <strong><!--[-->Building a Dashboard<!--]--></strong> di Grafana untuk informasi lebih lanjut.<!--]--></p><p><!--[-->Kunjungi <strong><!--[-->Grafana Dashboard Library<!--]--></strong>. Masukkan <strong><!--[-->Node exporter<!--]--></strong> sebagai kata kunci pencarian.<!--]--></p><p><!--[--><strong><!--[-->Cari di Pustaka Grafana<!--]--></strong><!--]--></p><p><!--[-->Pilih entri untuk <strong><!--[-->Node Exporter Full<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Pilih Node Exporter Full<!--]--></strong><!--]--></p><p><!--[-->Catat nomor ID atau gunakan tombol untuk menyalin ID ke clipboard. ID dari dashboard ini saat ini adalah <strong><!--[-->1860<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Detail Node Exporter Full<!--]--></strong><!--]--></p><p><!--[-->Kembali ke dashboard Grafana. Pilih ikon <strong><!--[-->Dashboard<!--]--></strong> yang terdiri dari empat kotak, dan pilih <strong><!--[-->+ Import<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Pilih Opsi Impor<!--]--></strong><!--]--></p><p><!--[-->Di kotak <strong><!--[-->Import via <a href="http://grafana.com/" rel="nofollow"><!--[-->grafana.com<!--]--></a><!--]--></strong>, masukkan ID <strong><!--[-->1860<!--]--></strong> dari langkah sebelumnya. Lalu klik tombol <strong><!--[-->Load<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Impor Dashboard Node Exporter<!--]--></strong><!--]--></p><p><!--[-->Pada layar berikutnya, konfirmasi detail impor. Pilih <strong><!--[-->Prometheus<!--]--></strong> sebagai sumber data, lalu klik tombol <strong><!--[-->Import<!--]--></strong>.<!--]--></p><p><!--[--><strong><!--[-->Mengimpor Dashboard<!--]--></strong><!--]--></p><p><!--[-->Dashboard <strong><!--[-->Node Exporter Full<!--]--></strong> langsung aktif. Dashboard ini menampilkan metrik kinerja dan status node klien, termasuk detail Memori, RAM, dan CPU. Beberapa menu dropdown di bagian atas layar memungkinkan pengguna untuk memilih host yang ingin diamati dan periode waktu yang akan ditonjolkan.<!--]--></p><p><!--[-->Contoh berikut menunjukkan bagaimana klien bereaksi saat dibebani program Python yang intens. Widget <strong><!--[-->CPU Busy<!--]--></strong> menunjukkan bagaimana CPU hampir mencapai kapasitas maksimal. Jika ini terjadi selama kondisi operasi normal, mungkin menandakan kebutuhan lebih banyak daya CPU.<!--]--></p><h2 id="webhook-endpoint-untuk-scale-up-dan-scale-down"><a href="#webhook-endpoint-untuk-scale-up-dan-scale-down"><!--[-->Webhook Endpoint untuk scale up dan scale down<!--]--></a></h2><p><!--[-->Untuk melakukan scaling, server Express akan dikembangkan yang akan berinteraksi dengan API IDCloudhost. Endpoint ini akan bertanggung jawab untuk menambah atau mengurangi jumlah VM yang digunakan oleh sistem. Berikut algoritma dari masing-masing endpoint:<!--]--></p><ol><!--[--><li><!--[--><strong><!--[-->Endpoint <code class=""><!--[-->/v1/scale-up<!--]--></code><!--]--></strong>:<ul><!--[--><li><!--[-->Server akan menghitung jumlah VM yang terkait dengan Judge0.<!--]--></li><li><!--[-->Jika dibutuhkan, server akan membuat salinan (cloning) dari Judge0 seed VM.<!--]--></li><li><!--[-->Setelah VM baru dibuat, alamat IP publik yang terhubung akan dihapus.<!--]--></li><li><!--[-->Konfigurasi Traefik akan diperbarui untuk menambahkan IP VM baru ke load balancer.<!--]--></li><li><!--[-->Target Prometheus akan diperbarui untuk memasukkan VM baru ke dalam pemantauan.<!--]--></li><!--]--></ul><!--]--></li><li><!--[--><strong><!--[-->Endpoint <code class=""><!--[-->/v1/scale-down<!--]--></code><!--]--></strong>:<ul><!--[--><li><!--[-->Server akan memeriksa jumlah VM salinan yang masih aktif.<!--]--></li><li><!--[-->Jika ada VM yang aktif, server akan memilih VM terbaru untuk dihapus.<!--]--></li><li><!--[-->VM yang dipilih kemudian akan dihapus dari sistem.<!--]--></li><li><!--[-->Konfigurasi Traefik akan diperbarui untuk menghapus VM yang dihapus dari load balancer.<!--]--></li><li><!--[-->Target Prometheus akan diperbarui untuk memantau VM yang tersisa.<!--]--></li><!--]--></ul><!--[--><pre class="language-jsx shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> express</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> require</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">express</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="2"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> axios</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> require</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">axios</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> exec</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> require</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">child_process</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="4"><span style="--shiki-default:#7AA2F7">require</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">dotenv</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">config</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> app</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#7AA2F7"> express</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="7"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> apiKey</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> process</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#C0CAF5">env</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">API_KEY</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="8"><span style="--shiki-default:#C0CAF5">app</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">use</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">express</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">json</span><span style="--shiki-default:#9ABDF5">())</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#7AA2F7"> updateKrakenDConfig</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">newHost</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> action</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#BB9AF7"> =&gt;
</span></span><span class="line" line="11"><span style="--shiki-default:#89DDFF">  new</span><span style="--shiki-default:#0DB9D7"> Promise</span><span style="--shiki-default:#9ABDF5">((</span><span style="--shiki-default:#E0AF68">resolve</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> reject</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="12"><span style="--shiki-default:#7AA2F7">    exec</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="13"><span style="--shiki-default:#89DDFF">      `</span><span style="--shiki-default:#9ECE6A">./scaling-script.sh </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">action</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A"> &quot;</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">newHost</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A">&quot;</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="14"><span style="--shiki-default:#9ABDF5">      (</span><span style="--shiki-default:#E0AF68">error</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> stdout</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> stderr</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="15"><span style="--shiki-default:#BB9AF7">        if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">error</span><span style="--shiki-default:#BB9AF7"> ||</span><span style="--shiki-default:#C0CAF5"> stderr</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="16"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">          return</span><span style="--shiki-default:#7AA2F7"> reject</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">error</span><span style="--shiki-default:#BB9AF7"> ||</span><span style="--shiki-default:#C0CAF5"> stderr</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="17"><span style="--shiki-default:#9ABDF5">        }
</span></span><span class="line" line="18"><span style="--shiki-default:#7AA2F7">        resolve</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">stdout</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="19"><span style="--shiki-default:#9ABDF5">      }
</span></span><span class="line" line="20"><span style="--shiki-default:#9ABDF5">    )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="21"><span style="--shiki-default:#9ABDF5">  })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="22"><span emptylineplaceholder="true">
</span></span><span class="line" line="23"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#7AA2F7"> getVMCount</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#9ABDF5"> ()</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="24"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> data</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">get</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="25"><span style="--shiki-default:#89DDFF">    `</span><span style="--shiki-default:#9ECE6A">https://api.idcloudhost.com/v1/jkt01/network/network/</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">process</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#C0CAF5">env</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">PRIVATE_NETWORK_UUID</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="26"><span style="--shiki-default:#9ABDF5">    { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">apikey</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> apiKey</span><span style="--shiki-default:#9ABDF5"> } }
</span></span><span class="line" line="27"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="28"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">  return</span><span style="--shiki-default:#C0CAF5"> data</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">resources_count</span><span style="--shiki-default:#89DDFF"> -</span><span style="--shiki-default:#C0CAF5"> process</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#C0CAF5">env</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">NON_JUDGE0_VM_COUNT</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="29"><span style="--shiki-default:#9ABDF5">}</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="30"><span emptylineplaceholder="true">
</span></span><span class="line" line="31"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#7AA2F7"> cloneVM</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">name</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="32"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> data</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">post</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="33"><span style="--shiki-default:#89DDFF">    `</span><span style="--shiki-default:#9ECE6A">https://api.idcloudhost.com/v1/jkt01/user-resource/vm/clone?uuid=</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">process</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#C0CAF5">env</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">JUDGE0_SEED_UUID</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A">&amp;name=</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">name</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="34"><span style="--shiki-default:#9ABDF5">    {}</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="35"><span style="--shiki-default:#9ABDF5">    { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">apikey</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> apiKey</span><span style="--shiki-default:#9ABDF5"> } }
</span></span><span class="line" line="36"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="37"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">  return</span><span style="--shiki-default:#C0CAF5"> data</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="38"><span style="--shiki-default:#9ABDF5">}</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="39"><span emptylineplaceholder="true">
</span></span><span class="line" line="40"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#7AA2F7"> deleteFloatingIP</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">vmUuid</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="41"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> data</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">get</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="42"><span style="--shiki-default:#89DDFF">    `</span><span style="--shiki-default:#9ECE6A">https://api.idcloudhost.com/v1/jkt01/network/ip_addresses?billing_account_id=</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">process</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#C0CAF5">env</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">BILLING_ACCOUNT_ID</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="43"><span style="--shiki-default:#9ABDF5">    { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">apikey</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> apiKey</span><span style="--shiki-default:#9ABDF5"> } }
</span></span><span class="line" line="44"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="45"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#BB9AF7"> ip</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> data</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">find</span><span style="--shiki-default:#9ABDF5">((</span><span style="--shiki-default:#E0AF68">ip</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#C0CAF5"> ip</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">assigned_to</span><span style="--shiki-default:#BB9AF7"> ===</span><span style="--shiki-default:#C0CAF5"> vmUuid</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="46"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">  await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">delete</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="47"><span style="--shiki-default:#89DDFF">    `</span><span style="--shiki-default:#9ECE6A">https://api.idcloudhost.com/v1/jkt01/network/ip_addresses/</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">ip</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">address</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="48"><span style="--shiki-default:#9ABDF5">    { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">apikey</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> apiKey</span><span style="--shiki-default:#9ABDF5"> } }
</span></span><span class="line" line="49"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="50"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">  return</span><span style="--shiki-default:#C0CAF5"> ip</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="51"><span style="--shiki-default:#9ABDF5">}</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="52"><span emptylineplaceholder="true">
</span></span><span class="line" line="53"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#7AA2F7"> updatePrometheusTargets</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#9ABDF5"> ()</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="54"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> data</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">get</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="55"><span style="--shiki-default:#89DDFF">    &quot;</span><span style="--shiki-default:#9ECE6A">https://api.idcloudhost.com/v1/jkt01/user-resource/vm/list</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="56"><span style="--shiki-default:#9ABDF5">    { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">apikey</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> apiKey</span><span style="--shiki-default:#9ABDF5"> } }
</span></span><span class="line" line="57"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="58"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  const</span><span style="--shiki-default:#BB9AF7"> ips</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> data
</span></span><span class="line" line="59"><span style="--shiki-default:#89DDFF">    .</span><span style="--shiki-default:#7AA2F7">filter</span><span style="--shiki-default:#9ABDF5">((</span><span style="--shiki-default:#E0AF68">vm</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#C0CAF5"> vm</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">name</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">startsWith</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">judge0-child-</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">))
</span></span><span class="line" line="60"><span style="--shiki-default:#89DDFF">    .</span><span style="--shiki-default:#7AA2F7">map</span><span style="--shiki-default:#9ABDF5">((</span><span style="--shiki-default:#E0AF68">vm</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#C0CAF5"> vm</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">private_ipv4</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="61"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">  await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">post</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="62"><span style="--shiki-default:#89DDFF">    &quot;</span><span style="--shiki-default:#9ECE6A">http://103.179.56.99:4001/v1/update-prometheus-targets</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="63"><span style="--shiki-default:#9ABDF5">    { </span><span style="--shiki-default:#73DACA">listOfClonesIp</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> ips</span><span style="--shiki-default:#9ABDF5"> }
</span></span><span class="line" line="64"><span style="--shiki-default:#9ABDF5">  )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="65"><span style="--shiki-default:#9ABDF5">}</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="66"><span emptylineplaceholder="true">
</span></span><span class="line" line="67"><span style="--shiki-default:#C0CAF5">app</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">post</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">/v1/scale-up</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">req</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> res</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="68"><span style="--shiki-default:#BB9AF7">  try</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="69"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> vmCount</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#7AA2F7"> getVMCount</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="70"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> newVmData</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#7AA2F7"> cloneVM</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">judge0-child-</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">vmCount</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="71"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    await</span><span style="--shiki-default:#7AA2F7"> deleteFloatingIP</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">newVmData</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">uuid</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="72"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    await</span><span style="--shiki-default:#7AA2F7"> updateKrakenDConfig</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="73"><span style="--shiki-default:#89DDFF">      `</span><span style="--shiki-default:#9ECE6A">http://</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">newVmData</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">private_ipv4</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A">:2358</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="74"><span style="--shiki-default:#89DDFF">      &quot;</span><span style="--shiki-default:#9ECE6A">add</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="75"><span style="--shiki-default:#9ABDF5">    )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="76"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    await</span><span style="--shiki-default:#7AA2F7"> updatePrometheusTargets</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="77"><span style="--shiki-default:#C0CAF5">    res</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">send</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#C0CAF5">newVmData</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="78"><span style="--shiki-default:#9ABDF5">  } </span><span style="--shiki-default:#BB9AF7">catch</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">error</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="79"><span style="--shiki-default:#C0CAF5">    res</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">status</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#FF9E64">500</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">send</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#73DACA">error</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> error</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">message</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="80"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="81"><span style="--shiki-default:#9ABDF5">})</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="82"><span emptylineplaceholder="true">
</span></span><span class="line" line="83"><span style="--shiki-default:#C0CAF5">app</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">post</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">/v1/scale-down</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> async</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">req</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> res</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="84"><span style="--shiki-default:#BB9AF7">  try</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="85"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#89DDFF"> {</span><span style="--shiki-default:#BB9AF7"> data</span><span style="--shiki-default:#89DDFF"> }</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic"> await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">get</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="86"><span style="--shiki-default:#89DDFF">      &quot;</span><span style="--shiki-default:#9ECE6A">https://api.idcloudhost.com/v1/jkt01/user-resource/vm/list</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="87"><span style="--shiki-default:#9ABDF5">      { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">apikey</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> apiKey</span><span style="--shiki-default:#9ABDF5"> } }
</span></span><span class="line" line="88"><span style="--shiki-default:#9ABDF5">    )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="89"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> vmList</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> data</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">filter</span><span style="--shiki-default:#9ABDF5">((</span><span style="--shiki-default:#E0AF68">vm</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#C0CAF5"> vm</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">name</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">startsWith</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ECE6A">judge0-child-</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5">))</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="90"><span style="--shiki-default:#BB9AF7">    if</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#BB9AF7">!</span><span style="--shiki-default:#C0CAF5">vmList</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">length</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="91"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">      return</span><span style="--shiki-default:#C0CAF5"> res</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">send</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#73DACA">message</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">No child VM, scale down aborted</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="92"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">    const</span><span style="--shiki-default:#BB9AF7"> vmToDelete</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> vmList</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">sort</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="93"><span style="--shiki-default:#9ABDF5">      (</span><span style="--shiki-default:#E0AF68">a</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#E0AF68"> b</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#89DDFF"> new</span><span style="--shiki-default:#7AA2F7"> Date</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">b</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">created_at</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#89DDFF">-</span><span style="--shiki-default:#89DDFF"> new</span><span style="--shiki-default:#7AA2F7"> Date</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">a</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">created_at</span><span style="--shiki-default:#9ABDF5">)
</span></span><span class="line" line="94"><span style="--shiki-default:#9ABDF5">    )[</span><span style="--shiki-default:#FF9E64">0</span><span style="--shiki-default:#9ABDF5">]</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="95"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    await</span><span style="--shiki-default:#C0CAF5"> axios</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">delete</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="96"><span style="--shiki-default:#89DDFF">      `</span><span style="--shiki-default:#9ECE6A">https://api.idcloudhost.com/v1/jkt01/user-resource/vm?uuid=</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">vmToDelete</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">uuid</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="97"><span style="--shiki-default:#9ABDF5">      { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">apikey</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> apiKey</span><span style="--shiki-default:#9ABDF5"> } }
</span></span><span class="line" line="98"><span style="--shiki-default:#9ABDF5">    )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="99"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    await</span><span style="--shiki-default:#7AA2F7"> updateKrakenDConfig</span><span style="--shiki-default:#9ABDF5">(
</span></span><span class="line" line="100"><span style="--shiki-default:#89DDFF">      `</span><span style="--shiki-default:#9ECE6A">http://</span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#C0CAF5">vmToDelete</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">private_ipv4</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#9ECE6A">:2358</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="101"><span style="--shiki-default:#89DDFF">      &quot;</span><span style="--shiki-default:#9ECE6A">remove</span><span style="--shiki-default:#89DDFF">&quot;
</span></span><span class="line" line="102"><span style="--shiki-default:#9ABDF5">    )</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="103"><span style="--shiki-default:#BB9AF7;--shiki-default-font-style:italic">    await</span><span style="--shiki-default:#7AA2F7"> updatePrometheusTargets</span><span style="--shiki-default:#9ABDF5">()</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="104"><span style="--shiki-default:#C0CAF5">    res</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">send</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#73DACA">message</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &quot;</span><span style="--shiki-default:#9ECE6A">VM Deleted</span><span style="--shiki-default:#89DDFF">&quot;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#73DACA"> vmDeleted</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> vmToDelete</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="105"><span style="--shiki-default:#9ABDF5">  } </span><span style="--shiki-default:#BB9AF7">catch</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#C0CAF5">error</span><span style="--shiki-default:#9ABDF5">) {
</span></span><span class="line" line="106"><span style="--shiki-default:#C0CAF5">    res</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">status</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#FF9E64">500</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">send</span><span style="--shiki-default:#9ABDF5">({ </span><span style="--shiki-default:#73DACA">error</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> error</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">message</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="107"><span style="--shiki-default:#9ABDF5">  }
</span></span><span class="line" line="108"><span style="--shiki-default:#9ABDF5">})</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="109"><span emptylineplaceholder="true">
</span></span><span class="line" line="110"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> PORT</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> process</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#C0CAF5">env</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#FF9E64">PORT</span><span style="--shiki-default:#BB9AF7"> ||</span><span style="--shiki-default:#FF9E64"> 3000</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="111"><span style="--shiki-default:#C0CAF5">app</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">listen</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#FF9E64">PORT</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> ()</span><span style="--shiki-default:#BB9AF7"> =&gt;</span><span style="--shiki-default:#C0CAF5"> console</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">log</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ECE6A">Server running on port </span><span style="--shiki-default:#7DCFFF">${</span><span style="--shiki-default:#FF9E64">PORT</span><span style="--shiki-default:#7DCFFF">}</span><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#9ABDF5">))</span><span style="--shiki-default:#89DDFF">;
</span></span></code><!--]--></pre><!--]--><!--]--></li><!--]--></ol><h2 id="implementasi-alerting"><a href="#implementasi-alerting"><!--[-->Implementasi Alerting<!--]--></a></h2><p><!--[-->Pada bagian ini kita akan mendefinisikan Trigger ketika event scale up atau scale down harus dijalankan. Hal dasar yang harus diketahui ketika<!--]--></p><p><!--[-->Keadaan yang harus dipenuhi agar sebuah event ter trigger disebut alert rules<!--]--></p><p><!--[-->Apa aksi yang harus dilakukan ketika sebuah alert rules disebut dengan contact points<!--]--></p><p><!--[-->Pada panduan ini hanya akan dilakukan kalkulasi alert rule dengan CPU Load<!--]--></p><h3 id="menghitung-rata-rata-cpu-load"><a href="#menghitung-rata-rata-cpu-load"><!--[-->Menghitung rata-rata CPU Load<!--]--></a></h3><p><!--[-->Kita sudah mendapatkan data melalu prometheus, berdasarkan data ini kita dapat menentukan rata rata CPU Load dari sistem.<!--]--></p><p><!--[-->Kita dapat menggunakan bahasa query dari prometehus yang bernama promql, kita akan membuat sebuah alert rule menggunakan bahasa promp ini<!--]--></p><p><!--[-->Kita ingin mengetahui rata rata CPU Load dari semua service yang ada dalam waktu 3 menit terakhir<!--]--></p><p><!--[-->Berikut logika diatas dalam bentuk query promql<!--]--></p><!--[--><pre class="language-sql shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span>100 - (avg(
</span></span><span class="line" line="2"><span>    rate(node_cpu_seconds_total{job=~&quot;judge0_seed|judge0_clone&quot;, mode=&quot;idle&quot;}[3m])
</span></span><span class="line" line="3"><span>)*100)
</span></span></code><!--]--></pre><!--]--><p><!--[-->Maksud dasar dari query diatas adalah untuk menghitung persentase penggunaan CPU (CPU Usage) dari server yang memiliki job dengan nama judge0_seed atau judge0_clone dalam tiga menit terakhir<!--]--></p><p><!--[-->Ada beberapa hal yang menjadi perhatian<!--]--></p><ul><!--[--><li><!--[--><code class=""><!--[-->node_cpu_seconds_total<!--]--></code> adalah metrik yang merepresentasikan waktu total yang dihabiskan oleh CPU dalam berbagai mode seperti idle, user, system, dll.<!--]--></li><li><!--[-->Label <code class=""><!--[-->{job=~&quot;judge0_seed|judge0_clone&quot;, mode=&quot;idle&quot;}<!--]--></code> akan mengambil waktu yang dihabiskan oleh cpu dalam masa idle pada server dengan job name judge0_seed atau judge0_clone.<!--]--></li><li><!--[-->Fungsi<code class=""><!--[-->rate<!--]--></code> menghitung tingkat perubahan (rate) dari <strong><!--[--><code class=""><!--[-->node_cpu_seconds_total<!--]--></code><!--]--></strong> dalam interval waktu 3 menit (<strong><!--[--><span>3m</span><!--]--></strong>).<!--]--></li><li><!--[-->Setelah menghitung rate dari waktu idle CPU, hasilnya dikalikan 100 untuk mengonversi menjadi persentase waktu idle.<!--]--></li><li><!--[-->**<code class=""><!--[-->avg<!--]--></code>**Mengambil rata-rata dari semua CPU yang disaring oleh query (jika ada beberapa core CPU).<!--]--></li><li><!--[-->**<code class=""><!--[-->100 - ...<!--]--></code>**Mengurangi hasil dari persentase waktu idle dari 100 untuk mendapatkan persentase penggunaan CPU (CPU utilization).<!--]--></li><li><!--[-->Hasil akhirnya adalah rata-rata persentase penggunaan CPU selama 3 menit terakhir untuk server dengan job name <strong><!--[-->judge0_seed<!--]--></strong> atau <strong><!--[-->judge0_clone<!--]--></strong>.<!--]--></li><!--]--></ul><h3 id="mengatur-alert-rule-untuk-event-scale-up"><a href="#mengatur-alert-rule-untuk-event-scale-up"><!--[-->Mengatur Alert Rule Untuk Event Scale Up<!--]--></a></h3><h4 id="_1-enter-alert-rule-name"><a href="#_1-enter-alert-rule-name"><!--[-->1. Enter alert rule name<!--]--></a></h4><p><!--[-->Masukan nama dari alert rule<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/5f2a7f83-0f94-488c-9404-d54249a0f222/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/5f2a7f83-0f94-488c-9404-d54249a0f222/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/5f2a7f83-0f94-488c-9404-d54249a0f222/image.png"><!--]--></p><h4 id="_2-query-and-alert-condition"><a href="#_2-query-and-alert-condition"><!--[-->2. Query and Alert Condition<!--]--></a></h4><p><!--[-->Gambar dibawah adalah pengaturan untuk query dan treshold.<!--]--></p><p><!--[-->Gunakan query untuk menghitung average CPU yang sudah kita definisikan sebelumnya<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/a3acd991-ed39-461d-b3d1-1b2f62bc5b07/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/a3acd991-ed39-461d-b3d1-1b2f62bc5b07/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/a3acd991-ed39-461d-b3d1-1b2f62bc5b07/image.png"><!--]--></p><p><!--[-->Lalu untuk treshold, kita tidak memerlukan fungsi reduce karena query sudah merupakan satu nilaiI<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/a3580c90-e175-4f44-b19a-ba570503b696/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/a3580c90-e175-4f44-b19a-ba570503b696/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/a3580c90-e175-4f44-b19a-ba570503b696/image.png"><!--]--></p><p><!--[-->Pengaturan diatas menentukan bahwa, grafana akan melakukan alert pada saat Average CPU Load lebih dari 70%<!--]--></p><h4 id="_3-set-evaluation-behaviour"><a href="#_3-set-evaluation-behaviour"><!--[-->3. Set Evaluation Behaviour<!--]--></a></h4><p><!--[-->Gambar dibawah Menunjukan pengaturan dalam pengeturan inerval evaluasi sistem. Pengaturan ini akan menentukan seberapa sering query dijalankan dan seberapa sering grafana akan membandingkan hasil dari query dengan treshold yang kita tentukan.<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/32d0e6c0-6f38-49a8-a40b-5c0faf2cdef0/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/32d0e6c0-6f38-49a8-a40b-5c0faf2cdef0/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/32d0e6c0-6f38-49a8-a40b-5c0faf2cdef0/image.png"><!--]--></p><ol><!--[--><li><!--[-->Folder<!--]--></li><!--]--></ol><p><!--[-->Kita akan mengelompokah rule pada folder scale up<!--]--></p><ol><!--[--><li><!--[-->Evaluation grouup and interval<!--]--></li><!--]--></ol><p><!--[-->Kita membuat evaluaiton evaluation group bernama <code class=""><!--[-->eval_10s<!--]--></code> yang akan mengevaluasi rule setiap sepuluh detik<!--]--></p><ol><!--[--><li><!--[-->Pending Period<!--]--></li><!--]--></ol><p><!--[-->Mengatur pending period menjadi <code class=""><!--[-->none<!--]--></code> artinya ketika treshold terpenuhi, alert rule akan langsung mentrigger api untuk melakukan scaling.<!--]--></p><ol><!--[--><li><!--[-->Configure No Data and error handling<!--]--></li><!--]--></ol><p><!--[-->Tidak di set<!--]--></p><h4 id="_4-configure-labels-and-notifications"><a href="#_4-configure-labels-and-notifications"><!--[-->4. Configure labels and notifications<!--]--></a></h4><p><!--[-->Pada menu contact point pilih webhook scale up yang sudah dibuat sebelumnya<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/bd5c9d79-98e5-4217-acc5-418b491aae1c/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/bd5c9d79-98e5-4217-acc5-418b491aae1c/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/bd5c9d79-98e5-4217-acc5-418b491aae1c/image.png"><!--]--></p><h3 id="mengatur-alert-rule-untuk-event-scale-down"><a href="#mengatur-alert-rule-untuk-event-scale-down"><!--[-->Mengatur alert rule untuk event scale down<!--]--></a></h3><h4 id="_1-enter-alert-rule-name-1"><a href="#_1-enter-alert-rule-name-1"><!--[-->1. Enter alert rule name<!--]--></a></h4><p><!--[-->Masukan nama dari alert rule<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/abd97cc7-6473-47d0-a5cb-4ecf752670bc/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/abd97cc7-6473-47d0-a5cb-4ecf752670bc/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/abd97cc7-6473-47d0-a5cb-4ecf752670bc/image.png"><!--]--></p><h4 id="_2-define-query-and-alert-condition"><a href="#_2-define-query-and-alert-condition"><!--[-->2. Define Query and Alert Condition<!--]--></a></h4><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/1f407776-b0f4-4ff0-949f-d6c1b11cb980/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/1f407776-b0f4-4ff0-949f-d6c1b11cb980/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/1f407776-b0f4-4ff0-949f-d6c1b11cb980/image.png"><!--]--></p><p><!--[-->Sama seperti scalle up gunakan query untuk menghitung Average CPU Load yang sduah ditentukan sebelumnya<!--]--></p><p><!--[-->Lalu tentukan threshold seperti ini<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/4fc24116-f30a-43e2-87a6-ebdcb00c9c7b/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/4fc24116-f30a-43e2-87a6-ebdcb00c9c7b/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/4fc24116-f30a-43e2-87a6-ebdcb00c9c7b/image.png"><!--]--></p><p><!--[-->Disini kita telah mengatur alert rule scale down akan di jalankan ketika average CPU kurang dari 30%.<!--]--></p><h4 id="_3-set-evaluation-behaviour-1"><a href="#_3-set-evaluation-behaviour-1"><!--[-->3. Set evaluation behaviour<!--]--></a></h4><p><!--[-->Berikut adalah pengaturan evaluasi sistem<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/975022b2-bd0b-438b-839d-8fcaf2528cf4/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/975022b2-bd0b-438b-839d-8fcaf2528cf4/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/975022b2-bd0b-438b-839d-8fcaf2528cf4/image.png"><!--]--></p><ol><!--[--><li><!--[-->Folder<!--]--></li><!--]--></ol><p><!--[-->Dikelompokan dalam fodler scale down<!--]--></p><ol><!--[--><li><!--[-->Evaluation groudp and interval<!--]--></li><!--]--></ol><p><!--[-->Menggunakan interval group yang sama dengan alert rule scale up yaitu <code class=""><!--[-->eval10s<!--]--></code> yang akan mengevaluasi rule setiap 10 detik<!--]--></p><ol><!--[--><li><!--[-->Pending Period<!--]--></li><!--]--></ol><p><!--[-->Pending selama 2 menit untuk mengantisipasi ketika terjadi sudden drop, karena scale up merupakan proses yang lama<!--]--></p><p><!--[-->lalu kelebihan server tidka menimpbulakan instability hanya menambah cost. sehingga mengantisipasi drop yang hanya sementara<!--]--></p><p><!--[-->akan lebih baik jika kita memiliki server lebih lebih lama jika sewaktu waktu terjadi spike karena proses scale up lebih lama dari scale down<!--]--></p><ol><!--[--><li><!--[-->Configure No Data and error handling<!--]--></li><!--]--></ol><p><!--[-->Tidak di set<!--]--></p><h4 id="_4-configure-labels-and-notification"><a href="#_4-configure-labels-and-notification"><!--[-->4. Configure labels and notification<!--]--></a></h4><p><!--[-->Pada menu contact point pilih webhook scale down yang sudah dibuat sebelumnya<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="image.png" data-nuxt-img srcset="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/775d2998-585f-4bd0-b12b-d8400bb56ee6/image.png 1x, https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/775d2998-585f-4bd0-b12b-d8400bb56ee6/image.png 2x" src="https://prod-files-secure.s3.us-west-2.amazonaws.com/a780a314-a324-4050-aaa4-d4498b8af326/775d2998-585f-4bd0-b12b-d8400bb56ee6/image.png"><!--]--></p><h2 id="konsep-testing"><a href="#konsep-testing"><!--[-->Konsep Testing<!--]--></a></h2><p><!--[-->Untuk melakukan testing fitur scale down dan scale up kita harus bisa mengatur secara presisi berapa banyak request yang dikimkan ke server. Artinya kita harus bisa mengendalikan Request per second (RPS), ini diperlukan agar kita bisa mengontrol CPU Load dari sistem secara presisi.<!--]--></p><p><!--[-->Selain itu kita harus bisa mengatur testing yang ramping artinya testig yang seiring waktu meningkat untuk mensimulasikan trafic pada sehingga mentrigger scale up lalu menurunkan traffic untuk mensimulasikan trafic yang sepi sehingga mentrigger scale down<!--]--></p><p><!--[-->Untuk memenuhi kebutuhan ini kita akan menggunakna executor dari K6 yaitu <code class=""><!--[-->rampign-arrival-rate<!--]--></code> . Executor ini memungkinkan kita untuk mengatur RPS secara presisi dan menaikan atau menurunkan RPS seiring waktu.<!--]--></p><h2 id="merancang-kode-testing"><a href="#merancang-kode-testing"><!--[-->Merancang Kode Testing<!--]--></a></h2><p><!--[-->Pada kode testing dibawah ini kita akan mengirimkan POST Request pada endpoint <code class=""><!--[-->/v1/subm<!--]--></code>issions-dev?wait=true&amp;base64_encoded=false&#39;` yang berfungsi untuk mengeksekusi kode dan akan menghasilkan response berupa hasil dari eksekusi kode.<!--]--></p><!--[--><pre class="language-jsx shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#0DB9D7"> http</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">k6/http</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="2"><span style="--shiki-default:#7DCFFF">import</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#0DB9D7">check</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#7DCFFF"> from</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">k6</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">// 1. Source Codes
</span></span><span class="line" line="5"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">const</span><span style="--shiki-default:#BB9AF7"> sourceCodes</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9ABDF5"> [
</span></span><span class="line" line="6"><span style="--shiki-default:#89DDFF">  `</span><span style="--shiki-default:#9ECE6A">def leetcode_function(nums, target):
</span></span><span class="line" line="7"><span style="--shiki-default:#9ECE6A">  for i in range(len(nums)):
</span></span><span class="line" line="8"><span style="--shiki-default:#9ECE6A">    for j in range(i + 1, len(nums)):
</span></span><span class="line" line="9"><span style="--shiki-default:#9ECE6A">      if nums[i] + nums[j] == target:
</span></span><span class="line" line="10"><span style="--shiki-default:#9ECE6A">        return [i, j]
</span></span><span class="line" line="11"><span style="--shiki-default:#9ECE6A">  return []
</span></span><span class="line" line="12"><span style="--shiki-default:#9ECE6A">print(&#39;LeetCode Function Result:&#39;, leetcode_function([2, 7, 11, 15], 9))
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#89DDFF">`</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="15"><span style="--shiki-default:#F7768E;--shiki-default-font-weight:bold">...
</span></span><span class="line" line="16"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">// other code
</span></span><span class="line" line="17"><span style="--shiki-default:#9ABDF5">]</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">// 2. Options
</span></span><span class="line" line="20"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic"> const</span><span style="--shiki-default:#BB9AF7"> options</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="21"><span style="--shiki-default:#73DACA">  scenarios</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="22"><span style="--shiki-default:#73DACA">    ramping_test</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="23"><span style="--shiki-default:#41A6B5">      executor</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">ramping-arrival-rate</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="24"><span style="--shiki-default:#41A6B5">      startRate</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 0</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="25"><span style="--shiki-default:#41A6B5">      timeUnit</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">1s</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="26"><span style="--shiki-default:#41A6B5">      preAllocatedVUs</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 2</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="27"><span style="--shiki-default:#41A6B5">      maxVUs</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 30</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="28"><span style="--shiki-default:#41A6B5">      stages</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> [
</span></span><span class="line" line="29"><span style="--shiki-default:#9ABDF5">        {</span><span style="--shiki-default:#41A6B5"> duration</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">3m</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#41A6B5"> target</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 3</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="30"><span style="--shiki-default:#9ABDF5">        {</span><span style="--shiki-default:#41A6B5"> duration</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">9m</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#41A6B5"> target</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 6</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="31"><span style="--shiki-default:#9ABDF5">        {</span><span style="--shiki-default:#41A6B5"> duration</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">5m</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#41A6B5"> target</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 1</span><span style="--shiki-default:#9ABDF5"> }</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="32"><span style="--shiki-default:#9ABDF5">      ]</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="33"><span style="--shiki-default:#9ABDF5">    }</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="34"><span style="--shiki-default:#9ABDF5">  }</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="35"><span style="--shiki-default:#73DACA">  discardResponseBodies</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> true</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="36"><span style="--shiki-default:#9ABDF5">}</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="37"><span emptylineplaceholder="true">
</span></span><span class="line" line="38"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">// 3. Default Function
</span></span><span class="line" line="39"><span style="--shiki-default:#7DCFFF">export</span><span style="--shiki-default:#7DCFFF"> default</span><span style="--shiki-default:#BB9AF7"> function</span><span style="--shiki-default:#9ABDF5"> ()</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="40"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // [a]
</span></span><span class="line" line="41"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  let</span><span style="--shiki-default:#BB9AF7"> url</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">https://submissions.pojokoding.my.id/v1/subm`issions-dev?wait=true&amp;base64_encoded=false</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="42"><span emptylineplaceholder="true">
</span></span><span class="line" line="43"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // [b]
</span></span><span class="line" line="44"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  let</span><span style="--shiki-default:#BB9AF7"> headers</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="45"><span style="--shiki-default:#89DDFF">    &#39;</span><span style="--shiki-default:#9ECE6A">Authorization</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">43304a11-4ece-4938-8a81-c4113ed10cf6</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="46"><span style="--shiki-default:#89DDFF">    &#39;</span><span style="--shiki-default:#9ECE6A">Content-Type</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#89DDFF"> &#39;</span><span style="--shiki-default:#9ECE6A">application/json</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="47"><span style="--shiki-default:#9ABDF5">  }</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="48"><span emptylineplaceholder="true">
</span></span><span class="line" line="49"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // [c]
</span></span><span class="line" line="50"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  let</span><span style="--shiki-default:#BB9AF7"> randomIndex</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> Math</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">floor</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">Math</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">random</span><span style="--shiki-default:#9ABDF5">() </span><span style="--shiki-default:#89DDFF">*</span><span style="--shiki-default:#C0CAF5"> sourceCodes</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">length</span><span style="--shiki-default:#9ABDF5">)</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="51"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  let</span><span style="--shiki-default:#BB9AF7"> randomSourceCode</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> sourceCodes</span><span style="--shiki-default:#9ABDF5">[</span><span style="--shiki-default:#7DCFFF">randomIndex</span><span style="--shiki-default:#9ABDF5">]</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="52"><span emptylineplaceholder="true">
</span></span><span class="line" line="53"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // [d]
</span></span><span class="line" line="54"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  let</span><span style="--shiki-default:#BB9AF7"> body</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#0DB9D7"> JSON</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">stringify</span><span style="--shiki-default:#9ABDF5">({
</span></span><span class="line" line="55"><span style="--shiki-default:#73DACA">    source_code</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> randomSourceCode</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="56"><span style="--shiki-default:#73DACA">    language_id</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#FF9E64"> 71</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="57"><span style="--shiki-default:#9ABDF5">  })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="58"><span emptylineplaceholder="true">
</span></span><span class="line" line="59"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // [e]
</span></span><span class="line" line="60"><span style="--shiki-default:#9D7CD8;--shiki-default-font-style:italic">  let</span><span style="--shiki-default:#BB9AF7"> res</span><span style="--shiki-default:#89DDFF"> =</span><span style="--shiki-default:#C0CAF5"> http</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7AA2F7">post</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">url</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#C0CAF5"> body</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> { </span><span style="--shiki-default:#73DACA">headers</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#C0CAF5"> headers</span><span style="--shiki-default:#9ABDF5"> })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="61"><span emptylineplaceholder="true">
</span></span><span class="line" line="62"><span style="--shiki-default:#51597D;--shiki-default-font-style:italic">    // [f]
</span></span><span class="line" line="63"><span style="--shiki-default:#7AA2F7">  check</span><span style="--shiki-default:#9ABDF5">(</span><span style="--shiki-default:#C0CAF5">res</span><span style="--shiki-default:#89DDFF">,</span><span style="--shiki-default:#9ABDF5"> {
</span></span><span class="line" line="64"><span style="--shiki-default:#89DDFF">    &#39;</span><span style="--shiki-default:#9ECE6A">status is 200</span><span style="--shiki-default:#89DDFF">&#39;</span><span style="--shiki-default:#89DDFF">:</span><span style="--shiki-default:#9ABDF5"> (</span><span style="--shiki-default:#E0AF68">r</span><span style="--shiki-default:#9ABDF5">) </span><span style="--shiki-default:#BB9AF7">=&gt;</span><span style="--shiki-default:#C0CAF5"> r</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">status</span><span style="--shiki-default:#BB9AF7"> ===</span><span style="--shiki-default:#FF9E64"> 200</span><span style="--shiki-default:#89DDFF">,
</span></span><span class="line" line="65"><span style="--shiki-default:#9ABDF5">  })</span><span style="--shiki-default:#89DDFF">;
</span></span><span class="line" line="66"><span style="--shiki-default:#9ABDF5">}
</span></span></code><!--]--></pre><!--]--><ol><!--[--><li><!--[-->Source Codes<ol><!--[--><li><!--[--><code class=""><!--[-->const sourceCodes<!--]--></code> : Ini adalah variabel berisi array string kode yang akan dikirmkan bersama body request, value akan dipilih secara random<!--]--></li><!--]--></ol><!--]--></li><li><!--[-->Options<ol><!--[--><li><!--[--><strong><!--[--><code class=""><!--[-->scenarios<!--]--></code><!--]--></strong>: Mengatur skenario pengujian beban (load testing) yang akan dijalankan oleh K6. Di dalamnya, terdapat definisi satu skenario bernama <code class=""><!--[-->ramping_test<!--]--></code>.
<ol><!--[--><li><!--[--><strong><!--[--><code class=""><!--[-->ramping_test<!--]--></code><!--]--></strong>: Nama skenario pengujian. Nama ini bisa diubah sesuai kebutuhan.
<ol><!--[--><li><!--[--><strong><!--[--><code class=""><!--[-->executor<!--]--></code><!--]--></strong>: Jenis eksekutor yang menentukan bagaimana virtual users (VU) akan diatur.<!--]--></li><li><!--[--><strong><!--[--><code class=""><!--[-->ramping-arrival-rate<!--]--></code><!--]--></strong>: Eksekutor ini digunakan untuk secara bertahap meningkatkan atau mengurangi jumlah request yang tiba pada sistem, dikendalikan oleh pengaturan rate (RPS) selama periode waktu yang ditentukan.<!--]--></li><li><!--[--><strong><!--[--><code class=""><!--[-->startRate<!--]--></code><!--]--></strong>: Menentukan <strong><!--[-->rate awal<!--]--></strong> dari request yang dikirim ke sistem saat pengujian dimulai. Dalam hal ini, pengujian dimulai dengan <strong><!--[-->0 request per second (RPS)<!--]--></strong> dan akan meningkat berdasarkan pengaturan pada <code class=""><!--[-->stages<!--]--></code>.<!--]--></li><li><!--[--><strong><!--[--><code class=""><!--[-->timeUnit<!--]--></code><!--]--></strong>: Menentukan satuan waktu untuk mengukur tingkat request. Di sini, setiap request per second (RPS) diukur dalam interval <strong><!--[-->per detik<!--]--></strong> (<code class=""><!--[-->1s<!--]--></code>), yang berarti jumlah request yang tiba diatur dalam hitungan per detik.<!--]--></li><li><!--[--><strong><!--[--><code class=""><!--[-->preAllocatedVUs<!--]--></code><!--]--></strong>: Menentukan jumlah <strong><!--[-->virtual users (VU)<!--]--></strong> yang akan dialokasikan <strong><!--[-->sebelum pengujian dimulai<!--]--></strong>. Dalam kasus ini, <strong><!--[-->2 VU<!--]--></strong> dialokasikan untuk menangani request saat pengujian dimulai.<!--]--></li><li><!--[--><strong><!--[--><code class=""><!--[-->maxVUs<!--]--></code><!--]--></strong>: Menentukan jumlah <strong><!--[-->maksimum VU<!--]--></strong> yang bisa digunakan untuk pengujian ini. <strong><!--[-->30 VU<!--]--></strong> adalah batas atas yang digunakan untuk mengatur skala maksimal dari pengujian. Jika diperlukan lebih banyak VU untuk memenuhi rate RPS yang diminta, hingga 30 VU akan dialokasikan.<!--]--></li><li><!--[--><strong><!--[--><code class=""><!--[-->stages<!--]--></code><!--]--></strong>: Tahapan yang mengatur bagaimana tingkat Request Per Second (RPS) akan berubah selama pengujian.
<ol><!--[--><li><!--[--><strong><!--[-->{ duration: &#39;3m&#39;, target: 3 }<!--]--></strong>:
<ul><!--[--><li><!--[-->Tahap pertama berlangsung selama <strong><!--[-->3 menit<!--]--></strong>, dengan target untuk mencapai <strong><!--[-->3 request per second (RPS)<!--]--></strong> di akhir tahap ini. Ini adalah proses ramp-up dari 0 RPS hingga 3 RPS.<!--]--></li><!--]--></ul><!--]--></li><li><!--[--><strong><!--[-->{ duration: &#39;9m&#39;, target: 6 }<!--]--></strong>:
<ul><!--[--><li><!--[-->Tahap kedua berlangsung selama <strong><!--[-->9 menit<!--]--></strong>, di mana tingkat kedatangan request meningkat secara bertahap hingga mencapai <strong><!--[-->6 RPS<!--]--></strong>.<!--]--></li><!--]--></ul><!--]--></li><li><!--[--><strong><!--[-->{ duration: &#39;5m&#39;, target: 1 }<!--]--></strong>:
<ul><!--[--><li><!--[-->Tahap ketiga berlangsung selama <strong><!--[-->5 menit<!--]--></strong>, dan dalam tahap ini, tingkat RPS menurun <strong><!--[-->dari 6 RPS menjadi 1 RPS<!--]--></strong>. Ini merupakan proses ramp-down atau pengurangan beban.<!--]--></li><!--]--></ul><!--]--></li><!--]--></ol><!--]--></li><!--]--></ol><!--]--></li><!--]--></ol><!--]--></li><li><!--[--><strong><!--[--><code class=""><!--[-->discardResponseBodies<!--]--></code><!--]--></strong>: Pengaturan ini akan <strong><!--[-->mengabaikan body respons<!--]--></strong> dari setiap request yang dikirim. Ini berguna untuk menghemat memori selama pengujian beban, terutama jika body respons tidak penting untuk analisis hasil pengujian.<!--]--></li><!--]--></ol><!--]--></li><li><!--[-->Default Function<ol><!--[--><li><!--[--><strong><!--[-->URL<!--]--></strong>
Variabel <code class=""><!--[-->url<!--]--></code> berisi alamat endpoint untuk melakukan request POST, yaitu <code class=""><!--[-->https://submissions.pojokoding.my.id/v1/submissions-dev?wait=true&amp;base64_encoded=false<!--]--></code>.<!--]--></li><li><!--[--><strong><!--[-->Headers<!--]--></strong>
Variabel <code class=""><!--[-->headers<!--]--></code> menyimpan <strong><!--[-->header HTTP<!--]--></strong> yang akan dikirim bersama dengan request. Ada dua header yang disetel: - <strong><!--[-->Authorization<!--]--></strong>: Berisi token atau kunci API (<code class=""><!--[-->43304a11-4ece-4938-8a81-c4113ed10cf6<!--]--></code>), yang digunakan untuk otentikasi agar bisa mengakses API. - <strong><!--[-->Content-Type<!--]--></strong>: Mengindikasikan tipe data yang dikirim dalam request adalah JSON (<code class=""><!--[-->application/json<!--]--></code>).<!--]--></li><li><!--[--><strong><!--[-->Random Source Code Selection<!--]--></strong>
Baris ini memilih <strong><!--[-->source code secara acak<!--]--></strong> dari array <code class=""><!--[-->sourceCodes<!--]--></code>. Variabel <code class=""><!--[-->randomIndex<!--]--></code> menghasilkan angka acak menggunakan <code class=""><!--[-->Math.random()<!--]--></code> dan <code class=""><!--[-->Math.floor()<!--]--></code> untuk mendapatkan indeks yang valid dari array <code class=""><!--[-->sourceCodes<!--]--></code>. Selanjutnya, kode yang dipilih secara acak disimpan di variabel <code class=""><!--[-->randomSourceCode<!--]--></code>.<!--]--></li><li><!--[--><strong><!--[-->Request Body<!--]--></strong>
Variabel <code class=""><!--[-->body<!--]--></code> berisi <strong><!--[-->data JSON yang dikirim<!--]--></strong> dalam request POST. Dalam body ini terdapat dua parameter: - <strong><!--[-->source_code<!--]--></strong>: Kode sumber yang diambil secara acak dari <code class=""><!--[-->sourceCodes<!--]--></code>. - <strong><!--[-->language_id<!--]--></strong>: ID bahasa pemrograman yang digunakan, dalam hal ini 71 (mungkin mengacu pada bahasa pemrograman spesifik seperti Python atau C++). Kode sumber dan ID bahasa dikirim ke API untuk diproses.<!--]--></li><li><!--[--><strong><!--[-->HTTP POST Request<!--]--></strong>
Fungsi <code class=""><!--[-->http.post<!--]--></code> digunakan untuk <strong><!--[-->mengirim request POST<!--]--></strong> ke <code class=""><!--[-->url<!--]--></code> yang sudah didefinisikan. Parameter yang dikirimkan adalah <code class=""><!--[-->url<!--]--></code>, <code class=""><!--[-->body<!--]--></code>, dan objek <code class=""><!--[-->headers<!--]--></code>. - <strong><!--[-->url<!--]--></strong>: Alamat endpoint API yang akan diakses. - <strong><!--[-->body<!--]--></strong>: Data yang dikirim dalam format JSON. - <strong><!--[-->headers<!--]--></strong>: Header untuk autentikasi dan informasi tipe konten.<!--]--></li><li><!--[--><strong><!--[-->Response Validation<!--]--></strong>
Fungsi <code class=""><!--[-->check<!--]--></code> digunakan untuk <strong><!--[-->memeriksa status respons<!--]--></strong> dari server. - <code class=""><!--[-->status is 200<!--]--></code>: Mengecek apakah status HTTP dari respons adalah <strong><!--[-->200<!--]--></strong> (OK), yang menunjukkan bahwa permintaan berhasil diproses. Jika statusnya 200, check akan mengembalikan <code class=""><!--[-->true<!--]--></code>, jika tidak, <code class=""><!--[-->false<!--]--></code>.<!--]--></li><!--]--></ol><br>Setiap bagian ini membantu memastikan pengiriman data secara acak ke API dan memverifikasi bahwa respons dari server sesuai dengan ekspektasi.<!--]--></li><!--]--></ol><h2 id="menjalankan-testing"><a href="#menjalankan-testing"><!--[-->Menjalankan Testing<!--]--></a></h2><p><!--[-->Pastikan sudah menginstall k6 lalu Buka terminal untuk menjalankan command berikut untuk menjalankan testing<!--]--></p><!--[--><pre class="language-jsx shiki shiki-themes tokyo-night" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C0CAF5">k6</span><span style="--shiki-default:#C0CAF5"> run</span><span style="--shiki-default:#C0CAF5"> filetest</span><span style="--shiki-default:#89DDFF">.</span><span style="--shiki-default:#7DCFFF">js
</span></span></code><!--]--></pre><!--]--><h2 id="analisis-hasil-testing"><a href="#analisis-hasil-testing"><!--[-->Analisis Hasil Testing<!--]--></a></h2><p><!--[-->BELUM ADA<!--]--></p><h2 id="konsiderasi"><a href="#konsiderasi"><!--[-->Konsiderasi<!--]--></a></h2><p><!--[--><strong><!--[-->PERHITUNGAN SCALE UP DAN SCALE DOWN<!--]--></strong><!--]--></p><p><!--[-->dalam perhitungan scale up dan scale down identifikasi apa yang menjadi resource utama yang dibutuhkan resource anda, pada panduan kali ini judge0 hanya menggunakan CPU dan sangat sedikit ram sehingga kalkulasi alerting hanya menggunakan parameter CPU<!--]--></p><p><!--[--><strong><!--[-->KEAMANAN<!--]--></strong><!--]--></p><p><!--[-->panduan ini sama sekali tidak menerapkan keamanan pada API Gateway sehingga rentan<!--]--></p><p><!--[--><a href="http://mochi.com" rel="nofollow"><!--[-->http://mochi.com<!--]--></a><!--]--></p><p><!--[-->kelapa.com<!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!--]--></div></div><!--]--></div><div class="w-full lg:w-3/12 p-4 lg:sticky lg:top-0 lg:max-h-screen lg:overflow-y-auto"><div class="no-scrollbar"><div class="flex items-center justify-end gap-3 pr-8"><div><button class="w-24 h-8 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="1em" height="1em" fill="currentColor" class="text-2xl"><!--[--><!--]--><g><path d="M120,40V16a8,8,0,0,1,16,0V40a8,8,0,0,1-16,0Zm72,88a64,64,0,1,1-64-64A64.07,64.07,0,0,1,192,128Zm-16,0a48,48,0,1,0-48,48A48.05,48.05,0,0,0,176,128ZM58.34,69.66A8,8,0,0,0,69.66,58.34l-16-16A8,8,0,0,0,42.34,53.66Zm0,116.68-16,16a8,8,0,0,0,11.32,11.32l16-16a8,8,0,0,0-11.32-11.32ZM192,72a8,8,0,0,0,5.66-2.34l16-16a8,8,0,0,0-11.32-11.32l-16,16A8,8,0,0,0,192,72Zm5.66,114.34a8,8,0,0,0-11.32,11.32l16,16a8,8,0,0,0,11.32-11.32ZM48,128a8,8,0,0,0-8-8H16a8,8,0,0,0,0,16H40A8,8,0,0,0,48,128Zm80,80a8,8,0,0,0-8,8v24a8,8,0,0,0,16,0V216A8,8,0,0,0,128,208Zm112-88H216a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16Z"></path></g></svg></button></div><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" data-nuxt-img srcset="/_ipx/_/img/logo-personal.png 1x, /_ipx/_/img/logo-personal.png 2x" class="w-36 h-auto" src="/_ipx/_/img/logo-personal.png"></div><div class="p-4"><div data-v-a356f31a><div class="border-2 rounded p-6" data-v-a356f31a><h2 class="text-2xl font-mono" data-v-a356f31a>Table of Content</h2><!----></div></div></div></div></div></div></div></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/pengembangan-horizontal-autoscaling-dengan-idcloudhost-api-menggunakan-grafana-alert-dan-traefik-sebagai-load-balancer/_payload.json?3d9e6010-51ed-4486-b44b-cffed3a55717">[{"state":1,"once":7,"_errors":8,"serverRendered":5,"path":11,"pinia":12,"prerenderedAt":17},["Reactive",2],{"$scolor-mode":3},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,["Set"],["ShallowReactive",9],{"article":10,"content-query-XszOHfvhHz":10},null,"/blog/pengembangan-horizontal-autoscaling-dengan-idcloudhost-api-menggunakan-grafana-alert-dan-traefik-sebagai-load-balancer",["Reactive",13],{"blog":14},{"currentArticle":15},["Ref",16],"CEK",1729427933870]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{useNuxtImage:true,components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1729427915476,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:"tokyo-night",highlighter:"shiki",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml"]},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}},studio:{apiURL:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""}},app:{baseURL:"/",buildId:"3d9e6010-51ed-4486-b44b-cffed3a55717",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>