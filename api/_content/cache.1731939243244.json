{"generatedAt":1731939261388,"generateTime":835,"contents":[{"_path":"/blog/autoscaling-pada-idcloudhost-menggunakan-grafana-traefik","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Pengembangan Autoscaling Horizontal pada IDCloudHost Menggunakan Traefik Sebagai Load Balancer dan Grafana Alert","description":"An overview of Traefik and its role as an API Gateway in modern web applications.","thumbnail":"https://unsplash.it/640/425","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"pengembangan-horizontal-autoscaling-dengan-idcloudhost-api-menggunakan-grafana-alert-dan-traefik-sebagai-load-balancer"},"children":[{"type":"text","value":"Pengembangan Horizontal Autoscaling dengan IDCloudHost API Menggunakan Grafana Alert dan Traefik sebagai Load Balancer"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"IDCloudHost menyediakan virtual machine (VM) dengan harga yang relatif terjangkau dibandingkan penyedia layanan cloud lainnya, seperti AWS atau DigitalOcean."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Provider"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Harga dalam USD"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Harga dalam IDR"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"AWS (On-Demand, T3 Small, 2 CPU, 2 GiB RAM, 60 GB EBS Storage)"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"$25.03"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Rp 391.939"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"DigitalOcean Droplet (2 CPU, 2 GiB RAM, 60 GB Storage)"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"$18.00"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Rp 281.826"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"IDCloudHost (2 CPU, 2 GiB RAM, 60 GB Storage)"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"$7.19"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Rp 112.500"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"*Data diambil pada 8 Oktober 2024"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Harga AWS diperoleh dari AWS Pricing Calculator."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Harga DigitalOcean diperoleh dari halaman pricing Droplets."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Harga IDCloudHost diperoleh dari halaman console saat membuat VM baru."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Kurs: 1 Dollar = Rp 15.657 (8 Oktober 2024)."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Meskipun harganya lebih terjangkau, IDCloudHost tidak memiliki fitur yang selengkap penyedia lain, seperti autoscaling."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Fitur autoscaling sangat penting untuk menangani peningkatan trafik secara otomatis, tanpa memerlukan intervensi manual. Saat ini, IDCloudHost menyediakan fitur self-upgrade dan self-downgrade pada layanannya. Meskipun memungkinkan scaling secara manual, fitur ini tidak seotomatis autoscaling pada layanan cloud besar lainnya."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Namun, IDCloudHost menyediakan API yang dapat digunakan untuk mengelola setiap sumber daya, termasuk membuat dan menghapus VM."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Artikel ini akan menjelaskan cara memanfaatkan API ini untuk keperluan autoscaling dengan bantuan Grafana "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"alert"}]},{"type":"text","value":" dan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"load balancer"}]},{"type":"text","value":" dari Traefik."}]},{"type":"element","tag":"h2","props":{"id":"gambaran-sistem-yang-akan-dibuat"},"children":[{"type":"text","value":"Gambaran Sistem yang Akan Dibuat"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Gambar di bawah adalah gambaran umum dari sistem autoscaling yang akan dibuat:"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/general-archi.svg"},"children":[]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Kelompok "},{"type":"element","tag":"em","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"service-clones"}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Service clones"}]},{"type":"text","value":" adalah kumpulan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"virtual machine"}]},{"type":"text","value":" yang akan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"di-autoscale"}]},{"type":"text","value":". Kelompok virtual machine ini dibuat dari sebuah \"service seed,\" yaitu virtual machine utama yang berfungsi sebagai template. Service seed berisi aplikasi dan konfigurasi yang diperlukan, dan setiap service clone yang dibuat merupakan salinan dari service seed."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Traefik API Gateway & Load Balancer"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nTraefik adalah "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"HTTP reverse proxy"}]},{"type":"text","value":" yang sejenis dengan NGINX namun menawarkan konfigurasi yang lebih user-friendly. Pada artikel ini, Traefik akan digunakan sebagai "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"API gateway"}]},{"type":"text","value":" dan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"load balancer"}]},{"type":"text","value":" yang bertugas sebagai lapisan pertama sebelum request."},{"type":"element","tag":"info-box","props":{"title":"Kenapa tidak menggunakan load balancer dari IdCloudHost?","type":"question"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Kendala utama dalam menggunakan load balancer bawaan IDCloudHost adalah keterbatasan pengendalian. Load balancer ini hanya mendukung metode session persistence yang tidak dapat diubah. Selain itu, biaya penggunaannya relatif tinggi yaitu Rp 150.000 per bulan dibanding membuat load balancer sendiri cukup dengan Rp 87.000 per bulan untuk konfigurasi 2 vCPU dan 2 GB RAM."}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Grafana & Prometheus Monitoring Server"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nGrafana dan Prometheus digunakan untuk monitoring dan pengiriman notifikasi. Prometheus berperan sebagai sumber data, sementara Grafana digunakan untuk visualisasi data dan penerapan fungsi alert yang dapat memicu scale up atau scale down."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IDCloudHost API"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nIni adalah API yang telah disediakan IDCloudHost. API ini memungkinkan pengguna berinteraksi dengan setiap resource yang ada di IDCloudHost, seperti membuat, menghapus, dan mengedit virtual machine."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IDCloudHost VPC Network"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nVPC memungkinkan server berkomunikasi melalui jaringan privat, yang mengurangi area potensi serangan oleh hacker."}]}]},{"type":"element","tag":"h2","props":{"id":"penjelasan-stack-yang-dipilih"},"children":[{"type":"text","value":"Penjelasan Stack yang Dipilih"}]},{"type":"element","tag":"h3","props":{"id":"traefik"},"children":[{"type":"text","value":"Traefik"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Traefik adalah "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"reverse proxy"}]},{"type":"text","value":" dan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"load balancer"}]},{"type":"text","value":" "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"open-source"}]},{"type":"text","value":" yang dirancang untuk mengatur traffic HTTP dan TCP di lingkungan mikroservis. Traefik dapat dijadikan API gateway, load balancer, dan proxy untuk server VM, Docker, atau Kubernetes."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Traefik memiliki banyak turunan yang menangani "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"use case"}]},{"type":"text","value":" yang berbeda, namun yang akan kita gunakan adalah "},{"type":"element","tag":"a","props":{"href":"https://doc.traefik.io/traefik/","rel":["nofollow"]},"children":[{"type":"text","value":"Traefik Proxy"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Alasan memilih Traefik adalah kemampuannya menyimpan konfigurasi dalam file yang dinamis. Artinya, perubahan dapat dilakukan langsung pada file tersebut tanpa perlu me-restart virtual machine. Ini sangat penting dalam peristiwa scaling, di mana konfigurasi sering diperbarui untuk menambah atau mengurangi daftar service yang terhubung ke load balancer. Dengan tidak perlu me-restart VM, downtime dapat dihindari selama proses scaling."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Saat ini, Traefik hanya mendukung metode load balancing "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"round robin"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"grafana"},"children":[{"type":"text","value":"Grafana"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Grafana adalah platform open-source yang berfungsi untuk menganalisis, memonitor, dan menvisualisasikan data dari berbagai macam sumber."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada artikel ini, Grafana akan digunakan untuk melakukan monitoring terhadap load dari server yang akan di-scaling."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Selain itu, Grafana juga memiliki fitur alert yang akan digunakan untuk menginisiasi peristiwa scale up atau scale down."}]},{"type":"element","tag":"h3","props":{"id":"prometheus"},"children":[{"type":"text","value":"Prometheus"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://prometheus.io/docs/introduction/overview/","rel":["nofollow"]},"children":[{"type":"text","value":"Prometheus"}]},{"type":"text","value":" adalah tool open-source untuk monitoring dan alerting yang dirancang untuk mengumpulkan, menyimpan, dan menganalisis data layanan dan infrastruktur. Biasanya, Prometheus digunakan bersama Grafana untuk menvisualisasikan data."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Kita akan menggunakan Prometheus bersama Node Exporter."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Node Exporter adalah klien yang akan mengumpulkan dan mengirimkan data "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"system-level"}]},{"type":"text","value":" (penggunaan CPU, RAM, Disk) ke Prometheus."}]},{"type":"element","tag":"h2","props":{"id":"alur-kerja-sistem"},"children":[{"type":"text","value":"Alur Kerja Sistem"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Gambar di bawah menunjukkan alur sistem bekerja:"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/cara-kerja-umum.svg"},"children":[]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pengguna mengirim permintaan ke endpoint yang diekspos oleh Traefik melalui HTTP atau HTTPS."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Traefik berfungsi sebagai load balancer dan meneruskan permintaan ke layanan sesuai giliran, menggunakan metode round robin."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setiap service akan mengirimkan data ke server monitoring."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ketika beban CPU melebihi atau kurang dari ambang batas yang ditentukan, server monitoring akan mengirim perintah ke API IDCloudHost untuk melakukan scale up atau scale down, menggunakan Grafana alert."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"API IDCloudHost kemudian akan melakukan scaling. Jika scale up, service seed akan di-clone untuk membuat service baru. Jika melakukan scale down, VM terakhir yang di-clone akan dihapus."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jika service clone berhasil dibuat (scale up), maka akan terhubung dengan Traefik dan server monitoring. Jika berhasil dihapus (scale down), koneksi antara Traefik dan server monitoring akan diputus."}]}]},{"type":"element","tag":"h2","props":{"id":"penjelasan-lanjut-cara-kerja-scale-up"},"children":[{"type":"text","value":"Penjelasan Lanjut Cara Kerja Scale Up"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/cara-kerja-detail-1.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Saat sistem menerima banyak request, "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"system load"}]},{"type":"text","value":" akan meningkat. Jika ini terjadi, sistem akan gagal untuk memproses beberapa request, sehingga perlu dilakukan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"scale up"}]},{"type":"text","value":" untuk menangani beban tambahan tersebut."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/cara-kerja-detail-2.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Tahapan untuk event scale-up dijelaskan pada gambar kedua:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Banyak "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"request"}]},{"type":"text","value":" yang datang menyebabkan layanan mengalami "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"load"}]},{"type":"text","value":" yang tinggi, yang pada akhirnya menghasilkan kegagalan memproses "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"request"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Prometheus mengumpulkan data penggunaan sistem (CPU dan RAM usage)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Grafana mendeteksi tingkat penggunaan sistem di atas batas yang ditentukan. Sehingga event scale up terjadi dimulai dengan memanggil webhook scale up."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Handler dari webhook scale up akan berinteraksi dengan API IDCloudHost untuk melakukan cloning terhadap service seed."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setelah VM service seed berhasil di-clone, webhook handler akan memperbarui daftar target di server Prometheus di server monitoring untuk menyertakan server yang baru dibuat."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Webhook handler kemudian akan mengirim permintaan ke target updater pada server Traefik untuk memperbarui daftar target load balancer, memasukkan server baru ke dalam daftar target."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Target updater pada server Traefik akan memperbarui daftar IP dan menambahkan alamat IP privat dari service clone yang baru."}]}]},{"type":"element","tag":"info-box","props":{"title":"Tentang Daftar Target","type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bentuk daftar target adalah URL yang menuju ke service clone/seed beserta dengan portnya. Daftar URL ini disimpan pada file konfigurasi Traefik dan Prometheus."}]}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/cara-kerja-detail-3.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Gambar ketiga menunjukkan hasil dari operasi di atas:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Nomor satu menunjukkan service clone hasil dari langkah nomor 4 pada bagian sebelumnya. Semua aspek dari service seed akan di-clone, termasuk service itu sendiri dan konfigurasi Prometheus."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Koneksi telah terbentuk antara "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"service clone"}]},{"type":"text","value":" dengan server monitoring. Ini adalah hasil dari langkah ke-5 dari bagian sebelumnya."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Koneksi antara Traefik dan service baru terbentuk. Ini adalah hasil dari langkah ke-6 dari bagian sebelumnya."}]}]},{"type":"element","tag":"h2","props":{"id":"penjelasan-lanjut-cara-kerja-scale-down"},"children":[{"type":"text","value":"Penjelasan Lanjut Cara Kerja Scale Down"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/cara-kerja-scale-down-1.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ketika "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"request"}]},{"type":"text","value":" lebih rendah, ini akan memicu pemakaian sumber daya komputasional yang sedikit. Jika terdapat dua buah server, akan menjadi tidak efisien secara biaya untuk menjalankan dua buah server yang menangani beban yang bisa ditangani oleh satu server."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut adalah tahapan yang akan dilakukan untuk melakukan scale down:"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/cara-kerja-scale-down-2.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Proses yang terjadi sama dengan event scale up. Hanya saja kita akan melakukan penghapusan terhadap server clone dan menghapus koneksi yang ada di Traefik dan server monitoring."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Gambar di bawah ini adalah hasil dari event scale down:"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/cara-kerja-scale-down-3.png"},"children":[]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Daftar server menyisakan service seed."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Koneksi server clone yang lama ke monitoring server telah dihapus."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Koneksi server clone yang lama ke Traefik telah dihapus."}]}]},{"type":"element","tag":"h2","props":{"id":"menghindari-thrashing"},"children":[{"type":"text","value":"Menghindari Thrashing"}]},{"type":"element","tag":"h3","props":{"id":"menghindari-thrashing-karena-konfigurasi-threshold-yang-tidak-optimal"},"children":[{"type":"text","value":"Menghindari Thrashing Karena Konfigurasi Threshold yang Tidak Optimal"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dalam menentukan ambang batas (threshold) kapan sistem harus melakukan scale-up dan scale-down, kita harus menentukannya dengan cermat. Jika tidak, dapat berisiko terjadi "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"thrashing"}]},{"type":"text","value":". "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Thrashing"}]},{"type":"text","value":" adalah kondisi di mana server terus-menerus melakukan "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"scale-down"}]},{"type":"text","value":" dan "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"scale-up"}]},{"type":"text","value":" secara berulang tanpa henti. Kondisi ini dapat menyebabkan penggunaan sumber daya yang tidak efisien dan membebani sistem, seperti yang dijelaskan pada gambar di bawah."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/thrashing.svg"},"children":[]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Service clone dengan satu VM mengalami beban CPU 70%, yang melebihi ambang batas (threshold) untuk scale-up."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Sistem melakukan scale-up."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"VM baru berhasil di-clone dan terhubung ke load balancer serta server monitoring."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Beban terbagi secara merata antara dua VM, sehingga rata-rata penggunaan CPU turun menjadi 35%, yang berada di bawah ambang batas untuk scale-down."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Sistem kemudian melakukan scale-down."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Beban CPU kembali naik ke 70%, menyebabkan sistem melakukan scale-up lagi. Kejadian ini terus berulang, menciptakan siklus yang disebut thrashing."}]}]},{"type":"element","tag":"info-box","props":{"title":"Solusi","type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Aturan yang bisa diikuti adalah mengatur threshold scale-down setengah lalu dikurang 5 persen dari threshold scale-up. Jika threshold scale-up adalah 80%, maka threshold scale-down adalah 35%."}]}]},{"type":"element","tag":"h3","props":{"id":"menghindari-thrashing-karena-volume-request-yang-fluktuatif"},"children":[{"type":"text","value":"Menghindari Thrashing Karena Volume Request yang Fluktuatif"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Thrashing karena volume request yang fluktuatif disebabkan jika volume request melebihi threshold secara sementara dalam waktu yang singkat, seperti yang dijelaskan pada gambar di bawah:"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/graph-load-fluktuatif.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Perhatikan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"load"}]},{"type":"text","value":" sistem tiga kali berada di bawah 35%."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Jika pengaturan hanya menetapkan scale-down pada 35% tanpa kebijakan tambahan, maka scale-down akan terpicu meskipun beban sistem sebenarnya masih di atas threshold dalam kurun waktu menit. Hal ini dapat menyebabkan scale-down terjadi saat sistem sebenarnya belum membutuhkannya."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk mengatasi masalah tersebut, dapat diterapkan "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"grace period"}]},{"type":"text","value":" sebelum melakukan scale-down. Grace period ini memastikan bahwa sistem hanya melakukan scale-down jika beban tetap berada di bawah threshold selama jangka waktu tertentu, misalnya 5 menit berturut-turut."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Cara lain adalah menggunakan kalkulasi rata-rata beban selama 5 menit terakhir sebagai acuan untuk memicu scale-down, daripada langsung melakukan scale-down saat beban menyentuh threshold."}]},{"type":"element","tag":"info-box","props":{"title":"Solusi","type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk mengatasi thrashing akibat volume yang fluktuatif, kita dapat menerapkan grace period yang menunggu volume request melewati threshold selama kurun waktu tertentu sebelum memicu scaling. Kita juga bisa menggunakan kalkulasi rata-rata sebagai acuan untuk memicu scaling."}]}]},{"type":"element","tag":"h2","props":{"id":"setup-vpc-network"},"children":[{"type":"text","value":"Setup VPC Network"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pembuatan VPC Network pada IDCloudHost cukup simpel."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pergi ke halaman network lalu buatlah network sesuai dengan kebutuhan seperti ini."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/create-network.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lalu pastikan network tersebut merupakan "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"default network"}]},{"type":"text","value":". Jika belum, maka klik tombol \"Set Default\" pada halaman detail network."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/set-default.png"},"children":[]},{"type":"element","tag":"h2","props":{"id":"setup-virtual-machine"},"children":[{"type":"text","value":"Setup Virtual Machine"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Semua Virtual machine dibuat dengan spesifikasi berikut"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"OS: Ubuntu 22.04 lts"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Processor: 2 VCPU"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"RAM: 2048 MB"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Storage: 20 GB"}]}]},{"type":"element","tag":"h2","props":{"id":"implementasi-vm-service"},"children":[{"type":"text","value":"Implementasi VM Service"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/service-highlighted.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"VM Service adalah virtual machine (VM) yang menjalankan aplikasi utama."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"VM Service Seed adalah VM yang akan menjadi bibit yang yang menjadi template untuk VM melakukan clone"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Didalam VM Service terdapat dua buah aplikasi yang berjalan:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Service atau aplikasi itu sendiri"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Prometheus client (Node Exporter): untuk mengumpulkan data sistem (CPU Usage, Memory Usage, dll) dan mengirimkannya ke prometheus yang ada di server monitoring."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada bagian ini kita akan melakukan"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setup Service"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setup Node Exporter"}]}]},{"type":"element","tag":"h3","props":{"id":"aplikasi-yang-akan-dijalankan-sebagai-service"},"children":[{"type":"text","value":"Aplikasi yang akan dijalankan sebagai service"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Service yang akan dijalankan pada Artikel ini adalah endpoint untuk melakukan hashing kriptografi (pbkdf2 dan scrypt)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Service ini menggunakan Node dan express yang memanfaatkan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"worker_threads"}]},{"type":"text","value":" dari Node sehingga endpoint dapat menggunakan semua thread yang ada di VM."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Endpoint ini intensif di komputasional jadi akan memakan banyak sumber daya CPU."}]},{"type":"element","tag":"pre","props":{"code":"const express = require(\"express\");\nconst crypto = require(\"crypto\");\nconst {\n  Worker,\n  isMainThread,\n  parentPort,\n  workerData,\n} = require(\"worker_threads\");\n\nconst app = express();\nconst port = 3000;\n\napp.use(express.json());\n\nconst performCryptoOperationsInWorker = (number) => {\n  return new Promise((resolve, reject) => {\n    const worker = new Worker(__filename, { workerData: number });\n\n    worker.on(\"message\", (result) => resolve(result));\n    worker.on(\"error\", (error) => reject(error));\n  });\n};\n\nif (!isMainThread) {\n  const { number } = workerData;\n\n  const performCryptoOperations = (number) => {\n    const password = \"complex_password\";\n    const salt = `unique_salt_${number}`;\n    const iterations = 1000; // Sepuluh ribu - tingkatkan jika ingin beban komputasional lebih\n    const keyLength = 64;\n\n    const pbkdf2Hash = crypto\n      .pbkdf2Sync(password, salt, iterations, keyLength, \"sha512\")\n      .toString(\"hex\");\n    const scryptHash = crypto\n      .scryptSync(password, salt, keyLength, {\n        N: 2 ** ((number % 14) + 1),\n        r: 8,\n        p: 1,\n      })\n      .toString(\"hex\");\n\n    return { pbkdf2Hash, scryptHash };\n  };\n\n  const result = performCryptoOperations(workerData);\n  parentPort.postMessage(result);\n} else {\n  app.post(\"/calculate\", async (req, res) => {\n    const { number } = req.body;\n\n    if (typeof number !== \"number\" || number <= 0) {\n      return res.status(400).json({ error: \"Input harus bilangan positif\" });\n    }\n\n    try {\n      const result = await performCryptoOperationsInWorker(number);\n      res.json({\n        input: number,\n        ...result,\n      });\n    } catch (error) {\n      res\n        .status(500)\n        .json({ error: \"An error occurred while processing the request\" });\n    }\n  });\n\n  app.listen(port, () => {\n    console.log(`Server running at http://localhost:${port}`);\n  });\n}\n","filename":"index.js","language":"js","meta":"","className":"language-js shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" crypto"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"crypto"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  Worker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  isMainThread"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  parentPort"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  workerData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"worker_threads"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" port"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 3000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"use"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"())"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" performCryptoOperationsInWorker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":" Promise"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"resolve"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" reject"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" worker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" Worker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"__filename"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"workerData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    worker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"on"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"result"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" resolve"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"result"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"))"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    worker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"on"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" reject"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"))"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"isMainThread"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" workerData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" performCryptoOperations"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" password"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"complex_password"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" salt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"unique_salt_"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" iterations"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" // Sepuluh ribu - tingkatkan jika ingin beban komputasional lebih\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" keyLength"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 64"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" pbkdf2Hash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" crypto\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"pbkdf2Sync"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"password"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" salt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" iterations"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" keyLength"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"sha512"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"toString"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"hex"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" scryptHash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" crypto\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"scryptSync"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"password"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" salt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" keyLength"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"        N"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" **"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" (("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" %"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 14"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"        r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 8"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"        p"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"toString"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"hex"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"pbkdf2Hash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" scryptHash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" result"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" performCryptoOperations"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"workerData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  parentPort"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"postMessage"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"result"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" else"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"post"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"/calculate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" !=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ||"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" <="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"400"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Input harus bilangan positif"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"    try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" result"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" performCryptoOperationsInWorker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"      res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"        input"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E;--shiki-default-font-weight:bold"},"children":[{"type":"text","value":"        ..."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"result"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"      res\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"        ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"500"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"        ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"An error occurred while processing the request"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"listen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"port"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" () "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Server running at http://localhost:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"port"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"prometheus-client-node-exporter"},"children":[{"type":"text","value":"Prometheus Client (Node Exporter)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut adalah tahapan untuk menginstall dan mengkonfigurasi Node Exporter:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Lihat halaman ini "},{"type":"element","tag":"a","props":{"href":"https://prometheus.io/download/#node_exporter","rel":["nofollow"]},"children":[{"type":"text","value":"https://prometheus.io/download/#node_exporter"}]},{"type":"text","value":" untuk mengetahui versi terbaru dari Node Exporter"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Instal versi terbaru Node Exporter menggunakan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"wget"}]},{"type":"element","tag":"pre","props":{"code":"wget https://github.com/prometheus/node_exporter/releases/download/v1.8.2/node_exporter-1.8.2.linux-amd64.tar.gz\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"wget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" https://github.com/prometheus/node_exporter/releases/download/v1.8.2/node_exporter-1.8.2.linux-amd64.tar.gz\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Cukup ganti "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"1.8.2"}]},{"type":"text","value":" dengan versi terbaru"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ekstrak aplikasi."},{"type":"element","tag":"pre","props":{"code":"tar xvfz node_exporter-*.tar.gz\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"tar"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" xvfz"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" node_exporter-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":".tar.gz\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pindahkan executable "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"node_exporter"}]},{"type":"text","value":" kedalam folder"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"usr/local/bin"}]},{"type":"text","value":"sehingga bisa diakses seluruh sistem"},{"type":"element","tag":"pre","props":{"code":"sudo mv node_exporter-1.8.2.linux-amd64/node_exporter /usr/local/bin\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" node_exporter-1.8.2.linux-amd64/node_exporter"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /usr/local/bin\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"("},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Opsional"}]},{"type":"text","value":") Hapus sisa file"},{"type":"element","tag":"pre","props":{"code":"rm -r node_exporter-1.8.2.linux-amd64*\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"rm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" node_exporter-1.8.2.linux-amd64"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"*\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jalankan command berikut untuk melihat status instalasi node_exporter"},{"type":"element","tag":"pre","props":{"code":"node_exporter\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"node_exporter\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Node Exporter berhasil diinstal jika muncul pesan seperti ini"},{"type":"element","tag":"pre","props":{"code":"ts=2024-10-22T12:55:16.946Z caller=node_exporter.go:193 level=info msg=\"Starting node_exporter\" version=\"(version=1.8.2, branch=HEAD, revision=f1e0e8360aa60b6cb5e5cc1560bed348fc2c1895)\"\nDan seterusnya ...\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"ts=2024-10-22T12:55:16.946Z caller=node_exporter.go:193 level=info msg=\"Starting node_exporter\" version=\"(version=1.8.2, branch=HEAD, revision=f1e0e8360aa60b6cb5e5cc1560bed348fc2c1895)\"\nDan seterusnya ...\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"menjalankan-node-exporter-sebagai-systemd"},"children":[{"type":"text","value":"Menjalankan Node Exporter sebagai "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"systemd"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Node Exporter telah berhasil diinstal, dan sudah dapat dijalankan. Namun, untuk memastikan Node Exporter otomatis berjalan saat server dinyalakan, Node Exporter perlu dijalankan sebagai "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"system service"}]},{"type":"text","value":". Dengan begitu, ketika server di-clone, Node Exporter akan langsung aktif tanpa perlu dimulai secara manual."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pertama buatlah user untuk node exporter"},{"type":"element","tag":"pre","props":{"code":"sudo useradd -rs /bin/false node_exporter\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" useradd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -rs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /bin/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" node_exporter\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buatlah service file yang akan digunakan oleh "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"systemctl"}]},{"type":"text","value":". File harus bernama"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"node_exporter.service"}]},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/systemd/system/node_exporter.service\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/systemd/system/node_exporter.service\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Isi dari file adalah sebagai berikut:"},{"type":"element","tag":"pre","props":{"code":"[Unit]\nDescription=Node Exporter\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nUser=node_exporter\nGroup=node_exporter\nType=simple\nRestart=on-failure\nRestartSec=5s\nExecStart=/usr/local/bin/node_exporter\n\n[Install]\nWantedBy=multi-user.target\n","filename":"/etc/systemd/system/node_exporter.service","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[Unit]\nDescription=Node Exporter\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nUser=node_exporter\nGroup=node_exporter\nType=simple\nRestart=on-failure\nRestartSec=5s\nExecStart=/usr/local/bin/node_exporter\n\n[Install]\nWantedBy=multi-user.target\n"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Untuk menjalankan Node Exporter secara otomatis ketika server dimulai (boot time), jalankan command "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"systemctl enable"}]},{"type":"element","tag":"pre","props":{"code":"sudo systemctl enable node_exporter\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" enable"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" node_exporter\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Reload "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"systemctl"}]},{"type":"text","value":"daemon, Mulai node_exporter dan cek statusnya"},{"type":"element","tag":"pre","props":{"code":"sudo systemctl daemon-reload\nsudo systemctl start node_exporter\nsudo systemctl status node_exporter\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" daemon-reload\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" start"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" node_exporter\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" node_exporter\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Jika Node Exporter telah aktif maka akan mengeluarkan pesan seperti ini:"},{"type":"element","tag":"pre","props":{"code":"node_exporter.service - Node Exporter\nLoaded: loaded (/etc/systemd/system/node_exporter.service; enabled; vendor preset: enabled)\nActive: active (running) since Tue 2023-04-11 13:48:06 UTC; 4s ago\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"node_exporter.service"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" Node"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" Exporter\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"Loaded:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" loaded"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":" (/etc/systemd/system/node_exporter.service"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" enabled"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" vendor"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" preset:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" enabled"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"Active:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" active"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":" (running) since Tue 2023-04-11 13:48:06 UTC"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" 4s"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" ago\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Cek url "},{"type":"element","tag":"a","props":{"href":"http://localhost:9100/metrics","rel":["nofollow"]},"children":[{"type":"text","value":"http://localhost:9100/metrics"}]},{"type":"text","value":" untuk melihat apakah node exporter sudah berjalan"},{"type":"element","tag":"pre","props":{"code":"curl http://localhost:9100/metrics\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" http://localhost:9100/metrics\n"}]}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"implementasi-server-traefik-api-gateway-dan-load-balancer"},"children":[{"type":"text","value":"Implementasi Server Traefik API Gateway dan Load Balancer"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/traefik-highlighted.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Terdapat dua aplikasi yang berjalan pada server ini yaitu Traefik dan API Target Updater"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Traefik akan digunakan sebagai load balancer dan API target updater adalah endpoint yang akan mengupdate daftar server yang terhubung ke Traefik. API target updater akan digunakan oleh webhook handler pada server monitoring setelah ada server yang berhasil ditambah atau dihapus."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bagian ini akan menjelaskan tentang:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Instalasi dan konfigurasi Traefik"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pembuatan API target updater berupa server Express"}]}]},{"type":"element","tag":"h3","props":{"id":"instalasi-traefik"},"children":[{"type":"text","value":"Instalasi Traefik"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Install Traefik binary"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"cek versi traefik terbaru di "},{"type":"element","tag":"a","props":{"href":"https://github.com/traefik/traefik/releases","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/traefik/traefik/releases"}]},{"type":"element","tag":"pre","props":{"code":" wget https://github.com/traefik/traefik/releases/download/v3.1.4/traefik_v3.1.4_linux_amd64.tar.gz\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" wget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" https://github.com/traefik/traefik/releases/download/v3.1.4/traefik_v3.1.4_linux_amd64.tar.gz\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Ganti v3.1.4 dengan versi terbaru"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ekstrak file Traefik"},{"type":"element","tag":"pre","props":{"code":"tar -zxvf traefik_v3.1.4_linux_amd64.tar.gz\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"tar"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -zxvf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" traefik_v3.1.4_linux_amd64.tar.gz\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pindahkan file bernama 'traefik' ke usr/local/bin"},{"type":"element","tag":"pre","props":{"code":"sudo mv traefik /usr/local/bin\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" traefik"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /usr/local/bin\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Cek status instalasi Traefik"},{"type":"element","tag":"pre","props":{"code":"traefik --help\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"traefik"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" --help\n"}]}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"menulis-file-konfigurasi-untuk-traefik"},"children":[{"type":"text","value":"Menulis File Konfigurasi Untuk Traefik"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada bagian ini kita akan membuat file konfigurasi yang diperlukan untuk menjalankan Traefik"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut cara kerjanya"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/traefik-file.png"},"children":[]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"static.yml"}]},{"type":"text","value":", berisi konfigurasi dasar yaitu entrypoints, dan letak file konfigurasi"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"configs/dynamic.yaml"}]},{"type":"text","value":", berisikan endpoint yang akan diekspos ke publik dan server apa yang menangani endpoint tersebut dan pengaturan lain."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"configs/services.yaml"}]},{"type":"text","value":", beriskan daftar server yang terhubung dengan Traefik."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"File "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"static.yml"}]},{"type":"text","value":" akan digunakan oleh Traefik sebagai file konfigurasi utama. Lalu file ini akan terhubung dengan folder "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"configs"}]},{"type":"text","value":" yang berisikan dua buah file konfigurasi dinamis yaitu "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"dynamic.yaml"}]},{"type":"text","value":" dan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"services.yaml"}]},{"type":"text","value":". Kegunaaan dari setiap file akan dijelaskan pada bagiannya masing-masing."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buat folder configs"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Buatlah folder traefik didalam folder "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc"}]},{"type":"text","value":", folder ini akan menjadi wadah file konfigurasi yang akan digunakan traefik."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"semua file yang berkaitan dengan Traefik akan diletakan disini."}]},{"type":"element","tag":"pre","props":{"code":"sudo mkdir /etc/traefik\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mkdir"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik\n"}]}]}]}]},{"type":"element","tag":"ol","props":{"start":2},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pembuatan File "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/traefik/static.yaml"}]}]}]},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/traefik/static.yaml\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik/static.yaml\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"entryPoints:\n  web:\n    address: \":80\"\n\nproviders:\n  file:\n    directory: /etc/traefik/configs\n    watch: true\n","filename":"/etc/traefik/static.yaml","language":"yaml","meta":"","className":"language-yaml shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"entryPoints"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"  web"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"    address"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":":80"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"providers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"  file"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"    directory"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik/configs\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"    watch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" true\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Diatas adalah konfigurasi minimal yang digunakan untuk menjalankan Traefik dengan file provider.\nKonfigurasi ini mendefinisikan "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"entryPoint"}]},{"type":"text","value":" bernama "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"web"}]},{"type":"text","value":" pada port "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"80"}]},{"type":"text","value":", Karena yagn diekspos adalah port 80 artinya Traefik akan menerima "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"request"}]},{"type":"text","value":" berjenis http."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bagian "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"providers"}]},{"type":"text","value":" menunjukan letak tempat file konfigurasi disimpan.\nOpsi "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"watch: true"}]},{"type":"text","value":" memungkinkan Traefik untuk secara otomatis memantau perubahan pada file konfigurasi di direktori tersebut dan menerapkan pembaruan tanpa memerlukan restart."}]},{"type":"element","tag":"ol","props":{"start":2},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pembuatan File Dynamic config "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/traefik/configs/dynamic.yaml"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Buat folder configs untuk menampung file konfigurasi dinamis yang akan digunakan file konfigurasi."}]},{"type":"element","tag":"pre","props":{"code":"sudo mkdir /etc/traefik/configs\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mkdir"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik/configs\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Buat file konfigurasi "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"dynamic.yaml"}]}]},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/traefik/configs/dynamic.yaml\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik/configs/dynamic.yaml\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Isi dengan kode berikut:"}]},{"type":"element","tag":"pre","props":{"code":"http:\n  routers:\n    calculate:\n      entrypoints:\n        - \"web\"\n      rule: \"Path(`/calculate`)\"\n      service: \"calculate\"\n","language":"yaml","meta":"","className":"language-yaml shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"http"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"  routers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"    calculate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"      entrypoints"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"web"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"      rule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Path(`/calculate`)"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"      service"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"calculate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Kode diatas mendefinisikan sebuah router untuk menangani permintaan HTTP ke path /calculate. Penjelasan singkatnya:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"routers.calculate: Mendefinisikan router bernama calculate."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"entrypoints: Menunjukkan bahwa router ini akan menangani request yang masuk melalui entrypoint web (port 80 untuk HTTP)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"rule dan service: service calculate akan dijalankan ketika user melakukan request ke "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/calculate"}]}]}]},{"type":"element","tag":"ol","props":{"start":3},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pembuatan File Services config "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/traefik/configs/services.yaml"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"File ini mendifinisikan apa itu service "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"calculate"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/traefik/configs/services.yaml\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik/configs/services.yaml\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"http:\n  services:\n    calculate:\n      loadBalancer:\n        servers:\n          - url: \"http://<private-ip-services>:3000/\"\n          - url: \"http://<private-ip-services>:3000/\"\n","language":"yaml","meta":"","className":"language-yaml shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"http"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"  services"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"    calculate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"      loadBalancer"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"        servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"          -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":" url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"http://<private-ip-services>:3000/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"          -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":" url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"http://<private-ip-services>:3000/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"services.calculate"}]},{"type":"text","value":": Mendefinisikan sebuah service bernama "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"calculate"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"loadBalancer"}]},{"type":"text","value":": Menggunakan load balancer untuk mendistribusikan permintaan ke daftar server yang ada di bagian "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"servers"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"servers"}]},{"type":"text","value":": Mendefinisikan daftar url server backend yang akan menerima permintaan."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"url"}]},{"type":"text","value":": Menunjukkan URL milik server service."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Request akan didistribusikan kepada daftar Url dengan metode round robin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"File ini akan diupdate setiap kali event scaling terjadi, untuk itu buka akses "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"read"}]},{"type":"text","value":" dan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"write"}]},{"type":"text","value":" pada file ini sehingga daftar url bisa diupdate secara otomatis oleh sistem."}]},{"type":"element","tag":"pre","props":{"code":"sudo chmod +rw /etc/traefik/configs/services.yaml\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" chmod"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" +rw"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik/configs/services.yaml\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"menjalankan-traefik-dengan-systemd"},"children":[{"type":"text","value":"Menjalankan Traefik dengan systemd"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Aplikasi akan dijalankan dengan systemd untuk memanfaatkan fitur startup otomatis saat reboot."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pertama buatlah user Traefik:"}]},{"type":"element","tag":"pre","props":{"code":"sudo useradd -rs /bin/false traefik\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" useradd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -rs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /bin/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" traefik\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ubah izin file Traefik agar bisa dieksekusi oleh user Traefik."}]},{"type":"element","tag":"pre","props":{"code":"sudo chmod 755 /usr/local/bin/traefik\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" chmod"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 755"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /usr/local/bin/traefik\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikan izin kepada traefik untuk menggunakan ports yang \"privileged\" (80, 443) sebagai non-root user"}]},{"type":"element","tag":"pre","props":{"code":"sudo setcap 'cap_net_bind_service=+ep' /usr/local/bin/traefik\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" setcap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" '"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"cap_net_bind_service=+ep"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /usr/local/bin/traefik\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lalu buat file service:"}]},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/systemd/system/traefik.service\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/systemd/system/traefik.service\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut isinya"}]},{"type":"element","tag":"pre","props":{"code":"[Unit]\nDescription=Traefik\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nExecStart=/usr/local/bin/traefik --configFile=/etc/traefik/static.yaml\nUser=traefik\nGroup=traefik\nRestart=on-failure\nRestartSec=5s\n\n[Install]\nWantedBy=multi-user.target\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[Unit]\nDescription=Traefik\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nExecStart=/usr/local/bin/traefik --configFile=/etc/traefik/static.yaml\nUser=traefik\nGroup=traefik\nRestart=on-failure\nRestartSec=5s\n\n[Install]\nWantedBy=multi-user.target\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enable service traefik sehingga dapat mulai secara otomatis jika vm reboot"}]},{"type":"element","tag":"pre","props":{"code":"sudo systemctl enable traefik\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" enable"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" traefik\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Reload daemon, mulai traefik dan cek status:"}]},{"type":"element","tag":"pre","props":{"code":"sudo systemctl daemon-reload\nsudo systemctl start traefik\nsudo systemctl status traefik\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" daemon-reload\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" start"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" traefik\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" traefik\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"pembuatan-target-updater"},"children":[{"type":"text","value":"Pembuatan Target Updater"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bagian ini akan memberikan arahan cara membuat sebuah server node menggunakan express untuk menangangi event scale down dan event scale up"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Tugas dari sistem ini adalah untuk melakukan update ke file "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/traefik/config/services.yaml"}]},{"type":"text","value":" untuk memperbarui daftar server pada "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"loadBalancer.servers"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h4","props":{"id":"pembuatan-service-express-untuk-menerima-daftar-server-terbaru"},"children":[{"type":"text","value":"Pembuatan service express untuk menerima daftar server terbaru"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Install Node"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Berikut adalah langkah-langkah menginstall Node v20 pada Linux menggunakan nvm diambil dari "},{"type":"element","tag":"a","props":{"href":"https://nodejs.org/en/download/package-manager","rel":["nofollow"]},"children":[{"type":"text","value":"website resmi Node"}]},{"type":"element","tag":"pre","props":{"code":"curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.0/install.sh | bash\n\n##### REFRESH TERMINAL #####\n\nnvm install 20\n\nnode -v\n\nnpm -v\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -o-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.0/install.sh"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" bash\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"##### REFRESH TERMINAL #####\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"nvm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 20\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"node"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -v\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -v\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Inisiasi Folder API"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Buat sebuah folder untuk API yang akan dibuat, pada artikel ini folder tersebut akan diberi nama "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server-list-updater"}]},{"type":"element","tag":"pre","props":{"code":"mkdir server-list-updater\ncd server-list-updater\n\nnpm init -y\nnpm install express\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"mkdir"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" server-list-updater\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":"cd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" server-list-updater\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" init"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -y\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" express\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pembuatan Endpoint\nBuatlah file "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"index.js"}]},{"type":"element","tag":"pre","props":{"code":"touch index.js\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"touch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" index.js\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Lalu tulis kode berikut:"},{"type":"element","tag":"pre","props":{"code":"const express = require(\"express\");\nconst fs = require(\"fs\");\nconst path = require(\"path\");\nconst YAML = require(\"yaml\"); // Library untuk mengonversi objek JavaScript ke format YAML\n\nconst app = express();\nconst PORT = 3000;\nconst servicesFilePath = \"/etc/traefik/configs/services.yaml\";\n\napp.use(express.json());\n\n// Endpoint untuk memperbarui daftar server pada file services.yaml\n// Endpoint menerima parameter berupa array of string yang berisi daftar url services terbaru\napp.post(\"/update-servers\", (req, res) => {\n  const { servers } = req.body;\n\n  // Validasi input: Pastikan 'servers' adalah array yang tidak kosong\n  if (!servers || !Array.isArray(servers) || servers.length === 0) {\n    return res.status(400).json({\n      message:\n        \"Invalid request body. Expected a non-empty array of servers.\",\n    });\n  }\n\n  // Struktur data YAML yang akan ditulis ke file services.yaml\n  // Object ini akan diubah oleh library YAML ke bentuk string yaml\n\n  const servicesYamlContent = {\n    http: {\n      services: {\n        mathCalculate: {\n          loadBalancer: {\n            // mengisi daftar url dengan url terbaru yang didapat dari body\n            servers: servers.map((url) => ({ url })),\n          },\n        },\n      },\n    },\n  };\n\n  try {\n    // mengubah object javascript ke string yaml\n    const yamlString = YAML.stringify(servicesYamlContent);\n    fs.writeFileSync(servicesFilePath, yamlString);\n\n    return res\n      .status(200)\n      .json({ message: \"services.yaml updated successfully\" });\n  } catch (error) {\n    console.error(\"Error writing services.yaml file:\", error);\n    return res.status(500).json({\n      message: \"Failed to update services.yaml\",\n      error: error.message,\n    });\n  }\n});\n\napp.listen(PORT, () => {\n  console.log(`Server is running on port ${PORT}`);\n});\n","language":"js","meta":"","className":"language-js shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" path"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"path"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" YAML"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"yaml"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" // Library untuk mengonversi objek JavaScript ke format YAML\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" PORT"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 3000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" servicesFilePath"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"/etc/traefik/configs/services.yaml"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"use"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"())"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Endpoint untuk memperbarui daftar server pada file services.yaml\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Endpoint menerima parameter berupa array of string yang berisi daftar url services terbaru\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"post"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"/update-servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  // Validasi input: Pastikan 'servers' adalah array yang tidak kosong\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ||"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" !"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"Array"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"isArray"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"||"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"length"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ==="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"400"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"      message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"        \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Invalid request body. Expected a non-empty array of servers."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  // Struktur data YAML yang akan ditulis ke file services.yaml\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  // Object ini akan diubah oleh library YAML ke bentuk string yaml\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" servicesYamlContent"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"    http"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"      services"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"        mathCalculate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"          loadBalancer"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"            // mengisi daftar url dengan url terbaru yang didapat dari body\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"            servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"map"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }))"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"          }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    // mengubah object javascript ke string yaml\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" yamlString"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":" YAML"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"stringify"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"servicesYamlContent"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"writeFileSync"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"servicesFilePath"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" yamlString"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" res\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"services.yaml updated successfully"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Error writing services.yaml file:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"500"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"      message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Failed to update services.yaml"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"      error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"})"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"listen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"PORT"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Server is running on port "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"PORT"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"})"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"menjalankan-api-target-updater-dengan-pm2"},"children":[{"type":"text","value":"Menjalankan API Target Updater Dengan PM2"}]},{"type":"element","tag":"info-box","props":{"title":"PM2","type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"PM2 adalah process manager untuk aplikasi Node.js yang berfungsi mengelola, memonitor, dan menjalankan aplikasi secara otomatis dalam lingkungan produksi."}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Install PM2:"},{"type":"element","tag":"pre","props":{"code":"npm install pm2 -g\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" pm2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -g\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jalankan aplikasi server target udpater"},{"type":"element","tag":"pre","props":{"code":"pm2 start index.js --name server-list-updater\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"pm2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" start"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" index.js"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" --name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" server-list-updater\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setelah menjalankan index.js, simpan daftar service yang akan dijalankan saat server reboot:"},{"type":"element","tag":"pre","props":{"code":"pm2 save\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"pm2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" save\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jalankan perintah "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pm2 startup"}]},{"type":"text","value":" dan copy/paste command yang diberikan"},{"type":"element","tag":"pre","props":{"code":"pm2 startup\n  [PM2] Init System found: systemd\n  [PM2] To setup the Startup Script, copy/paste the following command:\n  sudo env PATH=$PATH:/home/falestio/.nvm/versions/node/v20.18.0/bin /home/falestio/.nvm/versions/node/v20.18.0/lib/node_modules/pm2/bin/pm2 startup systemd -u falestio --hp /home/falestio\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"pm2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" startup\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"  ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":"PM2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" Init"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" System"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" found:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemd\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"  ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":"PM2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" To"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" setup"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" the"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" Startup"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" Script,"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" copy/paste"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" the"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" following"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" command:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" env"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" PATH="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"$PATH"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":":/home/falestio/.nvm/versions/node/v20.18.0/bin"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /home/falestio/.nvm/versions/node/v20.18.0/lib/node_modules/pm2/bin/pm2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" startup"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -u"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" falestio"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" --hp"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /home/falestio\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Jalankan perintah yang diberikan"},{"type":"element","tag":"pre","props":{"code":"sudo env PATH=$PATH:/home/falestio/.nvm/versions/node/v20.18.0/bin /home/falestio/.nvm/versions/node/v20.18.0/lib/node_modules/pm2/bin/pm2 startup systemd -u falestio --hp /home/falestio\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" env"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" PATH="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"$PATH"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":":/home/falestio/.nvm/versions/node/v20.18.0/bin"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /home/falestio/.nvm/versions/node/v20.18.0/lib/node_modules/pm2/bin/pm2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" startup"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -u"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" falestio"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" --hp"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /home/falestio\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Sekarang service "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server-list-updater"}]},{"type":"text","value":" akan tetap berjalan meskipun server di reboot."}]}]},{"type":"element","tag":"h4","props":{"id":"tes-fungsi-api"},"children":[{"type":"text","value":"Tes Fungsi API"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jalankan command curl berikut"},{"type":"element","tag":"pre","props":{"code":"curl -X POST http://localhost:3000/update-servers \\\n-H \"Content-Type: application/json\" \\\n-d '{\n  \"servers\": [\n    \"http://192.168.1.101:8080\",\n    \"http://192.168.1.102:8080\"\n  ]\n}'\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -X"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" POST"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" http://localhost:3000/update-servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":"-H "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Content-Type: application/json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":"-d "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"  \"servers\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"    \"http://192.168.1.101:8080\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"    \"http://192.168.1.102:8080\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"  ]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"'\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Cek apakah daftar url sudah berubah"},{"type":"element","tag":"pre","props":{"code":"cat /etc/traefik/configs/services.yaml\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"cat"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/traefik/configs/services.yaml\n"}]}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"implementasi-server-monitoring"},"children":[{"type":"text","value":"Implementasi Server Monitoring"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/monitoring-highlighted.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Server ini akan menjalankan Grafana dan Prometheus seabgai tools untuk mengumpulkan data dari server service, menvisualisasikan data tersebut, dan menginisiasi scaling ketika load sistem telah melewati batas yang ditentukan."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bagian ini akan menjelaskan tentang:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Instalasi dan Konfigurasi Prometheus"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Instalasi dan Konfigurasi Grafana"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Menghubungkan Prometheus dan Grafana"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setup Dashboard Grafana"}]}]},{"type":"element","tag":"info-box","props":{"title":"Sumber","type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Panduan instalasi Prometheus dan Grafana pada artikel ini didapat dari: "},{"type":"element","tag":"a","props":{"href":"https://www.linode.com/docs/guides/how-to-install-prometheus-and-grafana-on-ubuntu/#how-to-configure-prometheus-as-a-service","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.linode.com/docs/guides/how-to-install-prometheus-and-grafana-on-ubuntu/#how-to-configure-prometheus-as-a-service"}]}]}]},{"type":"element","tag":"h3","props":{"id":"download-dan-install-prometheus"},"children":[{"type":"text","value":"Download dan install prometheus"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk menginstall Prometheus, ikuti langkah-langkah berikut."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Cek link berikut untuk mengetahui versi terbaru dari prometheus "},{"type":"element","tag":"a","props":{"href":"https://github.com/prometheus/prometheus/releases","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/prometheus/prometheus/releases"}]},{"type":"element","tag":"pre","props":{"code":"wget https://github.com/prometheus/prometheus/releases/download/v2.55.0/prometheus-2.55.0.linux-amd64.tar.gz\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"wget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" https://github.com/prometheus/prometheus/releases/download/v2.55.0/prometheus-2.55.0.linux-amd64.tar.gz\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Ganti v2.55.0 dengan versi terbaru."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ekstrak file Prometheus"},{"type":"element","tag":"pre","props":{"code":"tar xvfz prometheus-*.tar.gz\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"tar"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" xvfz"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":".tar.gz\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"(Opsional) Setelah file diekstrak, hapus arsip atau pindahkan ke lokasi lain untuk penyimpanan."},{"type":"element","tag":"pre","props":{"code":"rm prometheus-*.tar.gz\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"rm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":".tar.gz\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buat dua direktori baru yang akan digunakan oleh Prometheus. Direktori "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/prometheus"}]},{"type":"text","value":" menyimpan file konfigurasi Prometheus. Direktori "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/var/lib/prometheus"}]},{"type":"text","value":" menyimpan data aplikasi."},{"type":"element","tag":"pre","props":{"code":"sudo mkdir /etc/prometheus /var/lib/prometheus\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mkdir"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/prometheus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /var/lib/prometheus\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Masuk ke folder prometheus yang baru diekstrak."},{"type":"element","tag":"pre","props":{"code":"cd prometheus-2.55.0.linux-amd64\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":"cd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus-2.55.0.linux-amd64\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pindahkan direktori "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"prometheus"}]},{"type":"text","value":" dan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"promtool"}]},{"type":"text","value":" ke direktori "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/usr/local/bin/"}]},{"type":"text","value":". Ini membuat Prometheus dapat diakses oleh semua pengguna."},{"type":"element","tag":"pre","props":{"code":"sudo mv prometheus promtool /usr/local/bin/\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" promtool"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /usr/local/bin/\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pindahkan file konfigurasi YAML "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"prometheus.yml"}]},{"type":"text","value":" ke direktori "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/prometheus"}]},{"type":"text","value":"."},{"type":"element","tag":"pre","props":{"code":"sudo mv prometheus.yml /etc/prometheus/prometheus.yml\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus.yml"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/prometheus/prometheus.yml\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"pindahkan juga folder "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"consoles"}]},{"type":"text","value":" dan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"console_libraries"}]},{"type":"text","value":". fodler tersebut tidak dibahas dalam artikel ini. Namun, file-file ini juga harus dipindahkan ke direktori "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/prometheus"}]},{"type":"text","value":" jika suatu saat diperlukan."},{"type":"element","tag":"pre","props":{"code":"sudo mv consoles/ console_libraries/ /etc/prometheus/\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" consoles/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" console_libraries/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/prometheus/\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Setelah direktori ini dipindahkan, hanya file "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"LICENSE"}]},{"type":"text","value":" dan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"NOTICE"}]},{"type":"text","value":" yang tersisa di direktori asli."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Verifikasi bahwa Prometheus berhasil diinstal dengan menggunakan perintah berikut:"},{"type":"element","tag":"pre","props":{"code":"prometheus --version\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"prometheus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" --version\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Contoh output:"},{"type":"element","tag":"pre","props":{"code":"prometheus, version 2.55.0 (branch: HEAD, revision: 9sda30252c3e528722890348das8dasdd720f6be07cb8)\n  build user:       root@9fad779131cc\n  build date:       20241022-13:47:22\n  go version:       go1.23.2\n  platform:         linux/amd64\n  tags:             netgo,builtinassets,stringlabels\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"prometheus,"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" version"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 2.55.0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":" (branch: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"HEAD,"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" revision:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" 9sda30252c3e528722890348das8dasdd720f6be07cb8"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A9B1D6"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  build"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" user:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"       root@9fad779131cc\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  build"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" date:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"       20241022-13:47:22\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  go"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" version:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"       go1.23.2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  platform:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"         linux/amd64\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"  tags:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"             netgo,builtinassets,stringlabels\n"}]}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"menjalankan-prometheus-sebagai-systemd"},"children":[{"type":"text","value":"Menjalankan Prometheus Sebagai Systemd"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Meskipun Prometheus bisa dijalankan dan dihentikan langsung dari command line, lebih praktis kalau dijalankan sebagai service menggunakan systemd."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buat user untuk Prometheus. Perintah berikut akan membuat user sistem:"},{"type":"element","tag":"pre","props":{"code":"sudo useradd -rs /bin/false prometheus\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" useradd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -rs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /bin/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ubah kepemilikan dua direktori yang sudah dibuat sebelumnya ke user "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"prometheus"}]},{"type":"text","value":" yang baru."},{"type":"element","tag":"pre","props":{"code":"sudo chown -R prometheus: /etc/prometheus /var/lib/prometheus\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" chown"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -R"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/prometheus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /var/lib/prometheus\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Untuk menjalankan Prometheus sebagai service, buat file "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"prometheus.service"}]},{"type":"text","value":" dengan perintah ini:"},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/systemd/system/prometheus.service\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/systemd/system/prometheus.service\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Lalu masukan kode berikut:"},{"type":"element","tag":"pre","props":{"code":"[Unit]\nDescription=Prometheus\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nUser=prometheus\nGroup=prometheus\nType=simple\nRestart=on-failure\nRestartSec=5s\nExecStart=/usr/local/bin/prometheus \\\n    --config.file /etc/prometheus/prometheus.yml \\\n    --storage.tsdb.path /var/lib/prometheus/ \\\n    --web.console.templates=/etc/prometheus/consoles \\\n    --web.console.libraries=/etc/prometheus/console_libraries \\\n    --web.listen-address=0.0.0.0:9090 \\\n    --web.enable-lifecycle \\\n    --log.level=info\n\n[Install]\nWantedBy=multi-user.target\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[Unit]\nDescription=Prometheus\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nUser=prometheus\nGroup=prometheus\nType=simple\nRestart=on-failure\nRestartSec=5s\nExecStart=/usr/local/bin/prometheus \\\n    --config.file /etc/prometheus/prometheus.yml \\\n    --storage.tsdb.path /var/lib/prometheus/ \\\n    --web.console.templates=/etc/prometheus/consoles \\\n    --web.console.libraries=/etc/prometheus/console_libraries \\\n    --web.listen-address=0.0.0.0:9090 \\\n    --web.enable-lifecycle \\\n    --log.level=info\n\n[Install]\nWantedBy=multi-user.target\n"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setelah itu, reload daemon:"},{"type":"element","tag":"pre","props":{"code":"sudo systemctl daemon-reload\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" daemon-reload\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Gunakan perintah "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"systemctl enable"}]},{"type":"text","value":" agar Prometheus otomatis mulai saat sistem di-boot."},{"type":"element","tag":"pre","props":{"code":"sudo systemctl enable prometheus\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" enable"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jalankan service Prometheus dan cek statusnya untuk memastikan sudah aktif."},{"type":"element","tag":"pre","props":{"code":"sudo systemctl start prometheus\nsudo systemctl status prometheus\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" start"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Akses interface web dan dashboard Prometheus di "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://local_ip_addr:9090"}]},{"type":"text","value":". Ganti "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"local_ip_addr"}]},{"type":"text","value":" dengan alamat IP server monitoring. Karena menggunakan file konfigurasi default, informasi yang ditampilkan masih terbatas."}]}]},{"type":"element","tag":"h3","props":{"id":"edit-file-konfigurasi"},"children":[{"type":"text","value":"Edit file Konfigurasi"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Edit file konfigurasi prometheus"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Pada server monitoring yang menjalankan Prometheus, buka file "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"prometheus.yml"}]},{"type":"text","value":" untuk diedit."},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/prometheus/prometheus.yml\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/prometheus/prometheus.yml\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"isi dengan kode berikut:"},{"type":"element","tag":"pre","props":{"code":"global:\n  scrape_interval: 5s\n\nscrape_configs:\n  - job_name: \"calculate_service_clones\"\n    file_sd_configs:\n      - files:\n          - \"targets.json\"\n\n  - job_name: \"calculate_service_seed\"\n    static_configs:\n      - targets: [\"<private_ip>:9100\"]\n","language":"yaml","meta":"","className":"language-yaml shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"global"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"  scrape_interval"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" 5s\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"scrape_configs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":" job_name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"calculate_service_clones"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"    file_sd_configs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":" files"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"          -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"targets.json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":" job_name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"calculate_service_seed"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":"    static_configs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F7768E"},"children":[{"type":"text","value":" targets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"<private_ip>:9100"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"]\n"}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"scrape_interval"}]},{"type":"text","value":": Interval waktu (5 detik) untuk Prometheus mengambil data dari target."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"job_name: \"calculate_service_clones\""}]},{"type":"text","value":": ini adalah job untuk mengumpulkan data sistem dari server clone. Daftar server yang akan di clone berada pada file targets.json. ini dilakukan karena daftar server bersifat dinamis (selalu berubah)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"job_name: \"calculate_service_seed\""}]},{"type":"text","value":": mengarah ke service seed, service seed akan selalu ada jadi menggunakan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"static_configs"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buatlah file targets.json"},{"type":"element","tag":"pre","props":{"code":"sudo nano /etc/prometheus/targets.json\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" nano"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/prometheus/targets.json\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Lalu cukup isi file dengan array kosong "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"[]"}]},{"type":"text","value":"."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"File ini akan diupdate oleh prometheus target updater, untuk permissions dari file perlu di modifikasi sehingga target updater (express) dapat melakukan perubahan kepada file."},{"type":"element","tag":"pre","props":{"code":"sudo chmod -R a+rwx /etc/prometheus/targets.json\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" chmod"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -R"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" a+rwx"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/prometheus/targets.json\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Restart Prometheus dan cek kembali "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://local_ip_addr:9090"}]},{"type":"element","tag":"pre","props":{"code":"sudo systemctl restart prometheus\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" restart"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" prometheus\n"}]}]}]}]}]}]},{"type":"element","tag":"info-box","props":{"title":"Memonitor API gateway","type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Anda bisa mengimplementasikan monitoring terhadap server api gateway jika diperlukan, namun agar sistem autoscaling berjalan anda tidak perlu melakukan itu"}]}]},{"type":"element","tag":"h3","props":{"id":"pembuatan-webhook-handler"},"children":[{"type":"text","value":"Pembuatan Webhook Handler"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Webhook handler adalah endpoint yang akan dipanggil oleh Grafana Alert ketika salah satu proses scaling terjadi. Sistem ini akan berinteraksi dengan IDCloudHost API untuk melakukan clone pada server seed dan mengupdate daftar target di Server Traefik dan Server monitoring."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Webhook hanler berbentuk server Node dengan menggunakan library Express."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/webhook-handler-highlighted.png"},"children":[]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buat API Token untuk mengakses IDCloudHost API:"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Pergi ke halaman access lalu klik tombol \"Create New Access\"."},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/create-new-access.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Pilih tipe \"API Token\", sesuaikan scope, billing account, dan access name."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Simpan API Token untuk digunakan membuat webhook handler."},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/api-token.png"},"children":[]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buat folder webhook handler dan inisiasi proyek node"},{"type":"element","tag":"pre","props":{"code":"sudo mkdir webhook-handler\nnpm init -y\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" mkdir"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" webhook-handler\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" init"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -y\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Install library yang diperlukan"},{"type":"element","tag":"pre","props":{"code":"npm install express axios\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" axios\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Isi index.js dengan kode berikut"},{"type":"element","tag":"pre","props":{"code":"const express = require(\"express\");\nconst axios = require(\"axios\");\nconst { exec } = require(\"child_process\");\nconst app = express();\nconst fs = require(\"fs\");\n\n// ========= SESUAIKAN BAGIAN INI - GUNAKAN ENV ATAU SECRET MANAGER LAIN =========\n// API Token yang dibuat pada bagian ini\nconst apiKey = \"IBlVjA6KTfJlH5nYO79mAQBwYCxGhv71\";\n\n// UUID dari private network yang dibuat pada awal artikel\nconst privateNetworkUuid = \"b34ec3de-76ef-4720-8737-7662f52f6f89\";\n\n// UUID dari service seed\nconst serviceSeedUuid = \"a0c79e13-6eda-4e68-a64c-91637589ec55\";\n\n// pergi ke halaman billing dna klik pada detail salah satu billing account\nconst billingAccountId = \"1200211740\";\n\n// nama pertama dari service clone, dingunakan untuk menetukan nama server dari service clone\n// yaitu: calculate-service-clone-{nomorurut}\nconst serviceChildFirstName = \"calculate-service-clone-\";\n\n// file path ke file targets.json yang berisi daftar server yang terhubung ke server monitoring\nconst prometheusTargetsFilePath = \"/etc/prometheus/targets.json\";\n\n// Url dari target updater yang ada di server Traefik\nconst updateTraefikTargetsUrl = \"http://10.52.76.11:3000/update-servers\";\n\n// Port dimana aplikasi service dijalankan di server service\nconst servicePort = 3000;\n// =====================================================================\n\napp.use(express.json());\n\n// Fetching data semua VM service\nconst getServiceVmsData = async (filterPrefix = \"calculate-service-\") => {\n  try {\n    const { data } = await axios.get(\n      \"https://api.idcloudhost.com/v1/jkt01/user-resource/vm/list\",\n      { headers: { apikey: apiKey } }\n    );\n    return data.filter((vm) => vm.name.startsWith(filterPrefix));\n  } catch (error) {\n    console.error(\"Error fetching VM data:\", error.message);\n    throw error;\n  }\n};\n\n// clone terhadap service seed server\nconst cloneVM = async (name) => {\n  const { data } = await axios.post(\n    `https://api.idcloudhost.com/v1/jkt01/user-resource/vm/clone?uuid=${serviceSeedUuid}&name=${name}`,\n    {},\n    { headers: { apikey: apiKey } }\n  );\n  return data;\n};\n\n// hapus public ip dari VM yang baru di Clone\nconst deletePublicIp = async (vmUuid) => {\n  const { data } = await axios.get(\n    `https://api.idcloudhost.com/v1/jkt01/network/ip_addresses?billing_account_id=${billingAccountId}`,\n    { headers: { apikey: apiKey } }\n  );\n  const ip = data.find((ip) => ip.assigned_to === vmUuid);\n  if (ip) {\n    await axios.delete(\n      `https://api.idcloudhost.com/v1/jkt01/network/ip_addresses/${ip.address}`,\n      { headers: { apikey: apiKey } }\n    );\n  }\n};\n\n// update daftar target pada server service dan prometheus\nconst updateTargets = async (type, data) => {\n  if (type === \"prometheus\") {\n    const prometheusTargets = [\n      {\n        labels: {\n          job: \"calculate_service_clone\",\n        },\n        targets: data.map((ip) => `${ip}:9100`),\n      },\n    ];\n\n    try {\n      fs.writeFileSync(\n        prometheusTargetsFilePath,\n        JSON.stringify(prometheusTargets, null, 2)\n      );\n      console.log(\"Prometheus targets updated\");\n    } catch (err) {\n      console.error(\"Error updating Prometheus targets:\", err.message);\n      throw err;\n    }\n  } else if (type === \"traefik\") {\n    try {\n      const servers = data.map((ip) => `http://${ip}:${servicePort}`);\n      const response = await axios.post(\n        updateTraefikTargetsUrl,\n        { servers },\n        { headers: { \"Content-Type\": \"application/json\" } }\n      );\n      console.log(\"Traefik targets updated:\", response.data);\n    } catch (error) {\n      console.error(\"Error updating Traefik targets:\", error.message);\n      throw error;\n    }\n  }\n};\n\nconst scaleUpHandler = async (req, res) => {\n  try {\n    const serviceVms = await getServiceVmsData();\n    const newVmData = await cloneVM(\n      `${serviceChildFirstName}${serviceVms.length}`\n    );\n    await deletePublicIp(newVmData.uuid);\n\n    const updatedVms = await getServiceVmsData(serviceChildFirstName);\n    const privateIps = updatedVms.map((vm) => vm.private_ipv4);\n\n    await updateTargets(\"prometheus\", privateIps);\n    await updateTargets(\"traefik\", privateIps);\n\n    res.send({ newVmData });\n  } catch (error) {\n    res.status(500).send({ error: error.message });\n  }\n};\n\nconst scaleDownHandler = async (req, res) => {\n  try {\n    const vmList = await getServiceVmsData(serviceChildFirstName);\n    if (!vmList.length)\n      return res.send({ message: \"No child VM, scale down aborted\" });\n\n    const vmToDelete = vmList.sort(\n      (a, b) => new Date(b.created_at) - new Date(a.created_at)\n    )[0];\n\n    await axios.delete(\n      `https://api.idcloudhost.com/v1/jkt01/user-resource/vm?uuid=${vmToDelete.uuid}`,\n      { headers: { apikey: apiKey } }\n    );\n\n    const updatedVms = await getServiceVmsData(serviceChildFirstName);\n    const privateIps = updatedVms.map((vm) => vm.private_ipv4);\n\n    await updateTargets(\"prometheus\", privateIps);\n    await updateTargets(\"traefik\", privateIps);\n\n    res.send({ message: \"VM Deleted\", vmDeleted: vmToDelete });\n  } catch (error) {\n    res.status(500).send({ error: error.message });\n  }\n};\n\napp.post(\"/v1/scale-up\", scaleUpHandler);\napp.post(\"/v1/scale-down\", scaleDownHandler);\n\nconst PORT = 4000;\napp.listen(PORT, () => console.log(`Server running on port ${PORT}`));\n","filename":"prometheus-target-updater/index.js","language":"js","meta":"","className":"language-js shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" exec"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"child_process"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" require"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// ========= SESUAIKAN BAGIAN INI - GUNAKAN ENV ATAU SECRET MANAGER LAIN =========\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// API Token yang dibuat pada bagian ini\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" apiKey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"IBlVjA6KTfJlH5nYO79mAQBwYCxGhv71"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// UUID dari private network yang dibuat pada awal artikel\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" privateNetworkUuid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"b34ec3de-76ef-4720-8737-7662f52f6f89"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// UUID dari service seed\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" serviceSeedUuid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"a0c79e13-6eda-4e68-a64c-91637589ec55"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// pergi ke halaman billing dna klik pada detail salah satu billing account\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" billingAccountId"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"1200211740"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// nama pertama dari service clone, dingunakan untuk menetukan nama server dari service clone\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// yaitu: calculate-service-clone-{nomorurut}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" serviceChildFirstName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"calculate-service-clone-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// file path ke file targets.json yang berisi daftar server yang terhubung ke server monitoring\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" prometheusTargetsFilePath"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"/etc/prometheus/targets.json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Url dari target updater yang ada di server Traefik\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" updateTraefikTargetsUrl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"http://10.52.76.11:3000/update-servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Port dimana aplikasi service dijalankan di server service\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" servicePort"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 3000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// =====================================================================\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"use"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"express"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"())"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Fetching data semua VM service\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" getServiceVmsData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"filterPrefix"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"calculate-service-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"https://api.idcloudhost.com/v1/jkt01/user-resource/vm/list"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"apikey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" apiKey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" } }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"filter"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"vm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" vm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"startsWith"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"filterPrefix"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"))"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Error fetching VM data:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"    throw"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// clone terhadap service seed server\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" cloneVM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"post"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"    `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"https://api.idcloudhost.com/v1/jkt01/user-resource/vm/clone?uuid="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"serviceSeedUuid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"&name="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    {}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"apikey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" apiKey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" } }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// hapus public ip dari VM yang baru di Clone\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" deletePublicIp"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"vmUuid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"    `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"https://api.idcloudhost.com/v1/jkt01/network/ip_addresses?billing_account_id="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"billingAccountId"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"apikey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" apiKey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" } }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"find"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"assigned_to"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ==="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" vmUuid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"delete"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"https://api.idcloudhost.com/v1/jkt01/network/ip_addresses/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"address"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"apikey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" apiKey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" } }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// update daftar target pada server service dan prometheus\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" updateTargets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"type"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"type"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ==="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"prometheus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" prometheusTargets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"        labels"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":81},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"          job"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"calculate_service_clone"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":82},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":83},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"        targets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"map"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":":9100"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":84},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":85},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    ]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":86},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":87},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"    try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":88},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"      fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"writeFileSync"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":89},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"        prometheusTargetsFilePath"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":90},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":"        JSON"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"stringify"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"prometheusTargets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" null"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":91},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":92},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"      console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Prometheus targets updated"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":93},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"err"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":94},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"      console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Error updating Prometheus targets:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" err"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":95},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"      throw"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" err"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":96},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":97},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"else"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"type"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ==="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"traefik"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":98},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"    try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":99},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"map"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"http://"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"ip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"servicePort"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":100},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" response"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"post"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":101},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"        updateTraefikTargetsUrl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":102},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"servers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":103},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Content-Type"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"application/json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" } }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":104},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":105},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"      console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Traefik targets updated:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" response"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":106},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":107},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"      console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Error updating Traefik targets:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":108},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"      throw"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":109},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":110},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":111},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":112},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":113},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" scaleUpHandler"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":114},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":115},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" serviceVms"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" getServiceVmsData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":116},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" newVmData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" cloneVM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":117},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"serviceChildFirstName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"serviceVms"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"length"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":118},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":119},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" deletePublicIp"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"newVmData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"uuid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":120},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":121},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" updatedVms"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" getServiceVmsData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"serviceChildFirstName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":122},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" privateIps"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" updatedVms"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"map"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"vm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" vm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"private_ipv4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":123},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":124},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" updateTargets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"prometheus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" privateIps"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":125},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" updateTargets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"traefik"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" privateIps"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":126},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":127},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"send"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"newVmData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":128},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":129},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"500"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"send"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":130},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":131},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":132},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":133},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" scaleDownHandler"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"req"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":134},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"  try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":135},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" vmList"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" getServiceVmsData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"serviceChildFirstName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":136},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"vmList"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"length"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":137},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"send"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"No child VM, scale down aborted"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":138},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":139},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" vmToDelete"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" vmList"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"sort"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":140},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"a"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" b"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" Date"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"b"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"created_at"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" Date"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"a"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"created_at"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":141},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    )["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":142},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":143},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" axios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"delete"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":144},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"      `"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"https://api.idcloudhost.com/v1/jkt01/user-resource/vm?uuid="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"vmToDelete"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"uuid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":145},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"apikey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" apiKey"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" } }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":146},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    )"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":147},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":148},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" updatedVms"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" getServiceVmsData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"serviceChildFirstName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":149},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" privateIps"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" updatedVms"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"map"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"vm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" vm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"private_ipv4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":150},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":151},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" updateTargets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"prometheus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" privateIps"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":152},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"    await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" updateTargets"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"traefik"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" privateIps"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":153},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":154},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"send"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"VM Deleted"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":" vmDeleted"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" vmToDelete"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":155},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":156},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"    res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"500"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"send"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" error"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"message"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":157},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":158},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":159},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":160},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"post"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"/v1/scale-up"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" scaleUpHandler"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":161},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"post"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"/v1/scale-down"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" scaleDownHandler"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":162},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":163},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" PORT"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 4000"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":164},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"listen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"PORT"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Server running on port "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":"PORT"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"))"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Jalankan Webhook handler menggunakan PM2, Panduan bisa dilihat diatas."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Test endpoint webhook handler"},{"type":"element","tag":"pre","props":{"code":"curl -X POST http://localhost:4000/v1/scale-up\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -X"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" POST"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" http://localhost:4000/v1/scale-up\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"curl -X POST http://localhost:4000/v1/scale-down\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -X"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" POST"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" http://localhost:4000/v1/scale-down\n"}]}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"install-grafana"},"children":[{"type":"text","value":"Install Grafana"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sekarang Prometheus mengumpulkan statistik dari klien yang terdaftar di bagian "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"scrape_configs"}]},{"type":"text","value":" pada file konfigurasinya. Namun, informasi tersebut hanya dapat dilihat dalam bentuk data mentah yang sulit dibaca dan kurang berguna."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Grafana menyediakan antarmuka untuk melihat statistik yang dikumpulkan oleh Prometheus. Grafana juga akan digunakan sebagai"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Instal beberapa utilitas yang dibutuhkan menggunakan apt."},{"type":"element","tag":"pre","props":{"code":"sudo apt-get install -y apt-transport-https software-properties-common\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" apt-get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -y"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" apt-transport-https"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" software-properties-common\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Impor kunci GPG Grafana."},{"type":"element","tag":"pre","props":{"code":"sudo wget -q -O /usr/share/keyrings/grafana.key https://apt.grafana.com/gpg.key\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" wget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -q"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -O"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /usr/share/keyrings/grafana.key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" https://apt.grafana.com/gpg.key\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Tambahkan repository \"stable releases\" Grafana."},{"type":"element","tag":"pre","props":{"code":"echo \"deb [signed-by=/usr/share/keyrings/grafana.key] https://apt.grafana.com stable main\" | sudo tee -a /etc/apt/sources.list.d/grafana.list\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"deb [signed-by=/usr/share/keyrings/grafana.key] https://apt.grafana.com stable main"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" tee"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":" -a"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" /etc/apt/sources.list.d/grafana.list\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Update paket, termasuk paket Grafana yang baru."},{"type":"element","tag":"pre","props":{"code":"sudo apt-get update\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" apt-get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" update\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Install versi open-source dari Grafana."},{"type":"element","tag":"pre","props":{"code":"sudo apt-get install grafana\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" apt-get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" grafana\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Muat ulang daemon systemctl."},{"type":"element","tag":"pre","props":{"code":"sudo systemctl daemon-reload\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" daemon-reload\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Aktifkan dan mulai server Grafana. Menggunakan "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"systemctl enable"}]},{"type":"text","value":"."},{"type":"element","tag":"pre","props":{"code":"sudo systemctl enable grafana-server.service\nsudo systemctl start grafana-server\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" enable"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" grafana-server.service\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" start"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" grafana-server\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Periksa status server Grafana."},{"type":"element","tag":"pre","props":{"code":"sudo systemctl status grafana-server\n","filename":"bash","language":"bash","meta":"","className":"language-bash shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" systemctl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":" grafana-server\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"grafana-server.service - Grafana instance\nLoaded: loaded (/lib/systemd/system/grafana-server.service; enabled; vendor preset: enabled)\nActive: active (running) since Tue 2023-04-11 17:31:53 UTC; 9s ago\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"grafana-server.service - Grafana instance\nLoaded: loaded (/lib/systemd/system/grafana-server.service; enabled; vendor preset: enabled)\nActive: active (running) since Tue 2023-04-11 17:31:53 UTC; 9s ago\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"menambahkan-prometheus-sebagai-sumber-data"},"children":[{"type":"text","value":"Menambahkan Prometheus Sebagai Sumber Data"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Semua komponen sistem sekarang sudah terinstal, tetapi Grafana dan Prometheus belum diatur untuk berinteraksi. Untuk menambahkan Prometheus sebagai sumber data dan konfigurasi lainnya, dapat dilakukan menggunakan antarmuka web Grafana."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk mengintegrasikan Grafana dan Prometheus, ikuti langkah-langkah di bawah ini:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Login ke grafana"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Dengan menggunakan browser, pergi ke halaman http://"},{"type":"element","tag":"public-up-server-monitoring","props":{},"children":[{"type":"text","value":":3000"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Login ke grafana menggunakan default password dan username yaitu"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Username: admin\nPassword: admin"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Setelah itu Grafana akan meminta kita untuk mengubah kata sandi. Setelah berhasil mengubah kata sandi, Grafana akan menampilkan "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Grafana Dashboard"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Tambah Prometheus sebagai sumber data"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Pada menu connection pergi ke halaman data source lalu klik add data source"},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/add-data-source.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Pilih "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Prometheus"}]},{"type":"text","value":" sebagai data source."},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/pilih-prometheus.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Karena server prometheus sudah berjalan pada server yang sama, isi bagian connection dengan url "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost:9090"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/pilih-prometheus.png"},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Pengaturan lainnya bisa ditinggalkan menggunakan yang default"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Klik \"Save & test\", Jika berhasil Prometheus akan mengeluarkan pesan sukses"},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/pesan-sukses-prometheus.png"},"children":[]}]}]},{"type":"element","tag":"h3","props":{"id":"cara-mengimpor-dashboard-grafana"},"children":[{"type":"text","value":"Cara Mengimpor Dashboard Grafana"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dashboard menampilkan statistik dari data source menggunakan diagram, grafik, dengan tata letak yang efisien dan mudah dipahami. Anda bisa membuat dashboard kustom, tetapi Prometheus telah menyediakan dashboard yang mendukung data dari "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Node Exporter"}]},{"type":"text","value":". Dashboard "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Node Exporter Full"}]},{"type":"text","value":" menggambarkan sebagian besar nilai yang dikumpulkan dari node klien. Lebih mudah mengimpor dashboard ini daripada membuat yang kustom."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk mengimpor dashboard "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Node Exporter"}]},{"type":"text","value":", ikuti langkah-langkah di bawah ini:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pergi kehalaman dashboard, klik \"+ Create dashboard\""}]}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/import-dashboard-grafana.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lalu klik tombol \"Import dashboard\""}]},{"type":"element","tag":"ol","props":{"start":2},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pada halaman import dashboard masukan id Node Exporter Full dan klik \"Load\""},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/import-dashboard-id.png"},"children":[]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Beri nama dashboard dan pilih Prometheus sebagai datasource lalu klik import"},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/import-dashboard-pick-datasource.png"},"children":[]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jika dashboard berhasil dikonfigurasi maka akan memunculkan semua matrik yang disajikan oleh Node Exporter"},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/grafana-dashboard-finish.png"},"children":[]}]}]},{"type":"element","tag":"h2","props":{"id":"implementasi-alerting-menggunakan-grafana-alert"},"children":[{"type":"text","value":"Implementasi Alerting Menggunakan Grafana Alert"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Grafana memiliki fitur alerting. Pada bagian ini kita akan mendefiniskan alert rules beserta apa yang harus dilakukan ketika alert rules tersebut terpenuhi."}]},{"type":"element","tag":"h3","props":{"id":"menentukan-parameter-yang-tepat-sebagai-acuan-untuk-scaling"},"children":[{"type":"text","value":"Menentukan parameter yang tepat sebagai acuan untuk scaling"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Kita bisa menggunakan data penggunaan CPU, penggunaan RAM, atau gabungan keduanya sebagai acuan untuk scaling. Namun, setiap aplikasi memiliki karakteristik beban yang berbeda, ada yang lebih banyak menggunakan CPU dan ada yang lebih banyak menggunakan RAM."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk mengetahui karakteristik aplikasi, kita dapat melakukan load testing menggunakan tools seperti Apache JMeter, Locust, atau k6. Tujuan dari pengujian ini adalah untuk mengidentifikasi "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"bottleneck"}]},{"type":"text","value":" dalam sistem, apakah disebabkan oleh CPU atau RAM. Setelah "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"bottleneck"}]},{"type":"text","value":" teridentifikasi, metrik tersebut dapat digunakan sebagai acuan untuk scaling."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada artikel ini apliaksi yang digunakan adalah CPU intensive. Jadi akan menggunakan query untuk mengmbil data Penggunaan CPU."}]},{"type":"element","tag":"h3","props":{"id":"query-promql-untuk-mendapatkan-data-rata-rata-penggunaan-cpu-dan-ram"},"children":[{"type":"text","value":"Query PromQL Untuk Mendapatkan Data Rata-rata Penggunaan CPU dan RAM"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut adalah query untuk mengumpulkan data penggunaan CPU, penggunaan RAM, atau gabungan keduanya."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Query ini akan digunakan pada bagian selanjutnya saat mengkonfigurasi alert rule."}]},{"type":"element","tag":"h4","props":{"id":"menghitung-rata-rata-cpu-load"},"children":[{"type":"text","value":"Menghitung Rata-rata CPU Load"}]},{"type":"element","tag":"pre","props":{"code":"100 - (avg(\n rate(node_cpu_seconds_total{job=~\"calculate_service_seed|calculate_service_clone\", mode=\"idle\"}[2m])\n)*100)\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"100 - (avg(\n rate(node_cpu_seconds_total{job=~\"calculate_service_seed|calculate_service_clone\", mode=\"idle\"}[2m])\n)*100)\n"}]}]},{"type":"element","tag":"h4","props":{"id":"menghitung-rata-rata-memory-used"},"children":[{"type":"text","value":"Menghitung Rata-rata Memory used"}]},{"type":"element","tag":"pre","props":{"code":"100 * (1 - (\n  sum(avg_over_time(node_memory_MemAvailable_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n  /\n  sum(avg_over_time(node_memory_MemTotal_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n))\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"100 * (1 - (\n  sum(avg_over_time(node_memory_MemAvailable_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n  /\n  sum(avg_over_time(node_memory_MemTotal_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n))\n"}]}]},{"type":"element","tag":"h4","props":{"id":"menghitung-rata-rata-penggunaan-memory-dan-cpu-usage"},"children":[{"type":"text","value":"Menghitung Rata-rata Penggunaan Memory dan CPU usage"}]},{"type":"element","tag":"pre","props":{"code":"avg(\n  100 - (rate(node_cpu_seconds_total{job=~\"calculate_service_seed|calculate_service_clone\", mode=\"idle\"}[2m]) * 100)\n)\n+\navg(\n  100 * (1 - (\n    sum(avg_over_time(node_memory_MemAvailable_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n    /\n    sum(avg_over_time(node_memory_MemTotal_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n  ))\n)\n/ 2\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"avg(\n  100 - (rate(node_cpu_seconds_total{job=~\"calculate_service_seed|calculate_service_clone\", mode=\"idle\"}[2m]) * 100)\n)\n+\navg(\n  100 * (1 - (\n    sum(avg_over_time(node_memory_MemAvailable_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n    /\n    sum(avg_over_time(node_memory_MemTotal_bytes{job=~\"calculate_service_seed|calculate_service_clone\"}[3m]))\n  ))\n)\n/ 2\n"}]}]},{"type":"element","tag":"h3","props":{"id":"mengatur-contact-point"},"children":[{"type":"text","value":"Mengatur Contact Point"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Contact Point adalah mekanisme untuk mengirimkan notifikasi ketika suatu kondisi alert rule terpenuhi. Contact Point bertindak sebagai penghubung antara sistem monitoring di Grafana dengan platform komunikasi yang digunakan untuk menerima notifikasi, seperti email, Slack, Microsoft Teams, PagerDuty, atau webhook."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada bagian ini kita akan membuat contact point berupa webhook. Webhook ini adalah endpoint dari webhook handler yang dibuat pada bagian sebelumnya."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Webhook handler inilah yang kemudian akan menginisiasi proses scaling."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk membuat contact point baru, dibawah bagian alerting klik \"Contact points\" lalu klik \"Create contact point\""}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/contact-point-menu.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut konfigurasi contact point untuk setiap event scaling"}]},{"type":"element","tag":"h4","props":{"id":"_1-contact-point-untuk-event-scale-down"},"children":[{"type":"text","value":"1. Contact Point Untuk Event Scale Down"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/scaledown-contactpoint.png"},"children":[]},{"type":"element","tag":"h4","props":{"id":"_2-contact-point-untuk-event-scale-up"},"children":[{"type":"text","value":"2. Contact Point Untuk Event Scale Up"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/scaleup-contactpoint.png"},"children":[]},{"type":"element","tag":"h3","props":{"id":"mengatur-alert-rule-untuk-event-scale-up"},"children":[{"type":"text","value":"Mengatur Alert Rule Untuk Event Scale Up"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada menu sidebar, pada bgaian alert rule, klik \"Alert rules\". Lalu klik \"New alert rule\"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lalu masukan pengaturan berikut:"}]},{"type":"element","tag":"h4","props":{"id":"_1-scale-up-enter-alert-rule-name"},"children":[{"type":"text","value":"1. Scale Up: Enter alert rule name"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Masukan nama dari alert rule"}]},{"type":"element","tag":"h4","props":{"id":"_2-scale-up-query-and-alert-condition"},"children":[{"type":"text","value":"2. Scale Up: Query and Alert Condition"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ubah mode pembuatan query dari \"Builder\" ke \"Code\" lalu masukan kode query. Sesuaikan query dengan karakteristik aplikasi."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada artikel ini alert akan di-trigger jika CPU Usage melebihi 70%. Sesuaikan batas ini sesuai dengan aplikasi yang dijalankan. Pada tingkat penggunaan berapa persen sistem mulai mengembalikan response error?"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/query-and-threshold.png"},"children":[]},{"type":"element","tag":"h4","props":{"id":"_3-scale-up-set-evaluation-behaviour"},"children":[{"type":"text","value":"3. Scale Up: Set Evaluation Behaviour"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/set-eval-behaviour.png"},"children":[]},{"type":"element","tag":"h4","props":{"id":"_4-scale-up-configure-labels-and-notification"},"children":[{"type":"text","value":"4. Scale Up: Configure Labels and Notification"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pilih contact point scale up yang sudah dibuat pada bagian sebelumnya"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/label-and-notification.png"},"children":[]},{"type":"element","tag":"h4","props":{"id":"_5-scale-up-configure-notification-message"},"children":[{"type":"text","value":"5. Scale Up: Configure Notification Message"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bagian ini opsional"}]},{"type":"element","tag":"h3","props":{"id":"mengatur-alert-rule-untuk-event-scale-down"},"children":[{"type":"text","value":"Mengatur Alert Rule Untuk Event Scale Down"}]},{"type":"element","tag":"h4","props":{"id":"_1-scale-down-enter-alert-rule-name"},"children":[{"type":"text","value":"1. Scale Down: Enter alert rule name"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Masukan nama dari alert rule"}]},{"type":"element","tag":"h4","props":{"id":"_2-scale-down-query-and-alert-condition"},"children":[{"type":"text","value":"2. Scale Down: Query and Alert Condition"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sesuaikan query dengan karakteristik aplikasi."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/query-and-threshold-scaledown.png"},"children":[]},{"type":"element","tag":"h4","props":{"id":"_3-scale-down-set-evaluation-behaviour"},"children":[{"type":"text","value":"3. Scale Down: Set Evaluation Behaviour"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/set-eval-behaviour-scaledown.png"},"children":[]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/mute-timing-scaledown.png"},"children":[]},{"type":"element","tag":"h4","props":{"id":"_4-scale-down-configure-labels-and-notification"},"children":[{"type":"text","value":"4. Scale Down: Configure Labels and Notification"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pilih contact point scale down"}]},{"type":"element","tag":"h4","props":{"id":"_5-scale-down-configure-notification-message"},"children":[{"type":"text","value":"5. Scale Down: Configure Notification Message"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Bagian ini opsional"}]},{"type":"element","tag":"h2","props":{"id":"load-testing-untuk-memastikan-fungsionalitas-arsitektur-secara-keseluruhan"},"children":[{"type":"text","value":"Load Testing Untuk Memastikan Fungsionalitas Arsitektur Secara Keseluruhan."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Load testing adalah bentuk tes dengan mengirimkan request ke aplikasi dengan beban bervariasi untuk melihat reaksi sistem pada beragam volume request."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pada bagian ini akan dijelaskan pembuatan load testing untuk mentrigger event scale up dan scale down"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Load testing akan menggunakan Grafana K6 yang dijalankan di komputer lokal, berikut adalah panduan membuat kode load testing menggunakan K6"}]},{"type":"element","tag":"h3","props":{"id":"merancang-kode-testing"},"children":[{"type":"text","value":"Merancang Kode Testing"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk melakukan testing fitur scale down dan scale up kita harus bisa mengatur secara presisi berapa banyak request yang dikimkan ke server. Artinya kita harus bisa mengendalikan Request per second (RPS), ini diperlukan agar kita bisa mengontrol CPU Load secara presisi."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Selain itu kita harus bisa mengatur testing yang ramping artinya testing yang seiring waktu meningkat untuk mensimulasikan trafic pada sehingga mentrigger scale up lalu menurunkan traffic untuk mensimulasikan trafic yang sepi sehingga mentrigger scale down."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Untuk memenuhi kebutuhan ini kita akan menggunakan executor dari K6 yaitu "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"rampign-arrival-rate"}]},{"type":"text","value":" . Executor ini memungkinkan kita untuk mengatur RPS secara presisi dan menaikan atau menurunkan RPS seiring waktu."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Kita juga akan menggunakan K6 reporter berupa HTML Report untuk menvisualisasikan hasil dari load testing. Saat load testing berakhir, akan muncul file "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"summary.html"}]},{"type":"text","value":" yang berisi hasil load testing. Berikut panduan menggunakan K6 untuk load testing."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Instalasi K6"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Pergi ke halaman dokumentasi ini dan install K6 sesuai dengan OS."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://grafana.com/docs/k6/latest/set-up/install-k6/","rel":["nofollow"]},"children":[{"type":"text","value":"https://grafana.com/docs/k6/latest/set-up/install-k6/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Buat sebuah file javascript dan isi dengan kode berikut:"},{"type":"element","tag":"pre","props":{"code":"import http from \"k6/http\";\nimport { check } from \"k6\";\nimport { htmlReport } from \"https://raw.githubusercontent.com/benc-uk/k6-reporter/main/dist/bundle.js\";\n\n// Akan dijalankan skenario 'endpoint_test'\n// Menggunakan ramping arrival state executor\nexport const options = {\n  discardResponseBodies: true,\n  scenarios: {\n    endpoint_test: {\n      executor: \"ramping-arrival-rate\",\n\n      // Volume request akan dimulai pada 1 request/detik\n      startRate: 1,\n      timeUnit: \"1s\",\n\n      // Virtual yagn digunakan berjumlah 25\n      preAllocatedVUs: 25,\n\n      // Total durasi test 20 menit\n      stages: [\n        // 1 menit pertama 1 RPS\n        { target: 1, duration: \"1m\" },\n\n        // 1 menit kemudian volume naik perlahan ke 6 RPS\n        { target: 6, duration: \"1m\" },\n\n        // 13 menit kemudian tetap pada 6 RPS\n        { target: 6, duration: \"13m\" },\n\n        // 2 menit kemudian turun perlahan ke 1 RPS\n        { target: 1, duration: \"2m\" },\n\n        // 3 menit kemudian tetap pada 1 RPS\n        { target: 1, duration: \"3m\" },\n      ],\n    },\n  },\n};\n\n// Function untuk mengirim request\nexport default function () {\n  // GANTI IP ADDRESS\n  const url = \"http://103.171.84.152/calculate\";\n\n  const randomNumber = Math.floor(Math.random() * 9999) + 1;\n\n  const body = JSON.stringify({ number: randomNumber });\n\n  const headers = { \"Content-Type\": \"application/json\" };\n\n  const res = http.post(url, body, { headers: headers });\n\n  check(res, {\n    \"status is 200\": (r) => r.status === 200,\n  });\n}\n\n// Setup HTML Report\nexport function handleSummary(data) {\n  return {\n    \"summary.html\": htmlReport(data),\n  };\n}\n","filename":"loadTest.js","language":"js","meta":"","className":"language-js shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":" http"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":" from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"k6/http"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":"check"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":" from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"k6"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":"htmlReport"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":" from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"https://raw.githubusercontent.com/benc-uk/k6-reporter/main/dist/bundle.js"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Akan dijalankan skenario 'endpoint_test'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Menggunakan ramping arrival state executor\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":" const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" options"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"  discardResponseBodies"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" true"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"  scenarios"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"    endpoint_test"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"      executor"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"ramping-arrival-rate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      // Volume request akan dimulai pada 1 request/detik\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"      startRate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"      timeUnit"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"1s"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      // Virtual yagn digunakan berjumlah 25\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"      preAllocatedVUs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 25"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"      // Total durasi test 20 menit\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":"      stages"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"        // 1 menit pertama 1 RPS\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" duration"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"1m"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"        // 1 menit kemudian volume naik perlahan ke 6 RPS\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 6"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" duration"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"1m"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"        // 13 menit kemudian tetap pada 6 RPS\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 6"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" duration"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"13m"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"        // 2 menit kemudian turun perlahan ke 1 RPS\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" duration"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"2m"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"        // 3 menit kemudian tetap pada 1 RPS\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"        {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#41A6B5"},"children":[{"type":"text","value":" duration"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"3m"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"      ]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"    }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Function untuk mengirim request\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":" default"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" function"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  // GANTI IP ADDRESS\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"http://103.171.84.152/calculate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" randomNumber"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" Math"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"floor"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"Math"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"random"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 9999"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" body"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#0DB9D7"},"children":[{"type":"text","value":" JSON"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"stringify"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"({ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" randomNumber"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"Content-Type"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"application/json"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9D7CD8;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" http"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"post"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" body"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#73DACA"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" headers"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":"  check"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"res"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"    \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"status is 200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" ==="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FF9E64"},"children":[{"type":"text","value":" 200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  })"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#51597D;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"// Setup HTML Report\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7"},"children":[{"type":"text","value":" function"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" handleSummary"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E0AF68"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#BB9AF7;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"  return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"    \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECE6A"},"children":[{"type":"text","value":"summary.html"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7AA2F7"},"children":[{"type":"text","value":" htmlReport"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"  }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ABDF5"},"children":[{"type":"text","value":"}\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Menjalankan Testing"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Buka terminal dan jalankan command berikut:"}]},{"type":"element","tag":"pre","props":{"code":"k6 run loadTest.js\n","language":"jsx","meta":"","className":"language-jsx shiki shiki-themes tokyo-night","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":"k6"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C0CAF5"},"children":[{"type":"text","value":" loadTest"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#89DDFF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#7DCFFF"},"children":[{"type":"text","value":"js\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"analisis-hasil-testing"},"children":[{"type":"text","value":"Analisis Hasil Testing"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut adalah grafik yang menunjukan persentasi penggunaan CPU pada Service seed"}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/graph-load-cpu.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dan berikut adalah grafik hasil dari load testing. Untuk mendapatkan laporan grafik seperti ini load testing harus dijalankan melalui Grafana Cloud."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/hasil-load-testing.png"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Berikut adalah perbandingan dari kedua grafik tersebut."}]},{"type":"element","tag":"image-display","props":{"src":"/blog/idcloudhost-autoscaling/perbandingan-graph-testing.png"},"children":[]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Stage 1 dimulai dengan 1 RPS"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Stage 1 berakhir dan stage 2 dimulai. RPS naik perlahan dari 1 ke 6. Sistem mulai mengalami load yang tinggi"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Stage 2 berakhir dan stage 3 dimulai. Volume request stabil di 6 RPS. Sistem mengalami lebih dari 70% CPU Load. Scale up diinisiasi."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Masih dalam stage 3. Proses scaling selesai dan load dari Service seed terbagi dua dengan server service baru"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Stage 3 berakhir dan stage 4 dimulai. Volume request turunperlahan ke 1 RPS. Di tengah-tengah stage ini sistem mengalami CPU load dibawah 30%. Scale down dimulai."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Stage 4 berakhir dan stage 5 dimulai. Volume request tetap berada di 1 RPS. Scale down selesai sehingga beban kerja server service seed meningkat sedikit. Terdapat juga lonjakan pada Failure rate, ini dikarenakan ketika server clone dihapus, masih ada request yang belum diselesaikan oleh server tersebut."}]}]},{"type":"element","tag":"dev-todo","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Buat bagian kesimpulan dan konsiderasi"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"keamanan - arahkan ke artikel yang membahas security\n::"}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"gambaran-sistem-yang-akan-dibuat","depth":2,"text":"Gambaran Sistem yang Akan Dibuat"},{"id":"penjelasan-stack-yang-dipilih","depth":2,"text":"Penjelasan Stack yang Dipilih","children":[{"id":"traefik","depth":3,"text":"Traefik"},{"id":"grafana","depth":3,"text":"Grafana"},{"id":"prometheus","depth":3,"text":"Prometheus"}]},{"id":"alur-kerja-sistem","depth":2,"text":"Alur Kerja Sistem"},{"id":"penjelasan-lanjut-cara-kerja-scale-up","depth":2,"text":"Penjelasan Lanjut Cara Kerja Scale Up"},{"id":"penjelasan-lanjut-cara-kerja-scale-down","depth":2,"text":"Penjelasan Lanjut Cara Kerja Scale Down"},{"id":"menghindari-thrashing","depth":2,"text":"Menghindari Thrashing","children":[{"id":"menghindari-thrashing-karena-konfigurasi-threshold-yang-tidak-optimal","depth":3,"text":"Menghindari Thrashing Karena Konfigurasi Threshold yang Tidak Optimal"},{"id":"menghindari-thrashing-karena-volume-request-yang-fluktuatif","depth":3,"text":"Menghindari Thrashing Karena Volume Request yang Fluktuatif"}]},{"id":"setup-vpc-network","depth":2,"text":"Setup VPC Network"},{"id":"setup-virtual-machine","depth":2,"text":"Setup Virtual Machine"},{"id":"implementasi-vm-service","depth":2,"text":"Implementasi VM Service","children":[{"id":"aplikasi-yang-akan-dijalankan-sebagai-service","depth":3,"text":"Aplikasi yang akan dijalankan sebagai service"},{"id":"prometheus-client-node-exporter","depth":3,"text":"Prometheus Client (Node Exporter)"}]},{"id":"implementasi-server-traefik-api-gateway-dan-load-balancer","depth":2,"text":"Implementasi Server Traefik API Gateway dan Load Balancer","children":[{"id":"instalasi-traefik","depth":3,"text":"Instalasi Traefik"},{"id":"menulis-file-konfigurasi-untuk-traefik","depth":3,"text":"Menulis File Konfigurasi Untuk Traefik"},{"id":"menjalankan-traefik-dengan-systemd","depth":3,"text":"Menjalankan Traefik dengan systemd"},{"id":"pembuatan-target-updater","depth":3,"text":"Pembuatan Target Updater"}]},{"id":"implementasi-server-monitoring","depth":2,"text":"Implementasi Server Monitoring","children":[{"id":"download-dan-install-prometheus","depth":3,"text":"Download dan install prometheus"},{"id":"menjalankan-prometheus-sebagai-systemd","depth":3,"text":"Menjalankan Prometheus Sebagai Systemd"},{"id":"edit-file-konfigurasi","depth":3,"text":"Edit file Konfigurasi"},{"id":"pembuatan-webhook-handler","depth":3,"text":"Pembuatan Webhook Handler"},{"id":"install-grafana","depth":3,"text":"Install Grafana"},{"id":"menambahkan-prometheus-sebagai-sumber-data","depth":3,"text":"Menambahkan Prometheus Sebagai Sumber Data"},{"id":"cara-mengimpor-dashboard-grafana","depth":3,"text":"Cara Mengimpor Dashboard Grafana"}]},{"id":"implementasi-alerting-menggunakan-grafana-alert","depth":2,"text":"Implementasi Alerting Menggunakan Grafana Alert","children":[{"id":"menentukan-parameter-yang-tepat-sebagai-acuan-untuk-scaling","depth":3,"text":"Menentukan parameter yang tepat sebagai acuan untuk scaling"},{"id":"query-promql-untuk-mendapatkan-data-rata-rata-penggunaan-cpu-dan-ram","depth":3,"text":"Query PromQL Untuk Mendapatkan Data Rata-rata Penggunaan CPU dan RAM"},{"id":"mengatur-contact-point","depth":3,"text":"Mengatur Contact Point"},{"id":"mengatur-alert-rule-untuk-event-scale-up","depth":3,"text":"Mengatur Alert Rule Untuk Event Scale Up"},{"id":"mengatur-alert-rule-untuk-event-scale-down","depth":3,"text":"Mengatur Alert Rule Untuk Event Scale Down"}]},{"id":"load-testing-untuk-memastikan-fungsionalitas-arsitektur-secara-keseluruhan","depth":2,"text":"Load Testing Untuk Memastikan Fungsionalitas Arsitektur Secara Keseluruhan.","children":[{"id":"merancang-kode-testing","depth":3,"text":"Merancang Kode Testing"},{"id":"analisis-hasil-testing","depth":3,"text":"Analisis Hasil Testing"}]}]}},"_type":"markdown","_id":"content:blog:1. autoscaling-pada-idcloudhost-menggunakan-grafana-traefik.md","_source":"content","_file":"blog/1. autoscaling-pada-idcloudhost-menggunakan-grafana-traefik.md","_stem":"blog/1. autoscaling-pada-idcloudhost-menggunakan-grafana-traefik","_extension":"md"},{"_path":"/","_dir":"","_draft":false,"_partial":false,"_locale":"","title":"Title of the page","description":"meta description of the page","code":"const config = {\n  key1: \"value1\",\n  key2: \"value2\",\n  nested: {\n    key3: \"value3\"\n  }\n};\n","anotherAttribute":"This is another attribute","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"hello"},"children":[{"type":"text","value":"Hello"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Kalian bisa begitu kah wkwk"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:index.md","_source":"content","_file":"index.md","_stem":"index","_extension":"md"}],"navigation":[{"title":"Blog","_path":"/blog","children":[{"title":"Pengembangan Autoscaling Horizontal pada IDCloudHost Menggunakan Traefik Sebagai Load Balancer dan Grafana Alert","_path":"/blog/autoscaling-pada-idcloudhost-menggunakan-grafana-traefik"}]},{"title":"Title of the page","_path":"/"}]}